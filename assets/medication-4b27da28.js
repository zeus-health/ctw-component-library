var T=Object.defineProperty;var C=(s,r,e)=>r in s?T(s,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[r]=e;var y=(s,r,e)=>(C(s,typeof r!="symbol"?r+"":r,e),e);import{g as O,c as L,h as S}from"./patient-provider-d8a611e8.js";import{a6 as A,a7 as P,O as u,a8 as E,a9 as k,F as h,a as d,c as m,p as q,aa as $,ab as j,P as N,ac as F,ad as z,ae as V,af as X,ag as Y,ah as B}from"./patient-helper-e281ba6b.js";import{r as p,R as c}from"./index-6f814c40.js";import{c as G}from"./index-74f03c09.js";import{D as U}from"./collapsible-data-list-details-f7571cef.js";import{D as H}from"./document-icon-581c51b2.js";import"./_baseToString-7c0e3f59.js";import"./sortBy-cdc8b01b.js";import"./_baseClone-3ae78372.js";import"./sortBy-ee350c06.js";import"./_equalByTag-eda72788.js";import{h as Q}from"./_baseForOwn-03e9c2f3.js";import"./_createSet-6ff8e1d4.js";import{a as l,f as W,g as Z,d as J}from"./uniqBy-7bfbe8b6.js";function K(s,r){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:r},s),p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"}))}const ee=p.forwardRef(K),te=ee;async function _e(s,r,e,t){if(!r.id)throw new Error(`Tried to ${t} a resource that hasn't been created yet.`);if(!r.isSummaryResource)throw new Error(`Tried to ${t} a patient record resource.`);const i={resourceType:"Basic",id:s==null?void 0:s.id,code:{coding:[{system:A,code:"adminact",display:"Administrative Activity"},{system:P,code:t}]},subject:{reference:`${r.resourceType}/${r.id}`,type:r.resourceType},author:await O(e)};if(!(await L(i,e)).id)throw new Error(`Failed to ${t} resource with id of ${r.id}`)}const g=({date:s,title:r,subtitle:e,data:t,hideEmpty:i,documentButton:n})=>{const[a,o]=p.useState(!1);return c.createElement("div",{className:"ctw-collapsible-data-list ctw-space-y-1","data-zus-telemetry-namespace":"CollapsibleDataList"},c.createElement(re,{date:s,title:r,subtitle:e,isDetailShown:a,setIsDetailShown:o,hasDocument:!!n}),a&&c.createElement(U,{data:t,hideEmpty:i,documentButton:n}))},re=({date:s,title:r,subtitle:e,isDetailShown:t,hasDocument:i=!1,setIsDetailShown:n})=>c.createElement("button",{type:"button","aria-label":"details",onClick:()=>n(!t),"data-zus-telemetry-namespace":"DetailSummary","data-zus-telemetry-click":t?"Collapse":"Expand",className:"ctw-w-full ctw-cursor-pointer ctw-border-none ctw-bg-transparent ctw-p-0 ctw-text-base ctw-outline-none"},c.createElement("div",{className:"ctw-flex ctw-items-center ctw-justify-between ctw-rounded-lg ctw-bg-bg-white ctw-p-3 ctw-text-left ctw-outline ctw-outline-1 ctw-outline-bg-dark"},c.createElement("div",{className:"ctw-flex ctw-space-x-3"},s&&c.createElement("div",{className:"ctw-min-w-[5rem]"},s),c.createElement("div",null,c.createElement("div",{className:"ctw-font-semibold ctw-text-content-black"},r),c.createElement("div",{className:"ctw-text-content-light"},e))),c.createElement("div",{className:"ctw-flex ctw-items-center ctw-space-x-3"},i&&c.createElement(H,{className:"ctw-fill-content-light hover:ctw-fill-content-light",height:16}),c.createElement("div",{className:"ctw-justify-right ctw-flex"},c.createElement(te,{className:G("ctw-h-5 ctw-w-5 ctw-text-primary-dark",{"ctw-rotate-90":t})})))));try{g.displayName="CollapsibleDataList",g.__docgenInfo={description:"",displayName:"CollapsibleDataList",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},date:{defaultValue:null,description:"",name:"date",required:!1,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}},subtitle:{defaultValue:null,description:"",name:"subtitle",required:!1,type:{name:"string"}},data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"CollapsibleDataListEntry[]"}},hideEmpty:{defaultValue:null,description:"",name:"hideEmpty",required:!1,type:{name:"boolean"}},documentButton:{defaultValue:null,description:"",name:"documentButton",required:!1,type:{name:"ReactNode"}},binaryId:{defaultValue:null,description:"",name:"binaryId",required:!1,type:{name:"string"}}}}}catch{}const w=({entries:s,limit:r})=>{const[e,t]=p.useState(!r||s.length<=r),i=e||!r?s:s.slice(0,r);return c.createElement("div",{className:"ctw-space-y-3","data-zus-telemetry-namespace":"CollapsibleDataListStack"},c.createElement("div",{className:"ctw-text-base ctw-font-medium ctw-uppercase ctw-text-content-light"},"History"),i.map((n,a)=>c.createElement("div",{key:`${n.id}-${a}`},c.createElement(g,{id:n.id,date:n.date,title:n.title,subtitle:n.subtitle,data:n.data,hideEmpty:n.hideEmpty,documentButton:n.documentButton}))),!e&&c.createElement("div",{className:"ctw-text-center"},c.createElement("button",{type:"button",className:"ctw-btn-primary",onClick:()=>t(!0)},"Load ",s.length-r," More")))};try{w.displayName="CollapsibleDataListStack",w.__docgenInfo={description:"",displayName:"CollapsibleDataListStack",props:{entries:{defaultValue:null,description:"",name:"entries",required:!0,type:{name:"CollapsibleDataListStackEntries"}},limit:{defaultValue:null,description:"",name:"limit",required:!1,type:{name:"number"}}}}}catch{}const se={active:"Currently taking","entered-in-error":"Never taken","not-taken":"Prescribed, not taken",completed:"No longer taking","on-hold":"On hold",intended:"Intend to take",stopped:"No longer taking"};function R(s,r){var t;if(s.medicationCodeableConcept)return s.medicationCodeableConcept;const e=u("Medication",s.contained,r,(t=s.medicationReference)==null?void 0:t.reference);return e==null?void 0:e.code}function ie(s,r){var e;return(e=v(s,r))==null?void 0:e.code}function v(s,r){var i,n;const e=R(s,r),t=(i=e==null?void 0:e.coding)==null?void 0:i.find(a=>a.system===E&&a.extension===void 0);return t||((n=e==null?void 0:e.coding)==null?void 0:n.find(a=>{var o;return a.system===E&&((o=a.extension)==null?void 0:o.some(f=>f.url===k&&f.valueString==="Standardization"))}))}function b(s,r){var t,i,n;let e;switch(s.resourceType){case"MedicationAdministration":case"MedicationDispense":e=(i=(t=s.performer)==null?void 0:t[0])==null?void 0:i.actor;break;case"MedicationRequest":e=s.performer||((n=s.dispenseRequest)==null?void 0:n.performer);break;case"MedicationStatement":default:return}if(e!=null&&e.reference&&e.type==="Organization")return u("Organization",s.contained,r,e.reference)}function ne(s){return Q(se,s,"")}class ae extends h{get dosageDisplay(){const{text:r,route:e,dose:t}=this.resource.dosage||{};return r||l([t==null?void 0:t.value,t==null?void 0:t.unit]).join(" ")}get dosageRoute(){const{route:r}=this.resource.dosage||{};return r==null?void 0:r.text}get effectivePeriod(){const{start:r,end:e}=this.resource.effectivePeriod||{};return{start:r?d(r):"",end:e?d(e):""}}}class ce extends h{get includedPerformer(){var t,i,n,a;const r=(i=(t=this.resource.performer)==null?void 0:t[0])==null?void 0:i.actor.reference,e=u("Practitioner",this.resource.contained,this.includedResources,r);return e?new S(e).fullName:(a=(n=this.resource.performer)==null?void 0:n[0])==null?void 0:a.actor.display}get performer(){return b(this.resource,this.includedResources)}get performerDetails(){var e,t;const{performer:r}=this;return{name:(r==null?void 0:r.name)??"",address:((e=r==null?void 0:r.address)==null?void 0:e[0].text)??"",telecom:((t=r==null?void 0:r.telecom)==null?void 0:t[0].value)??""}}get status(){return this.resource.status}get quantityDisplay(){const{value:r,unit:e="units"}=this.resource.quantity||{};return r?`${r} ${e}`:void 0}get supplied(){const{value:r,unit:e="days"}=this.resource.daysSupply||{};return r?`${r} ${e}`:void 0}}class oe extends h{get includedRequester(){var t,i;const r=(t=this.resource.requester)==null?void 0:t.reference,e=u("Practitioner",this.resource.contained,this.includedResources,r);return e?new S(e).fullName:(i=this.resource.requester)==null?void 0:i.display}get pharmacy(){var i,n,a;const{reference:r,display:e}=((i=this.resource.dispenseRequest)==null?void 0:i.performer)||{},t=u("Organization",this.resource.contained,this.includedResources,r);if(t){const o=(n=t.telecom)==null?void 0:n[0].value,{city:f,state:_,postalCode:D,text:I,line:M=[]}=((a=t.address)==null?void 0:a[0])||{},x=l([f,`${_} ${D}`]).join(", ");return{telecom:o,name:t.name,address:I??l([M,x]).join(`
`)}}return{name:e}}}class ue extends h{constructor(){super(...arguments);y(this,"builderPatientRxNormStatus")}get basedOn(){var e,t;return(t=(e=this.resource.basedOn)==null?void 0:e[0])==null?void 0:t.type}get category(){return m(this.resource.category)}get context(){var e;return(e=this.resource.context)==null?void 0:e.display}get dateAsserted(){return d(this.resource.dateAsserted)}set dateAsserted(e){e instanceof Date?this.resource.dateAsserted=q(e):this.resource.dateAsserted=e}get derivedFrom(){var e;return((e=this.resource.derivedFrom)==null?void 0:e.map(({display:t})=>t||""))||[]}get aggregatedFrom(){const e=W(t=>t.url===$||t.url===j,this.resource.extension);return e!=null&&e.extension?l(e.extension.map(Z("valueReference"))):l(this.resource.derivedFrom)}get display(){return m(R(this.resource,this.includedResources))}get dosage(){var e,t;return(t=(e=this.resource.dosage)==null?void 0:e[0])==null?void 0:t.text}get effectiveStart(){var e;return d((e=this.resource.effectivePeriod)==null?void 0:e.start)}get identifier(){var e,t;return(t=(e=this.resource.identifier)==null?void 0:e[0])==null?void 0:t.value}get informationSource(){return this.resource.informationSource||void 0}set informationSource(e){this.resource.informationSource=e}get medicationReference(){var e;return(e=this.resource.medicationReference)==null?void 0:e.display}get notesDisplay(){var e;return((e=this.resource.note)==null?void 0:e.map(({text:t})=>t))||[]}get partOf(){var e,t;return(t=(e=this.resource.partOf)==null?void 0:e[0])==null?void 0:t.display}get patientStatus(){var e;return ne((e=this.builderPatientRxNormStatus)==null?void 0:e[this.rxNorm??""])}get rxNorm(){return ie(this.resource,this.includedResources)}get rxNormCodeableConcept(){const e=v(this.resource,this.includedResources);return{...e??{},display:(e==null?void 0:e.display)??this.display}}get reason(){var e;return m((e=this.resource.reasonCode)==null?void 0:e[0])}get reasonReference(){return this.resource.reasonReference}get isArchived(){return!!this.getBasicResourceByAction("archive")}get isInactive(){return!["active","intended","unknown"].includes(this.status)}get status(){return this.resource.status}get displayStatus(){return this.isArchived?"Dismissed":J(this.resource.status)}get statusReason(){var e;return m((e=this.resource.statusReason)==null?void 0:e[0])}get subject(){return this.resource.subject}get subjectID(){var t;const[,e]=((t=this.resource.subject.reference)==null?void 0:t.split("/"))||[];return e||""}get patient(){const e=u("Patient",this.resource.contained,this.includedResources,this.resource.subject.reference);if(e)return new N(e,this.includedResources)}get lastFillDate(){var e,t;return d((t=(e=this.resource.extension)==null?void 0:e.find(i=>i.url===F))==null?void 0:t.valueDateTime)}get quantity(){var t,i;const e=(i=(t=this.resource.extension)==null?void 0:t.find(n=>n.url===z))==null?void 0:i.valueQuantity;if(e)return`${e.value} ${e.unit||""}`}get daysSupply(){var e,t,i,n;return(n=(i=(t=(e=this.resource.extension)==null?void 0:e.find(a=>a.url===V))==null?void 0:t.valueQuantity)==null?void 0:i.value)==null?void 0:n.toString()}get refills(){var e,t,i;return(i=(t=(e=this.resource.extension)==null?void 0:e.find(n=>n.url===X))==null?void 0:t.valueUnsignedInt)==null?void 0:i.toString()}get lastPrescriber(){var i,n;const e=(n=(i=this.resource.extension)==null?void 0:i.find(a=>a.url===Y))==null?void 0:n.valueReference;if(!(e!=null&&e.type)||!e.reference)return;const t=u(e.type,this.resource.contained,this.includedResources,e.reference);if(t!=null&&t.name){if(typeof t.name=="string")return t.name;const{family:a,given:o=[]}=t.name[0];return l([a,o[0]]).join(", ")}return e.display}get lastPrescribedDate(){var e,t;return d((t=(e=this.resource.extension)==null?void 0:e.find(i=>i.url===B))==null?void 0:t.valueDateTime)}}class De extends h{get performer(){var r;return(r=b(this.resource,this.includedResources))==null?void 0:r.name}get status(){return this.resource.status}get dosage(){var r,e,t;switch(this.resource.resourceType){case"MedicationStatement":return(e=(r=this.resource.dosage)==null?void 0:r[0])==null?void 0:e.text;case"MedicationAdministration":return new ae(this.resource,this.includedResources).dosageDisplay;case"MedicationDispense":case"MedicationRequest":return m((t=this.resource.dosageInstruction)==null?void 0:t[0]);default:return""}}get date(){var r,e,t,i,n,a;switch(this.resource.resourceType){case"MedicationStatement":return this.resource.dateAsserted??((r=this.resource.effectivePeriod)==null?void 0:r.start);case"MedicationAdministration":return(e=this.resource.effectivePeriod)==null?void 0:e.start;case"MedicationDispense":return this.resource.whenHandedOver??this.resource.whenPrepared;case"MedicationRequest":return this.resource.authoredOn??((a=(n=(i=(t=this.resource.dosageInstruction)==null?void 0:t[0].timing)==null?void 0:i.repeat)==null?void 0:n.boundsPeriod)==null?void 0:a.start);default:return""}}get dateLocal(){return d(this.date)}get patient(){var e;const r=u("Patient",this.resource.contained,this.includedResources,(e=this.resource.subject)==null?void 0:e.reference);if(r)return new N(r,this.includedResources)}get prescriber(){switch(this.resource.resourceType){case"MedicationStatement":return new ue(this.resource,this.includedResources).lastPrescriber;case"MedicationDispense":return new ce(this.resource,this.includedResources).includedPerformer;case"MedicationRequest":return new oe(this.resource,this.includedResources).includedRequester;default:return}}}export{w as C,ue as M,De as a,oe as b,ce as c,ae as d,ie as g,_e as r};
//# sourceMappingURL=medication-4b27da28.js.map
