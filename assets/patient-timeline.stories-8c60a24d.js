var C=Object.defineProperty;var q=(s,t,e)=>t in s?C(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var h=(s,t,e)=>(q(s,typeof t!="symbol"?t+"":t,e),e);import{R as r,r as w}from"./index-6f814c40.js";import{c as F}from"./index-74f03c09.js";import{b as N,h as O,d as L,i as I,R as G,e as Q}from"./diagnostic-report-b94400ab.js";import{b as j,e as V,j as A}from"./values-66360932.js";import{S as B,E as R,a as U,c as W,d as H,b as $,e as Y}from"./encounters-29dd4f38.js";import{V as K}from"./view-fhir-af2fb9fd.js";import{F as Z,c as b,u as J,C as X,S as ee}from"./patient-helper-0838fee9.js";import{l as T,k as _,D as x,h as te}from"./sort-013eed15.js";import{P as se}from"./patient-provider-d1b391ca.js";import"./_baseToString-4993715b.js";import{c as d,g as ie}from"./sortBy-df4456c4.js";import"./_baseClone-25b1595e.js";import"./sortBy-d677d734.js";import"./_equalByTag-aaf39779.js";import"./_baseForOwn-d8306f34.js";import"./_createSet-12ef9b81.js";import{s as y}from"./resource-details-drawer-b03884fb.js";import{a as p}from"./request-5a1df4c1.js";import{m as ae,a as oe}from"./medication-request-23eea7be.js";import{p as ne,e as re,a as ce}from"./provenances-5e8ba162.js";import"./_commonjsHelpers-042e6b4d.js";import"./index-4d501b15.js";import"./extends-98964cd2.js";import"./index-6de6b113.js";import"./use-watch-a9671586.js";import"./use-controllable-046cc6fb.js";import"./drawer-ed34104d.js";import"./isString-35d4a3f2.js";import"./uniq-f5468222.js";import"./table-a6e3434f.js";import"./spinner-66aa4ba7.js";import"./use-breakpoints-3902bba3.js";import"./mapValues-21907523.js";import"./collapsible-data-list-details-b542a54e.js";import"./error-boundary-4a876c30.js";import"./getPrototypeOf-9c757e77.js";import"./_basePickBy-239377e6.js";import"./_baseIsEqual-c150f525.js";import"./isPlainObject-8e58b46f.js";import"./data-list-254aa0b0.js";import"./medication-history-492b3089.js";import"./document-icon-581c51b2.js";import"./loading-c7ff698a.js";import"./coding-list-1d7c950f.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./toNumber-9b8ac844.js";import"./isEmpty-bcd6f1a3.js";function le(s){const t=[];return t.push({key:"type",type:"checkbox",icon:N,display:"Type",values:j(V(s.map(e=>e.type)))}),t}const M={type:{key:"type",selected:["Medication Fill","Prescription","Encounter","Diagnostic Report"],type:"checkbox"}},f={display:"Date (New to Old)",sorts:[{key:"date",dir:"desc",isDate:!0}]},me=[f,{display:"Date (Old to New)",sorts:[{key:"date",dir:"asc",isDate:!0}]}],g=(s=!1)=>{const t=[{title:"Date",widthPercent:10,minWidth:120,dataIndex:"date"},{title:"Type",render:e=>r.createElement("div",null,r.createElement("div",{className:"ctw-font-medium"},e.type),r.createElement("div",null,e.subtype))},{title:"Actor",render:e=>r.createElement(r.Fragment,null,e.actorDetails.map(a=>r.createElement("div",{className:"ctw-capitalize",key:a},a.toLocaleLowerCase())))},{title:"Modifiers",render:e=>r.createElement(B,{items:e.modifiers,limit:3,total:e.modifiers.length})}];return s&&t.push({widthPercent:10,minWidth:200,render:e=>r.createElement(K,{name:"Encounter Resource",resource:e.resource})}),t};try{g.displayName="patientTimelineColumns",g.__docgenInfo={description:"",displayName:"patientTimelineColumns",props:{}}}catch{}class de extends Z{constructor(e,a,o){super(e,a,o);h(this,"kind","TimelineEvent");h(this,"model");switch(e.resourceType){case"Encounter":this.model=new R(e,a,o);break;case"DiagnosticReport":this.model=new x(e,a,o);break;case"MedicationRequest":this.model=new _(e,a,o);break;case"MedicationDispense":this.model=new T(e,a,o);break;default:throw new Error("This resource is not in type TimelineEvent")}}get date(){switch(this.model.kind){case"Encounter":return this.model.periodStart;case"DiagnosticReport":return this.model.effectiveStart;case"MedicationRequest":return this.model.authoredOn;case"MedicationDispense":return this.model.whenHandedOver||this.model.whenPrepared;default:return}}get type(){switch(this.model.kind){case"Encounter":return"Encounter";case"DiagnosticReport":return"Diagnostic Report";case"MedicationRequest":return"Prescription";case"MedicationDispense":return"Medication Fill";default:return}}get subtype(){switch(this.model.kind){case"Encounter":return this.model.typeDisplay;case"DiagnosticReport":return this.model.category;case"MedicationRequest":return this.model.medicationDisplayName;case"MedicationDispense":return this.model.medicationDisplayName;default:return}}get actorDetails(){switch(this.model.kind){case"Encounter":return d([this.model.participants,this.model.location]);case"DiagnosticReport":return d([this.model.performer]);case"MedicationRequest":return d([this.model.includedRequester]);case"MedicationDispense":return d([this.model.performerDetails.name,this.model.performerDetails.address,this.model.performerDetails.telecom]);default:return[]}}get modifiers(){var e,a,o,l;switch(this.model.kind){case"Encounter":return d(this.model.diagnoses);case"DiagnosticReport":return[this.model.results.length>0?`${this.model.results.length} results available`:""];case"MedicationRequest":return d([b((e=this.model.resource.dosageInstruction)==null?void 0:e[0])]);case"MedicationDispense":return d([b((a=this.model.resource.dosageInstruction)==null?void 0:a[0]),(o=this.model.resource.daysSupply)!=null&&o.value?`Days supply: ${this.model.resource.daysSupply.value}`:"",(l=this.model.resource.quantity)!=null&&l.value?`Quantity: ${this.model.resource.quantity.value}`:""]);default:return[]}}}function pe(){const[s,t]=w.useState(),e=U(),a=O(),o=W(),l=H(),c=[e,a,o,l];w.useEffect(()=>{const P=d(A(ie(c.map(z=>{var D;return(D=z.data)==null?void 0:D.map(ue)}))));t(te(P,[{dir:"desc",key:"date",isDate:!0},{dir:"desc",key:"type"}]))},[e.data,a.data,o.data,l.data]);const n=y(c,"isLoading"),i=y(c,"isFetching"),m=y(c,"isError");return{isFetching:i,isLoading:n,isError:m,data:s??[]}}const ue=({resource:s,includedResources:t,revIncludes:e})=>new de(s,t,e);function v({className:s}){const t=pe(),{featureFlags:e}=J(),{data:a,setFilters:o,setSort:l}=L({defaultFilters:M,defaultSort:f,records:t.data}),c=$(),n=I(),i=Y();return r.createElement("div",{className:F(s,"ctw-scrollable-pass-through-height")},r.createElement(G,{filterOptions:{onChange:o,defaultState:M,filters:le(t.data)},sortOptions:{defaultSort:f,options:me,onChange:l}}),r.createElement(Q,{showTableHead:!1,isLoading:t.isLoading,data:a,emptyMessage:"There are no timeline records available.",columns:g(e==null?void 0:e.enableViewFhirButton),onRowClick:m=>{m.model.constructor===R?c(m.model):m.model.constructor===x?n(m.model):(m.model.constructor===T||m.model.constructor===_)&&i(m.model)}}))}try{v.displayName="PatientTimelineV2",v.__docgenInfo={description:"",displayName:"PatientTimelineV2",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"Argument"}}}}}catch{}const he={resourceType:"MedicationStatement",id:"0cbb026a-0535-47a1-bbbc-956fcde07dc9",meta:{extension:[{url:"https://zusapi.com/created-at",valueInstant:"2023-03-14T02:04:12.070+00:00"}],versionId:"1",lastUpdated:"2023-03-14T02:04:12.313+00:00",source:"#b6a5f8c980f9ac84",tag:[{system:"https://zusapi.com/accesscontrol/owner",code:"builder/af9b7b42-33d2-4c53-9597-7a890ab7954d",display:"Priyank Health"},{system:"https://zusapi.com/lens",code:"ActiveMedications"},{system:"https://zusapi.com/summary",code:"Common"}]},extension:[{url:"https://zusapi.com/lens/extension/aggregatedFrom",extension:[{url:"https://zusapi.com/lens/extension/aggregatedFrom",valueReference:{reference:"MedicationDispense/612df454-aea8-4ad7-87c4-fd35ee7ce1e3",type:"MedicationDispense"}},{url:"https://zusapi.com/lens/extension/aggregatedFrom",valueReference:{reference:"MedicationRequest/104f6928-da8a-4c0c-b4eb-abeb9e4195f0",type:"MedicationRequest"}}]},{url:"https://zusapi.com/lens/extension/medicationLastFillDate",valueDateTime:"2023-02-21"},{url:"https://zusapi.com/lens/extension/medicationLastPrescribedDate",valueDateTime:"2023-02-21"},{url:"https://zusapi.com/lens/extension/medicationQuantity",valueQuantity:{value:14,unit:"days"}},{url:"https://zusapi.com/lens/extension/medicationDaysSupply",valueQuantity:{value:14}},{url:"https://zusapi.com/lens/extension/medicationRefills",valueUnsignedInt:0},{url:"https://zusapi.com/lens/extension/medicationLastPrescriber",valueReference:{reference:"Practitioner/2eb2b8c3-29a3-4d7f-8feb-b8234aa70701",type:"Practitioner",display:"Phyllis Reeves"}},{url:"https://zusapi.com/fhir/identifier/universal-id",valueString:"35bf3353-165a-454f-94f4-011227a12e18"}],status:"active",medicationCodeableConcept:{coding:[{system:"http://www.nlm.nih.gov/research/umls/rxnorm",code:"1180459"},{system:"http://hl7.org/fhir/sid/ndc",code:"55887023697"},{extension:[{url:"https://zusapi.com/terminology/enrichment",valueString:"Standardization"}],system:"http://www.nlm.nih.gov/research/umls/rxnorm",code:"876195",display:"polyethylene glycol 3350 17000 MG Powder for Oral Solution [Miralax]",userSelected:!1},{extension:[{url:"https://zusapi.com/terminology/enrichment",valueString:"ActiveIngredient"}],system:"http://www.nlm.nih.gov/research/umls/rxnorm",code:"221147",display:"polyethylene glycol 3350",userSelected:!1},{extension:[{url:"https://zusapi.com/terminology/enrichment",valueString:"BrandName"}],system:"http://www.nlm.nih.gov/research/umls/rxnorm",code:"261575",display:"Miralax",userSelected:!1},{extension:[{url:"https://zusapi.com/terminology/enrichment",valueString:"ClinicalDrug_TTY_SCD"}],system:"http://terminology.hl7.org/CodeSystem/v3-NullFlavor",code:"UNK",display:"unknown",userSelected:!1},{extension:[{url:"https://zusapi.com/terminology/enrichment",valueString:"ClinicalDrug_TTY_SCD"}],system:"http://www.nlm.nih.gov/research/umls/rxnorm",code:"876193",display:"polyethylene glycol 3350 17000 MG Powder for Oral Solution",userSelected:!1}],text:"Miralax Oral Product"},subject:{reference:"Patient/a9da7271-99da-42ca-8654-8bea1b2983ca",type:"Patient"},dateAsserted:"2023-02-21",dosage:[{text:"Dissolve 17g in 4–8oz liquid and drink once daily for up to 7 days."}]};function ye(){return{parameters:{msw:{handlers:{mocks:fe()}}}}}function fe(){const s=p.rest.get("https://api.dev.zusapi.com/fhir/Patient",(c,n,i)=>n(i.delay(750),i.status(200),i.json(ne))),t=p.rest.get("https://api.dev.zusapi.com/fhir/Encounter",(c,n,i)=>n(i.status(200),i.json(re))),e=p.rest.get("https://api.dev.zusapi.com/fhir/MedicationRequest",(c,n,i)=>n(i.status(200),i.json(ae))),a=p.rest.get("https://api.dev.zusapi.com/fhir/MedicationDispense",(c,n,i)=>n(i.status(200),i.json(oe))),o=p.rest.get("https://api.dev.zusapi.com/fhir/MedicationStatement",(c,n,i)=>n(i.status(200),i.json(he))),l=p.rest.get("https://api.dev.zusapi.com/fhir/Provenance?target=Encounter/:Encounter",async(c,n,i)=>n(i.status(200),i.json(ce)));return[s,t,l,e,a,o]}const dt={component:v,tags:["autodocs"],argTypes:{className:{options:["Blank","Fixed Width"],control:"select",mapping:{Blank:"","Fixed Width":"ctw-m-auto ctw-max-w-[600px]"}}},args:{className:"Blank",readOnly:!1},decorators:[(s,{args:t})=>r.createElement(X,{env:"dev",authToken:"dummy-token",builderId:"b123"},r.createElement(se,{patientID:"u12345",systemURL:ee},r.createElement(s,{args:t})))]},u={...ye()};var E,S,k;u.parameters={...u.parameters,docs:{...(E=u.parameters)==null?void 0:E.docs,source:{originalSource:`{
  ...setupTimelineMocks()
}`,...(k=(S=u.parameters)==null?void 0:S.docs)==null?void 0:k.source}}};const pt=["Basic"];export{u as Basic,pt as __namedExportsOrder,dt as default};
