var L=Object.defineProperty;var A=(s,r,e)=>r in s?L(s,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[r]=e;var E=(s,r,e)=>(A(s,typeof r!="symbol"?r+"":r,e),e);import{g as P,e as k,c as N}from"./patient-provider-36691a31.js";import{a8 as q,a9 as j,G as d,aa as w,ab as $,F as h,a as l,c as p,p as F,ac as z,ad as B,Y as b,ae as X,af as Y,ag as V,ah as G,ai as U,aj as H}from"./patient-helper-0f09a661.js";import{r as f,R as o}from"./index-6f814c40.js";import{c as Q}from"./index-74f03c09.js";import{D as W,a as Z}from"./collapsible-data-list-details-4a1431c5.js";import"./_baseToString-7c0e3f59.js";import{o as R}from"./sortBy-3347ffe9.js";import"./_baseClone-3ae78372.js";import"./sortBy-ee350c06.js";import"./_equalByTag-eda72788.js";import{h as J}from"./_baseForOwn-03e9c2f3.js";import"./_createSet-6ff8e1d4.js";import{a as m,f as K,g as v,e as ee}from"./values-28adb33b.js";import{i as D}from"./isString-933c0e0c.js";function te(s,r){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:r},s),f.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"}))}const re=f.forwardRef(te),se=re;function Te(s){return!!(s&&typeof s=="object"&&"preventDefault"in s)}const ne=s=>s==null||Number.isNaN(s)||typeof s=="object"&&Object.keys(s).length===0||typeof s=="string"&&s.trim().length===0;async function xe(s,r,e,t){if(!r.id)throw new Error(`Tried to ${t} a resource that hasn't been created yet.`);if(!r.isSummaryResource)throw new Error(`Tried to ${t} a patient record resource.`);const n={resourceType:"Basic",id:s==null?void 0:s.id,code:{coding:[{system:q,code:"adminact",display:"Administrative Activity"},{system:j,code:t}]},subject:{reference:`${r.resourceType}/${r.id}`,type:r.resourceType},author:await P(e)};if(!(await k(n,e)).id)throw new Error(`Failed to ${t} resource with id of ${r.id}`)}const y=({date:s,title:r,subtitle:e,data:t,hideEmpty:n,documentButton:i})=>{const[a,c]=f.useState(!1);return o.createElement("div",{className:"ctw-collapsible-data-list ctw-space-y-1","data-zus-telemetry-namespace":"CollapsibleDataList"},o.createElement(ie,{date:s,title:r,subtitle:e,isDetailShown:a,setIsDetailShown:c,hasDocument:!!i}),a&&o.createElement(W,{data:t,hideEmpty:n,documentButton:i}))},ie=({date:s,title:r,subtitle:e,isDetailShown:t,hasDocument:n=!1,setIsDetailShown:i})=>o.createElement("button",{type:"button","aria-label":"details",onClick:()=>i(!t),"data-zus-telemetry-namespace":"DetailSummary","data-zus-telemetry-click":t?"Collapse":"Expand",className:"ctw-w-full ctw-cursor-pointer ctw-border-none ctw-bg-transparent ctw-p-0 ctw-text-base ctw-outline-none"},o.createElement("div",{className:"ctw-flex ctw-items-center ctw-justify-between ctw-rounded-lg ctw-bg-bg-white ctw-p-3 ctw-text-left ctw-outline ctw-outline-1 ctw-outline-bg-dark"},o.createElement("div",{className:"ctw-flex ctw-space-x-3"},s&&o.createElement("div",{className:"ctw-min-w-[5rem]"},s),o.createElement("div",null,o.createElement("div",{className:"ctw-font-semibold ctw-text-content-black"},r),o.createElement("div",{className:"ctw-text-content-light"},e))),o.createElement("div",{className:"ctw-flex ctw-items-center ctw-space-x-3"},n&&o.createElement(Z,{className:"ctw-fill-content-light hover:ctw-fill-content-light",height:16}),o.createElement("div",{className:"ctw-justify-right ctw-flex"},o.createElement(se,{className:Q("ctw-h-5 ctw-w-5 ctw-text-primary-dark",{"ctw-rotate-90":t})})))));try{y.displayName="CollapsibleDataList",y.__docgenInfo={description:"",displayName:"CollapsibleDataList",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},date:{defaultValue:null,description:"",name:"date",required:!1,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}},subtitle:{defaultValue:null,description:"",name:"subtitle",required:!1,type:{name:"string"}},data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"CollapsibleDataListEntry[]"}},hideEmpty:{defaultValue:null,description:"",name:"hideEmpty",required:!1,type:{name:"boolean"}},documentButton:{defaultValue:null,description:"",name:"documentButton",required:!1,type:{name:"ReactNode"}},binaryId:{defaultValue:null,description:"",name:"binaryId",required:!1,type:{name:"string"}}}}}catch{}const S=({entries:s,limit:r})=>{const[e,t]=f.useState(!r||s.length<=r),n=e||!r?s:s.slice(0,r);return o.createElement("div",{className:"ctw-space-y-3","data-zus-telemetry-namespace":"CollapsibleDataListStack"},o.createElement("div",{className:"ctw-text-base ctw-font-medium ctw-uppercase ctw-text-content-light"},"History"),n.map((i,a)=>o.createElement("div",{key:`${i.id}-${a}`},o.createElement(y,{id:i.id,date:i.date,title:i.title,subtitle:i.subtitle,data:i.data,hideEmpty:i.hideEmpty,documentButton:i.documentButton}))),!e&&o.createElement("div",{className:"ctw-text-center"},o.createElement("button",{type:"button",className:"ctw-btn-primary",onClick:()=>t(!0)},"Load ",s.length-r," More")))};try{S.displayName="CollapsibleDataListStack",S.__docgenInfo={description:"",displayName:"CollapsibleDataListStack",props:{entries:{defaultValue:null,description:"",name:"entries",required:!0,type:{name:"CollapsibleDataListStackEntries"}},limit:{defaultValue:null,description:"",name:"limit",required:!1,type:{name:"number"}}}}}catch{}const ae={active:"Currently taking","entered-in-error":"Never taken","not-taken":"Prescribed, not taken",completed:"No longer taking","on-hold":"On hold",intended:"Intend to take",stopped:"No longer taking"};function _(s,r){var t;if(s.medicationCodeableConcept)return s.medicationCodeableConcept;const e=d("Medication",s.contained,r,(t=s.medicationReference)==null?void 0:t.reference);return e==null?void 0:e.code}function oe(s,r){var e;return(e=I(s,r))==null?void 0:e.code}function I(s,r){var n,i;const e=_(s,r),t=(n=e==null?void 0:e.coding)==null?void 0:n.find(a=>a.system===w&&a.extension===void 0);return t||((i=e==null?void 0:e.coding)==null?void 0:i.find(a=>{var c;return a.system===w&&((c=a.extension)==null?void 0:c.some(u=>u.url===$&&u.valueString==="Standardization"))}))}function M(s,r){var t,n,i;let e;switch(s.resourceType){case"MedicationAdministration":case"MedicationDispense":e=(n=(t=s.performer)==null?void 0:t[0])==null?void 0:n.actor;break;case"MedicationRequest":e=s.performer||((i=s.dispenseRequest)==null?void 0:i.performer);break;case"MedicationStatement":default:return}if(e!=null&&e.reference&&e.type==="Organization")return d("Organization",s.contained,r,e.reference)}function ce(s){return J(ae,s,"")}class ue extends h{get dosageDisplay(){const{text:r,route:e,dose:t}=this.resource.dosage||{};return r||m([t==null?void 0:t.value,t==null?void 0:t.unit]).join(" ")}get dosageRoute(){const{route:r}=this.resource.dosage||{};return r==null?void 0:r.text}get effectivePeriod(){const{start:r,end:e}=this.resource.effectivePeriod||{};return{start:r?l(r):"",end:e?l(e):""}}}class de extends h{get includedPerformer(){var t,n,i,a;const r=(n=(t=this.resource.performer)==null?void 0:t[0])==null?void 0:n.actor.reference,e=d("Practitioner",this.resource.contained,this.includedResources,r);return e?new N(e).fullName:(a=(i=this.resource.performer)==null?void 0:i[0])==null?void 0:a.actor.display}get performer(){return M(this.resource,this.includedResources)}get performerDetails(){var e,t;const{performer:r}=this;return{name:(r==null?void 0:r.name)??"",address:((e=r==null?void 0:r.address)==null?void 0:e[0].text)??"",telecom:((t=r==null?void 0:r.telecom)==null?void 0:t[0].value)??""}}get status(){return this.resource.status}get quantityDisplay(){const{value:r,unit:e="units"}=this.resource.quantity||{};return r?`${r} ${e}`:void 0}get supplied(){const{value:r,unit:e="days"}=this.resource.daysSupply||{};return r?`${r} ${e}`:void 0}}class le extends h{get includedRequester(){var t,n;const r=(t=this.resource.requester)==null?void 0:t.reference,e=d("Practitioner",this.resource.contained,this.includedResources,r);return e?new N(e).fullName:(n=this.resource.requester)==null?void 0:n.display}get pharmacy(){var n,i,a;const{reference:r,display:e}=((n=this.resource.dispenseRequest)==null?void 0:n.performer)||{},t=d("Organization",this.resource.contained,this.includedResources,r);if(t){const c=(i=t.telecom)==null?void 0:i[0].value,{city:u,state:g,postalCode:T,text:x,line:C=[]}=((a=t.address)==null?void 0:a[0])||{},O=m([u,`${g} ${T}`]).join(", ");return{telecom:c,name:t.name,address:x??m([C,O]).join(`
`)}}return{name:e}}}class me extends h{constructor(){super(...arguments);E(this,"builderPatientRxNormStatus")}get basedOn(){var e,t;return(t=(e=this.resource.basedOn)==null?void 0:e[0])==null?void 0:t.type}get category(){return p(this.resource.category)}get context(){var e;return(e=this.resource.context)==null?void 0:e.display}get dateAsserted(){return l(this.resource.dateAsserted)}set dateAsserted(e){e instanceof Date?this.resource.dateAsserted=F(e):this.resource.dateAsserted=e}get derivedFrom(){var e;return((e=this.resource.derivedFrom)==null?void 0:e.map(({display:t})=>t||""))||[]}get aggregatedFrom(){const e=K(t=>t.url===z||t.url===B,this.resource.extension);return e!=null&&e.extension?m(e.extension.map(v("valueReference"))):m(this.resource.derivedFrom)}get display(){return p(_(this.resource,this.includedResources))}get dosage(){var e,t;return(t=(e=this.resource.dosage)==null?void 0:e[0])==null?void 0:t.text}get effectiveStart(){var e;return l((e=this.resource.effectivePeriod)==null?void 0:e.start)}get identifier(){var e,t;return(t=(e=this.resource.identifier)==null?void 0:e[0])==null?void 0:t.value}get informationSource(){return this.resource.informationSource||void 0}set informationSource(e){this.resource.informationSource=e}get medicationReference(){var e;return(e=this.resource.medicationReference)==null?void 0:e.display}get notesDisplay(){var e;return((e=this.resource.note)==null?void 0:e.map(({text:t})=>t))||[]}get partOf(){var e,t;return(t=(e=this.resource.partOf)==null?void 0:e[0])==null?void 0:t.display}get patientStatus(){var e;return ce((e=this.builderPatientRxNormStatus)==null?void 0:e[this.rxNorm??""])}get rxNorm(){return oe(this.resource,this.includedResources)}get rxNormCodeableConcept(){const e=I(this.resource,this.includedResources);return{...e??{},display:(e==null?void 0:e.display)??this.display}}get reason(){var e;return p((e=this.resource.reasonCode)==null?void 0:e[0])}get reasonReference(){return this.resource.reasonReference}get isArchived(){return!!this.getBasicResourceByAction("archive")}get isInactive(){return!["active","intended","unknown"].includes(this.status)}get status(){return this.resource.status}get displayStatus(){return this.isArchived?"Dismissed":ee(this.resource.status)}get statusReason(){var e;return p((e=this.resource.statusReason)==null?void 0:e[0])}get subject(){return this.resource.subject}get subjectID(){var t;const[,e]=((t=this.resource.subject.reference)==null?void 0:t.split("/"))||[];return e||""}get patient(){const e=d("Patient",this.resource.contained,this.includedResources,this.resource.subject.reference);if(e)return new b(e,this.includedResources)}get lastFillDate(){var e,t;return l((t=(e=this.resource.extension)==null?void 0:e.find(n=>n.url===X))==null?void 0:t.valueDateTime)}get quantity(){var t,n;const e=(n=(t=this.resource.extension)==null?void 0:t.find(i=>i.url===Y))==null?void 0:n.valueQuantity;if(e)return`${e.value} ${e.unit||""}`}get daysSupply(){var e,t,n,i;return(i=(n=(t=(e=this.resource.extension)==null?void 0:e.find(a=>a.url===V))==null?void 0:t.valueQuantity)==null?void 0:n.value)==null?void 0:i.toString()}get refills(){var e,t,n;return(n=(t=(e=this.resource.extension)==null?void 0:e.find(i=>i.url===G))==null?void 0:t.valueUnsignedInt)==null?void 0:n.toString()}get lastPrescriber(){var n,i;const e=(i=(n=this.resource.extension)==null?void 0:n.find(a=>a.url===U))==null?void 0:i.valueReference;if(!(e!=null&&e.type)||!e.reference)return;const t=d(e.type,this.resource.contained,this.includedResources,e.reference);if(t!=null&&t.name){if(typeof t.name=="string")return t.name;const{family:a,given:c=[]}=t.name[0];return m([a,c[0]]).join(", ")}return e.display}get lastPrescribedDate(){var e,t;return l((t=(e=this.resource.extension)==null?void 0:e.find(n=>n.url===H))==null?void 0:t.valueDateTime)}}class Ce extends h{get performer(){var r;return(r=M(this.resource,this.includedResources))==null?void 0:r.name}get status(){return this.resource.status}get dosage(){var r,e,t;switch(this.resource.resourceType){case"MedicationStatement":return(e=(r=this.resource.dosage)==null?void 0:r[0])==null?void 0:e.text;case"MedicationAdministration":return new ue(this.resource,this.includedResources).dosageDisplay;case"MedicationDispense":case"MedicationRequest":return p((t=this.resource.dosageInstruction)==null?void 0:t[0]);default:return""}}get date(){var r,e,t,n,i,a;switch(this.resource.resourceType){case"MedicationStatement":return this.resource.dateAsserted??((r=this.resource.effectivePeriod)==null?void 0:r.start);case"MedicationAdministration":return(e=this.resource.effectivePeriod)==null?void 0:e.start;case"MedicationDispense":return this.resource.whenHandedOver??this.resource.whenPrepared;case"MedicationRequest":return this.resource.authoredOn??((a=(i=(n=(t=this.resource.dosageInstruction)==null?void 0:t[0].timing)==null?void 0:n.repeat)==null?void 0:i.boundsPeriod)==null?void 0:a.start);default:return""}}get dateLocal(){return l(this.date)}get patient(){var e;const r=d("Patient",this.resource.contained,this.includedResources,(e=this.resource.subject)==null?void 0:e.reference);if(r)return new b(r,this.includedResources)}get prescriber(){switch(this.resource.resourceType){case"MedicationStatement":return new me(this.resource,this.includedResources).lastPrescriber;case"MedicationDispense":return new de(this.resource,this.includedResources).includedPerformer;case"MedicationRequest":return new le(this.resource,this.includedResources).includedRequester;default:return}}}function Oe(s,r){const e=i=>a=>{const c=a[i];return!D(c)||!c?0:new Date(c).getTime()},t=[],n=[];return r.forEach(i=>{const{key:a,dir:c,isDate:u}=i;t.push(g=>ne(g[a]),u?e(a):a),n.push("asc",c)}),R(s,t,n)}function Le(s,r,e,t=!1){const n=D(r)?v(r):r;return t?pe(s,n,e):R(s,r,e)}function pe(s,r,e){return s.sort((t,n)=>{const i=r(t),a=r(n);if(!i&&!a)return 0;if(!i)return e==="asc"?-1:1;if(!a)return e==="asc"?1:-1;const c=new Date(i).getTime(),u=new Date(a).getTime();return e==="asc"?c-u:u-c}),s}export{S as C,me as M,Ce as a,le as b,de as c,ue as d,Oe as e,oe as g,Te as i,xe as r,Le as s};
