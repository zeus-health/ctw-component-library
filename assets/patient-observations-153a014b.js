import{r as p,R as t}from"./index-6f814c40.js";import{c as u}from"./index-74f03c09.js";import{T as x}from"./table-9c863f8c.js";import{u as C}from"./use-breakpoints-96c0a4a7.js";import{F as I}from"./filter-bar-6e12b5f5.js";import{S as A,c as B,u as P,b as k}from"./use-filtered-sorted-data-8434ae56.js";import{d}from"./values-0b6ffb91.js";import"./_baseToString-4993715b.js";import{c as M}from"./filter-d57b1580.js";import"./_baseClone-25b1595e.js";import"./sortBy-919d7262.js";import"./_equalByTag-aaf39779.js";import"./_baseForOwn-d8306f34.js";import{A as D,G as F,a5 as L,a6 as z,I as U,T as Y,e as G,s as Q}from"./patient-helper-a7599db7.js";import"./_createSet-12ef9b81.js";import{D as j}from"./collapsible-data-list-details-f7571cef.js";import{w as O}from"./error-boundary-51e62529.js";import{O as H,D as K}from"./observation-43a17a3c.js";import"./sort-1cf1fc5b.js";import{b as W,u as T}from"./patient-provider-b9fb6722.js";import{D as R}from"./drawer-ed34104d.js";const c=({className:e,columns:a,data:r,emptyMessage:n,isLoading:i,onRowClick:s,rowActions:l})=>{const o=p.useRef(null),N=C(o);return t.createElement("div",{className:e,ref:o},t.createElement(x,{showTableHead:!N.sm,stacked:N.sm,emptyMessage:n,isLoading:i,records:r,RowActions:l,columns:a,handleRowClick:s}))};try{c.displayName="ResourceTable",c.__docgenInfo={description:"",displayName:"ResourceTable",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},columns:{defaultValue:null,description:"",name:"columns",required:!0,type:{name:"TableColumn<T>[]"}},data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"T[]"}},emptyMessage:{defaultValue:null,description:"",name:"emptyMessage",required:!1,type:{name:"string"}},isLoading:{defaultValue:null,description:"",name:"isLoading",required:!0,type:{name:"boolean"}},onRowClick:{defaultValue:null,description:"",name:"onRowClick",required:!1,type:{name:"((record: T) => void)"}},rowActions:{defaultValue:null,description:"",name:"rowActions",required:!1,type:{name:"ComponentType<{ record: T; }>"}}}}}catch{}const m=({className:e,sortOptions:a,filterOptions:r,action:n})=>!a&&!r&&!n?null:t.createElement("div",{className:u(e,"ctw-flex ctw-flex-wrap ctw-items-center ctw-justify-between ctw-py-2 sm:ctw-pt-1.5")},t.createElement("div",{className:"ctw-flex ctw-flex-wrap ctw-gap-x-2"},a&&t.createElement(A,{...a}),r&&t.createElement(I,{...r})),n);try{m.displayName="ResourceTableActions",m.__docgenInfo={description:"",displayName:"ResourceTableActions",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},sortOptions:{defaultValue:null,description:"",name:"sortOptions",required:!1,type:{name:"SortButtonProps<T>"}},filterOptions:{defaultValue:null,description:"",name:"filterOptions",required:!1,type:{name:"FilterBarProps"}},action:{defaultValue:null,description:"",name:"action",required:!1,type:{name:"ReactNode"}}}}}catch{}function S(e){switch(e){case"final":case"amended":case"appended":case"corrected":return"ctw-text-success-main";case"cancelled":case"entered-in-error":return"ctw-text-caution-main";case"registered":case"partial":case"preliminary":case"unknown":default:return"ctw-text-content-lighter"}}const Z=[{title:"Report",widthPercent:30,minWidth:320,render:e=>t.createElement("div",null,t.createElement("div",{className:"ctw-medium-text"},e.displayName))},{title:"Category",render:e=>t.createElement("div",null,e.category)},{title:"Started On",render:e=>t.createElement("div",null,t.createElement("div",{className:"ctw-font-normal"},t.createElement("div",null,e.effectiveStart)))},{title:"Status",render:e=>t.createElement("div",{className:"ctw-flex"},t.createElement("div",{className:u("ctw-text-md",S(e.resource.status))},"•"),t.createElement("div",{className:"ctw-ml-1"},t.createElement("div",null,d(e.resource.status))))},{title:"Observations",render:e=>t.createElement("div",{className:"ctw-flex ctw-justify-center"},t.createElement("div",null,e.results.length))}],$=[{title:"Observation Info",render:e=>t.createElement("div",{className:"ctw-flex"},e.effectiveStart&&t.createElement("div",null,t.createElement("span",{className:"ctw-inline-flex ctw-h-5 ctw-rounded-full ctw-bg-notification-light ctw-px-2 ctw-text-xs ctw-leading-5 ctw-text-notification-main"},e.effectiveStart)," "),t.createElement("div",{className:u("ctw-text-md",S(e.resource.status))},"•"),t.createElement("div",{className:"ctw-ml-1"},t.createElement("div",null,d(e.resource.status)," ")))},{title:"Date and Id",render:e=>{var a;return t.createElement("div",{className:"ctw-ml-1"},D(e.category)||e.display," ",(a=e.resource.identifier)==null?void 0:a[0].value)}},{title:"Reading",render:e=>t.createElement("div",{className:"ctw-ml-1"},e.value," ",e.interpretation)},{title:"Notes",render:e=>e.note&&t.createElement("blockquote",{className:"ctw-mx-3 ctw-my-1 ctw-rounded ctw-bg-bg-lighter ctw-p-1.5 ctw-text-xs ctw-font-light ctw-italic"},e.note)}],f={display:"Effective Date (New to Old)",sorts:[{key:"effectiveStart",dir:"desc",isDate:!0}]},J=[{display:"Name (A-Z)",sorts:[{key:"displayName",dir:"asc"}]},{display:"Name (Z-A)",sorts:[{key:"displayName",dir:"desc"}]},{display:"Effective Date (Old to New)",sorts:[{key:"effectiveStart",dir:"asc",isDate:!0}]},f],y=({className:e,data:a})=>t.createElement("div",{className:e},t.createElement("div",{className:"ctw-text-base ctw-font-medium ctw-uppercase ctw-text-content-light"},"observations"),t.createElement(c,{className:"ctw-patient-observation-details",columns:$,data:a,isLoading:!1,emptyMessage:"There are no observations available."}));try{y.displayName="ObservationsDetails",y.__docgenInfo={description:"",displayName:"ObservationsDetails",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"ObservationModel[]"}}}}}catch{}function E(e){const a=[{label:"Identifier",value:e.identifier},{label:"Service category",value:e.category},{label:"Status",value:d(e.resource.status)},{label:"Value",value:e.value},{label:"Interpretation",value:e.interpretation}];return{id:e.id,date:e.effectiveStart,title:D(e.category),subtitle:e.display,data:a}}const g=e=>[{label:"Organization",value:e.performer},{label:"Identifier",value:e.identifier},{label:"Service category",value:e.category},{label:"Status",value:d(e.resource.status)}];try{E.displayName="setupData",E.__docgenInfo={description:"",displayName:"setupData",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},category:{defaultValue:null,description:"",name:"category",required:!0,type:{name:"string"}},display:{defaultValue:null,description:"",name:"display",required:!0,type:{name:"string"}},effectiveStart:{defaultValue:null,description:"",name:"effectiveStart",required:!0,type:{name:"string | undefined"}},identifier:{defaultValue:null,description:"",name:"identifier",required:!0,type:{name:"string"}},performer:{defaultValue:null,description:"",name:"performer",required:!0,type:{name:"string | undefined"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},interpretation:{defaultValue:null,description:"",name:"interpretation",required:!0,type:{name:"string"}},note:{defaultValue:null,description:"",name:"note",required:!0,type:{name:"string"}},resource:{defaultValue:null,description:"",name:"resource",required:!0,type:{name:"Observation"}},includedResources:{defaultValue:null,description:"",name:"includedResources",required:!1,type:{name:"ResourceMap"}},revIncludes:{defaultValue:null,description:"",name:"revIncludes",required:!1,type:{name:"Resource[]"}},isSummaryResource:{defaultValue:null,description:"",name:"isSummaryResource",required:!0,type:{name:"boolean"}},resourceType:{defaultValue:null,description:"",name:"resourceType",required:!0,type:{name:"string"}},resourceTypeTitle:{defaultValue:null,description:"",name:"resourceTypeTitle",required:!0,type:{name:"string"}},getBasicResourceByAction:{defaultValue:null,description:"",name:"getBasicResourceByAction",required:!0,type:{name:"(profileAction: string) => Basic | undefined"}},toString:{defaultValue:null,description:"",name:"toString",required:!1,type:{name:"() => string"}}}}}catch{}try{g.displayName="diagnosticReportData",g.__docgenInfo={description:"",displayName:"diagnosticReportData",props:{category:{defaultValue:null,description:"",name:"category",required:!0,type:{name:"string | CodeableConcept[]"}},displayName:{defaultValue:null,description:"",name:"displayName",required:!0,type:{name:"any"}},effectiveEnd:{defaultValue:null,description:"",name:"effectiveEnd",required:!0,type:{name:"string | undefined"}},identifier:{defaultValue:null,description:"",name:"identifier",required:!0,type:{name:"string"}},effectiveStart:{defaultValue:null,description:"",name:"effectiveStart",required:!0,type:{name:"string | undefined"}},id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},performer:{defaultValue:null,description:"",name:"performer",required:!0,type:{name:"string | undefined"}},organization:{defaultValue:null,description:"",name:"organization",required:!0,type:{name:"Reference | undefined"}},reportCategory:{defaultValue:null,description:"",name:"reportCategory",required:!0,type:{name:"string"}},results:{defaultValue:null,description:"",name:"results",required:!0,type:{name:"Reference[]"}},resource:{defaultValue:null,description:"",name:"resource",required:!0,type:{name:"DiagnosticReport"}},includedResources:{defaultValue:null,description:"",name:"includedResources",required:!1,type:{name:"ResourceMap"}},revIncludes:{defaultValue:null,description:"",name:"revIncludes",required:!1,type:{name:"Resource[]"}},isSummaryResource:{defaultValue:null,description:"",name:"isSummaryResource",required:!0,type:{name:"boolean"}},resourceType:{defaultValue:null,description:"",name:"resourceType",required:!0,type:{name:"string"}},resourceTypeTitle:{defaultValue:null,description:"",name:"resourceTypeTitle",required:!0,type:{name:"string"}},getBasicResourceByAction:{defaultValue:null,description:"",name:"getBasicResourceByAction",required:!0,type:{name:"(profileAction: string) => Basic | undefined"}},toString:{defaultValue:null,description:"",name:"toString",required:!1,type:{name:"() => string"}}}}}catch{}const v=({diagnosticReport:e})=>{const[a,r]=p.useState([]);return p.useEffect(()=>{r(M(e.results.map(n=>{const i=F("Observation",void 0,e.includedResources,n.reference);if(i)return new H(i,{[e.id]:e.resource})})))},[e]),t.createElement("div",{className:"ctw-space-y-6","data-zus-telemetry-namespace":"Observations"},t.createElement("div",{className:"ctw-py-1"},t.createElement("div",{className:"ctw-text-2xl"},e.displayName)),t.createElement(j,{data:g(e)}),t.createElement(y,{data:a}))},_=O(v,"Observations");try{v.displayName="Component",v.__docgenInfo={description:"",displayName:"Component",props:{diagnosticReport:{defaultValue:null,description:"",name:"diagnosticReport",required:!0,type:{name:"DiagnosticReportModel"}}}}}catch{}try{_.displayName="ObservationDetails",_.__docgenInfo={description:"",displayName:"ObservationDetails",props:{diagnosticReport:{defaultValue:null,description:"",name:"diagnosticReport",required:!0,type:{name:"DiagnosticReportModel"}}}}}catch{}function X(){const{openDrawer:e}=W();return a=>{e({component:r=>t.createElement(w,{diagnosticReport:a,...r})})}}function w({className:e,diagnosticReport:a,isOpen:r,onClose:n}){return t.createElement(R,{className:e,title:"Diagnostic Report",isOpen:r,onClose:n,showCloseFooter:!0},t.createElement(R.Body,null,t.createElement(_,{diagnosticReport:a})))}try{w.displayName="ObservationsDrawer",w.__docgenInfo={description:"",displayName:"ObservationsDrawer",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},diagnosticReport:{defaultValue:null,description:"",name:"diagnosticReport",required:!0,type:{name:"DiagnosticReportModel"}},isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}}}}}catch{}function ee(e){return[{key:"category",type:"checkbox",icon:B,display:"Category",values:P(e,"category")}]}const q={},b=({action:e,className:a,query:r,rowActions:n})=>{const i=X(),{data:s,setFilters:l,setSort:o}=k({defaultSort:f,records:r.data,defaultFilters:q});return t.createElement("div",{className:a},t.createElement(m,{filterOptions:{onChange:l,defaultState:q,filters:ee(r.data??[])},sortOptions:{defaultSort:f,options:J,onChange:o},action:e}),t.createElement(c,{className:"ctw-patient-observations",columns:Z,data:s,emptyMessage:"There are no observation records available.",isLoading:r.isLoading,rowActions:n,onRowClick:i}))};try{b.displayName="PatientObservationsBase",b.__docgenInfo={description:"",displayName:"PatientObservationsBase",props:{action:{defaultValue:null,description:"",name:"action",required:!1,type:{name:"ReactNode"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},query:{defaultValue:null,description:"",name:"query",required:!0,type:{name:"{ data?: DiagnosticReportModel[] | undefined; isLoading: boolean; }"}},rowActions:{defaultValue:null,description:"",name:"rowActions",required:!1,type:{name:"ComponentType<{ record: DiagnosticReportModel; }>"}}}}}catch{}function h(e){const a=e==="builder"?G:Q;return async(r,n)=>{try{const{resources:i,bundle:s}=await a("DiagnosticReport",r,{patientUPID:n.UPID,_include:["DiagnosticReport:result"]});return i.map(l=>new K(l,U(s)))}catch(i){throw Y.logError(i,`Failed fetching ${e} DiagnosticReport resources`)}}}function te(){return T(L,[],h("builder"))}function qe(){return T(z,[],h("outside"))}const ae=({className:e})=>{const a=te();return t.createElement("div",{className:u(e,"ctw-patient-observations")},t.createElement(b,{query:a}))},V=O(ae,"PatientObservations");try{V.displayName="PatientObservations",V.__docgenInfo={description:"",displayName:"PatientObservations",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"Argument"}}}}}catch{}export{b as P,m as R,c as a,V as b,qe as u};
