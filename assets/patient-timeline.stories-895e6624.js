var _=Object.defineProperty;var x=(i,s,e)=>s in i?_(i,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[s]=e;var h=(i,s,e)=>(x(i,typeof s!="symbol"?s+"":s,e),e);import{R as r,r as w}from"./index-6f814c40.js";import{c as P}from"./index-74f03c09.js";import{d as z,a as q,e as C,R as F,b as N}from"./diagnostic-report-dccba89e.js";import{c as O}from"./details-card-fe427194.js";import{b as L,e as G,x as I}from"./values-8fd0e344.js";import{S as j,E as B,b as Q,d as V,e as A,c as U,f as W}from"./encounters-df3570ce.js";import{V as H}from"./view-fhir-6266c459.js";import{F as $,c as b,u as Y,C as K,S as Z}from"./patient-helper-7499a61c.js";import{j as J,i as X,D as ee,f as te}from"./observation-d4392151.js";import"./_baseToString-4993715b.js";import{c as d,g as se}from"./sortBy-df4456c4.js";import"./_baseClone-25b1595e.js";import"./sortBy-d677d734.js";import"./_equalByTag-aaf39779.js";import"./_baseForOwn-d8306f34.js";import"./_createSet-12ef9b81.js";import{s as y}from"./resource-details-drawer-11a3e21b.js";import{a as p}from"./request-3ce689a7.js";import{m as ie,a as ae}from"./medication-request-23eea7be.js";import{p as oe,e as ne,a as re}from"./provenances-5e8ba162.js";import{c as ce}from"./diagnostic-reports-705e4129.js";import{P as le}from"./patient-provider-aad0ed3a.js";import"./_commonjsHelpers-042e6b4d.js";import"./extends-98964cd2.js";import"./index-6de6b113.js";import"./use-watch-a9671586.js";import"./use-controllable-046cc6fb.js";import"./drawer-7774c361.js";import"./isString-35d4a3f2.js";import"./uniq-f5468222.js";import"./use-patient-history-0ccabd64.js";import"./spinner-66aa4ba7.js";import"./isEmpty-bcd6f1a3.js";import"./_baseIsEqual-c150f525.js";import"./error-boundary-bffcb5f1.js";import"./use-breakpoints-4dbacb86.js";import"./mapValues-21907523.js";import"./getPrototypeOf-9c757e77.js";import"./_basePickBy-239377e6.js";import"./table-781acd98.js";import"./index-4d501b15.js";import"./isPlainObject-8e58b46f.js";import"./data-list-254aa0b0.js";import"./loading-c41f709e.js";import"./coding-list-1d7c950f.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./toNumber-9b8ac844.js";import"./faker-8193e1fd.js";function me(i){const s=[];return s.push({key:"type",type:"checkbox",icon:O,display:"Type",values:L(G(i.map(e=>e.type)))}),s}const M={type:{key:"type",selected:["Medication Fill","Prescription","Encounter","Diagnostic Report"],type:"checkbox"}},f={display:"Date (New to Old)",sorts:[{key:"date",dir:"desc",isDate:!0}]},de=[f,{display:"Date (Old to New)",sorts:[{key:"date",dir:"asc",isDate:!0}]}],g=(i=!1)=>{const s=[{title:"Date",widthPercent:10,minWidth:120,dataIndex:"date"},{title:"Type",render:e=>r.createElement("div",null,r.createElement("div",{className:"ctw-font-medium"},e.type),r.createElement("div",null,e.subtype))},{title:"Actor",render:e=>r.createElement(r.Fragment,null,e.actorDetails.map(a=>r.createElement("div",{className:"ctw-capitalize",key:a},a.toLocaleLowerCase())))},{title:"Modifiers",render:e=>r.createElement(j,{items:e.modifiers,limit:3,total:e.modifiers.length})}];return i&&s.push({widthPercent:10,minWidth:200,render:e=>r.createElement(H,{name:"Encounter Resource",resource:e.resource})}),s};try{g.displayName="patientTimelineColumns",g.__docgenInfo={description:"",displayName:"patientTimelineColumns",props:{}}}catch{}class pe extends ${constructor(e,a,n){super(e,a,n);h(this,"kind","TimelineEvent");h(this,"model");switch(e.resourceType){case"Encounter":this.model=new B(e,a,n);break;case"DiagnosticReport":this.model=new ee(e,a,n);break;case"MedicationRequest":this.model=new X(e,a,n);break;case"MedicationDispense":this.model=new J(e,a,n);break;default:throw new Error("This resource is not in type TimelineEvent")}}get date(){switch(this.model.kind){case"Encounter":return this.model.periodStart;case"DiagnosticReport":return this.model.effectiveStart;case"MedicationRequest":return this.model.authoredOn;case"MedicationDispense":return this.model.whenHandedOver||this.model.whenPrepared;default:return}}get type(){switch(this.model.kind){case"Encounter":return"Encounter";case"DiagnosticReport":return"Diagnostic Report";case"MedicationRequest":return"Prescription";case"MedicationDispense":return"Medication Fill";default:return}}get subtype(){switch(this.model.kind){case"Encounter":return this.model.typeDisplay;case"DiagnosticReport":return this.model.category;case"MedicationRequest":return this.model.medicationDisplayName;case"MedicationDispense":return this.model.medicationDisplayName;default:return}}get actorDetails(){switch(this.model.kind){case"Encounter":return d([this.model.participants,this.model.location]);case"DiagnosticReport":return d([this.model.performer]);case"MedicationRequest":return d([this.model.includedRequester]);case"MedicationDispense":return d([this.model.performerDetails.name,this.model.performerDetails.address,this.model.performerDetails.telecom]);default:return[]}}get modifiers(){var e,a,n,l;switch(this.model.kind){case"Encounter":return d(this.model.diagnoses);case"DiagnosticReport":return[this.model.results.length>0?`${this.model.results.length} results available`:""];case"MedicationRequest":return d([b((e=this.model.resource.dosageInstruction)==null?void 0:e[0])]);case"MedicationDispense":return d([b((a=this.model.resource.dosageInstruction)==null?void 0:a[0]),(n=this.model.resource.daysSupply)!=null&&n.value?`Days supply: ${this.model.resource.daysSupply.value}`:"",(l=this.model.resource.quantity)!=null&&l.value?`Quantity: ${this.model.resource.quantity.value}`:""]);default:return[]}}}function ue(){const[i,s]=w.useState(),e=Q(),a=z(),n=V(),l=A(),m=[e,a,n,l];w.useEffect(()=>{const S=d(I(se(m.map(T=>{var v;return(v=T.data)==null?void 0:v.map(he)}))));s(te(S,[{dir:"desc",key:"date",isDate:!0},{dir:"desc",key:"type"}]))},[e.data,a.data,n.data,l.data]);const c=y(m,"isLoading"),o=y(m,"isFetching"),t=y(m,"isError");return{isFetching:o,isLoading:c,isError:t,data:i??[]}}const he=({resource:i,includedResources:s,revIncludes:e})=>new pe(i,s,e);function D({className:i}){const s=ue(),{featureFlags:e}=Y(),{data:a,setFilters:n,setSort:l}=q({defaultFilters:M,defaultSort:f,records:s.data}),m=U(),c=C(),o=W();return r.createElement("div",{className:P(i,"ctw-scrollable-pass-through-height")},r.createElement(F,{filterOptions:{onChange:n,defaultState:M,filters:me(s.data)},sortOptions:{defaultSort:f,options:de,onChange:l}}),r.createElement(N,{showTableHead:!1,isLoading:s.isLoading,data:a,emptyMessage:"There are no timeline records available.",columns:g(e==null?void 0:e.enableViewFhirButton),onRowClick:t=>{switch(t.model.kind){case"Encounter":m(t.model);break;case"DiagnosticReport":c(t.model);break;case"MedicationDispense":case"MedicationRequest":o(t.model);break}}}))}try{D.displayName="PatientTimelineV2",D.__docgenInfo={description:"",displayName:"PatientTimelineV2",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"Argument"}}}}}catch{}const ye={resourceType:"Bundle",id:"f4da1f39-7638-45e4-999b-9ff33d7c5201",meta:{lastUpdated:"2022-11-15T19:37:55.783+00:00"},type:"searchset",total:1,entry:[{resource:{resourceType:"MedicationStatement",id:"0cbb026a-0535-47a1-bbbc-956fcde07dc9",meta:{extension:[{url:"https://zusapi.com/created-at",valueInstant:"2023-03-14T02:04:12.070+00:00"}],versionId:"1",lastUpdated:"2023-03-14T02:04:12.313+00:00",source:"#b6a5f8c980f9ac84",tag:[{system:"https://zusapi.com/accesscontrol/owner",code:"builder/b123",display:"Storybook Health"},{system:"https://zusapi.com/lens",code:"ActiveMedications"},{system:"https://zusapi.com/summary",code:"Common"}]},extension:[{url:"https://zusapi.com/lens/extension/aggregatedFrom",extension:[{url:"https://zusapi.com/lens/extension/aggregatedFrom",valueReference:{reference:"MedicationDispense/612df454-aea8-4ad7-87c4-fd35ee7ce1e3",type:"MedicationDispense"}},{url:"https://zusapi.com/lens/extension/aggregatedFrom",valueReference:{reference:"MedicationRequest/104f6928-da8a-4c0c-b4eb-abeb9e4195f0",type:"MedicationRequest"}}]},{url:"https://zusapi.com/lens/extension/medicationLastFillDate",valueDateTime:"2023-02-21"},{url:"https://zusapi.com/lens/extension/medicationLastPrescribedDate",valueDateTime:"2023-02-21"},{url:"https://zusapi.com/lens/extension/medicationQuantity",valueQuantity:{value:14,unit:"days"}},{url:"https://zusapi.com/lens/extension/medicationDaysSupply",valueQuantity:{value:14}},{url:"https://zusapi.com/lens/extension/medicationRefills",valueUnsignedInt:0},{url:"https://zusapi.com/lens/extension/medicationLastPrescriber",valueReference:{reference:"Practitioner/2eb2b8c3-29a3-4d7f-8feb-b8234aa70701",type:"Practitioner",display:"Phyllis Reeves"}},{url:"https://zusapi.com/fhir/identifier/universal-id",valueString:"35bf3353-165a-454f-94f4-011227a12e18"}],status:"active",medicationCodeableConcept:{coding:[{system:"http://www.nlm.nih.gov/research/umls/rxnorm",code:"1180459"},{system:"http://hl7.org/fhir/sid/ndc",code:"55887023697"},{extension:[{url:"https://zusapi.com/terminology/enrichment",valueString:"Standardization"}],system:"http://www.nlm.nih.gov/research/umls/rxnorm",code:"876195",display:"polyethylene glycol 3350 17000 MG Powder for Oral Solution [Miralax]",userSelected:!1},{extension:[{url:"https://zusapi.com/terminology/enrichment",valueString:"ActiveIngredient"}],system:"http://www.nlm.nih.gov/research/umls/rxnorm",code:"221147",display:"polyethylene glycol 3350",userSelected:!1},{extension:[{url:"https://zusapi.com/terminology/enrichment",valueString:"BrandName"}],system:"http://www.nlm.nih.gov/research/umls/rxnorm",code:"261575",display:"Miralax",userSelected:!1},{extension:[{url:"https://zusapi.com/terminology/enrichment",valueString:"ClinicalDrug_TTY_SCD"}],system:"http://terminology.hl7.org/CodeSystem/v3-NullFlavor",code:"UNK",display:"unknown",userSelected:!1},{extension:[{url:"https://zusapi.com/terminology/enrichment",valueString:"ClinicalDrug_TTY_SCD"}],system:"http://www.nlm.nih.gov/research/umls/rxnorm",code:"876193",display:"polyethylene glycol 3350 17000 MG Powder for Oral Solution",userSelected:!1}],text:"Miralax Oral Product"},subject:{reference:"Patient/a9da7271-99da-42ca-8654-8bea1b2983ca",type:"Patient"},dateAsserted:"2023-02-21",dosage:[{text:"Dissolve 17g in 4–8oz liquid and drink once daily for up to 7 days."}]}}]};function fe(){return{parameters:{msw:{handlers:{mocks:ge()}}}}}function ge(){const i=p.rest.get("https://api.dev.zusapi.com/fhir/Patient",(c,o,t)=>o(t.delay(750),t.status(200),t.json(oe))),s=p.rest.get("https://api.dev.zusapi.com/fhir/Encounter",(c,o,t)=>o(t.status(200),t.json(ne))),e=p.rest.get("https://api.dev.zusapi.com/fhir/MedicationRequest",(c,o,t)=>o(t.status(200),t.json(ie))),a=p.rest.get("https://api.dev.zusapi.com/fhir/MedicationDispense",(c,o,t)=>o(t.status(200),t.json(ae))),n=p.rest.get("https://api.dev.zusapi.com/fhir/MedicationStatement",(c,o,t)=>o(t.status(200),t.json(ye))),l=p.rest.get("https://api.dev.zusapi.com/fhir/Provenance?target=Encounter/:Encounter",async(c,o,t)=>o(t.status(200),t.json(re))),m=p.rest.get("https://api.dev.zusapi.com/fhir/DiagnosticReport",(c,o,t)=>o(t.status(200),t.delay(250),t.json(ce())));return[i,s,l,e,a,n,m]}const ut={component:D,tags:["autodocs"],argTypes:{className:{options:["Blank","Fixed Width"],control:"select",mapping:{Blank:"","Fixed Width":"ctw-m-auto ctw-max-w-[600px]"}}},args:{className:"Blank",readOnly:!1},decorators:[(i,{args:s})=>r.createElement(K,{env:"dev",authToken:"dummy-token",builderId:"b123"},r.createElement(le,{patientID:"u12345",systemURL:Z},r.createElement(i,{args:s})))]},u={...fe()};var E,R,k;u.parameters={...u.parameters,docs:{...(E=u.parameters)==null?void 0:E.docs,source:{originalSource:`{
  ...setupTimelineMocks()
}`,...(k=(R=u.parameters)==null?void 0:R.docs)==null?void 0:k.source}}};const ht=["Basic"];export{u as Basic,ht as __namedExportsOrder,ut as default};
