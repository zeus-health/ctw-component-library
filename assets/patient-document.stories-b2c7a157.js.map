{"version":3,"file":"patient-document.stories-b2c7a157.js","sources":["../../src/components/content/document/document-details-drawer.tsx","../../src/components/content/document/patient-document-columns.tsx","../../src/fhir/models/document.ts","../../src/components/content/document/patient-document-filters.tsx","../../src/fhir/document.ts","../../src/components/content/document/patient-documents.tsx","../../src/components/content/document/story-helpers/mocks/document.ts","../../src/components/content/document/story-helpers/mocks/patient.ts","../../src/components/content/document/story-helpers/mocks/requests.ts","../../src/components/content/document/patient-document.stories.tsx"],"sourcesContent":["import { DocumentButton } from \"../CCDA/document-button\";\nimport { useCCDAModal } from \"../CCDA/modal-ccda\";\nimport { Details } from \"@/components/core/collapsible-data-list-details\";\nimport { Drawer } from \"@/components/core/drawer\";\nimport { useDrawer } from \"@/components/core/providers/drawer-provider\";\nimport { DocumentModel } from \"@/fhir/models/document\";\n\nexport function useDocumentDetailsDrawer() {\n  const { openDrawer } = useDrawer();\n\n  return (document: DocumentModel) => {\n    openDrawer({\n      component: (props) => (\n        <DocumentDetailsDrawer document={document} {...props} />\n      ),\n    });\n  };\n}\n\nexport type DocumentDetailsDrawerProps = {\n  className?: string;\n  document: DocumentModel;\n  isOpen: boolean;\n  onClose: () => void;\n};\n\nexport function DocumentDetailsDrawer({\n  document,\n  className,\n  isOpen,\n  onClose,\n}: DocumentDetailsDrawerProps) {\n  const openCCDAModal = useCCDAModal();\n\n  return (\n    <Drawer\n      className={className}\n      title=\"Document Details\"\n      isOpen={isOpen}\n      onClose={onClose}\n      showCloseFooter\n    >\n      <Drawer.Body>\n        <div className=\"ctw-py-2\">\n          <div className=\"ctw-text-2xl\">\n            {document.dateCreated} - {document.title}\n          </div>\n        </div>\n\n        <Details\n          data={documentData(document)}\n          documentButton={\n            document.binaryID && (\n              <DocumentButton\n                onClick={() =>\n                  document.binaryID &&\n                  openCCDAModal(document.binaryID, \"Document\")\n                }\n                text=\"Source Document\"\n              />\n            )\n          }\n        />\n      </Drawer.Body>\n    </Drawer>\n  );\n}\n\nexport const documentData = (document: DocumentModel) => [\n  { label: \"status\", value: document.status },\n  { label: \"docStatus\", value: document.docStatus },\n  { label: \"Managing Organization\", value: document.custodian },\n  {\n    label: \"Section Display\",\n    value: document.sectionDisplays && (\n      <div>\n        {document.sectionDisplays.map((item, index) => (\n          // eslint-disable-next-line react/no-array-index-key\n          <div key={item + index}>{item}</div>\n        ))}\n      </div>\n    ),\n  },\n];\n","import { TableColumn } from \"@/components/core/table/table-helpers\";\nimport { ViewFHIR } from \"@/components/core/view-fhir\";\nimport { DocumentModel } from \"@/fhir/models/document\";\n\nexport const patientDocumentColumns = (includeViewFhirResource = true) => {\n  const documentColumns: TableColumn<DocumentModel>[] = [\n    {\n      widthPercent: 20,\n      minWidth: 100,\n      title: \"Date Created\",\n      render: (document) => <div>{document.dateCreated}</div>,\n    },\n    {\n      widthPercent: 30,\n      minWidth: 200,\n      title: \"Title\",\n      render: (document) => <div>{document.title}</div>,\n    },\n    {\n      widthPercent: 30,\n      minWidth: 200,\n      title: \"Managing Organization\",\n      render: (document) => <div>{document.custodian}</div>,\n    },\n  ];\n  if (includeViewFhirResource) {\n    documentColumns.push({\n      widthPercent: 20,\n      minWidth: 150,\n      render: (document: DocumentModel) => (\n        <ViewFHIR name=\"Document Resource\" resource={document.resource} />\n      ),\n    });\n  }\n\n  return documentColumns;\n};\n","import { codeableConceptLabel } from \"../codeable-concept\";\nimport { formatISODateStringToDate } from \"../formatters\";\nimport { FHIRModel } from \"./fhir-model\";\n\nexport class DocumentModel extends FHIRModel<fhir4.DocumentReference> {\n  get status(): string {\n    return this.resource.status;\n  }\n\n  get binaryID(): string | undefined {\n    const binaryID = this.resource.content[0].attachment.url;\n\n    if (binaryID) {\n      return binaryID.split(\"/\").pop();\n    }\n    return undefined;\n  }\n\n  get docStatus(): string | undefined {\n    return this.resource.docStatus;\n  }\n\n  get title(): string | undefined {\n    return this.resource.content[0].attachment.title;\n  }\n\n  get dateCreated(): string | undefined {\n    return formatISODateStringToDate(\n      this.resource.content[0].attachment.creation\n    );\n  }\n\n  get custodian(): string | undefined {\n    return this.resource.custodian?.display;\n  }\n\n  get sectionDisplays(): string[] | undefined {\n    return (\n      this.resource.category?.map((coding) => codeableConceptLabel(coding)) ||\n      undefined\n    );\n  }\n}\n","import { DocumentModel } from \"@/fhir/models/document\";\nimport { isEqual, uniqWith } from \"@/utils/nodash\";\n\nexport const applyDocumentFilters = (data: fhir4.DocumentReference[]) => {\n  const documentModel = data.map((document) => new DocumentModel(document));\n  const documentData = uniqWith(documentModel, (a, b) =>\n    isEqual(valuesToDedupeOn(a), valuesToDedupeOn(b))\n  );\n\n  return documentData;\n};\n\nconst valuesToDedupeOn = (document: DocumentModel) => [\n  document.dateCreated,\n  document.custodian,\n  document.title,\n];\n","import { useQueryWithPatient } from \"..\";\nimport { searchCommonRecords } from \"./search-helpers\";\nimport { applyDocumentFilters } from \"@/components/content/document/patient-document-filters\";\nimport { orderBy } from \"@/utils/nodash\";\nimport { QUERY_KEY_PATIENT_DOCUMENTS } from \"@/utils/query-keys\";\n\nexport function usePatientDocument() {\n  return useQueryWithPatient(\n    QUERY_KEY_PATIENT_DOCUMENTS,\n    [],\n    async (requestContext, patient) => {\n      try {\n        const { bundle, resources: documents } = await searchCommonRecords(\n          \"DocumentReference\",\n          requestContext,\n          {\n            patientUPID: patient.UPID,\n          }\n        );\n        return orderBy(\n          applyDocumentFilters(documents),\n          [\n            (document) =>\n              document.resource.content[0].attachment.creation || \"\",\n          ],\n\n          [\"desc\"]\n        );\n      } catch (e) {\n        throw new Error(\n          `Failed fetching document information for patient: ${e}`\n        );\n      }\n    }\n  );\n}\n","import cx from \"classnames\";\nimport { useRef } from \"react\";\nimport { useDocumentDetailsDrawer } from \"./document-details-drawer\";\nimport { patientDocumentColumns } from \"./patient-document-columns\";\nimport { Heading } from \"@/components/core/ctw-box\";\nimport { Table } from \"@/components/core/table/table\";\nimport { usePatientDocument } from \"@/fhir/document\";\nimport { DocumentModel } from \"@/fhir/models/document\";\nimport { useBreakpoints } from \"@/hooks/use-breakpoints\";\n\nexport type PatientDocumentProps = {\n  className?: string;\n  includeViewFhirResource?: boolean;\n};\n\nexport function PatientDocuments({\n  className,\n  includeViewFhirResource,\n}: PatientDocumentProps) {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const breakpoints = useBreakpoints(containerRef);\n  const patientDocumentQuery = usePatientDocument();\n  const openDetails = useDocumentDetailsDrawer();\n\n  function handleRowClick(document: DocumentModel) {\n    openDetails(document);\n  }\n\n  const document = patientDocumentQuery.data ?? [];\n  const { isLoading } = patientDocumentQuery;\n\n  return (\n    <div\n      ref={containerRef}\n      className={cx(\n        \"ctw-border ctw-border-solid ctw-border-divider-light ctw-bg-white\",\n        className,\n        {\n          \"ctw-stacked\": breakpoints.sm,\n        }\n      )}\n    >\n      <Heading title=\"Documents\" />\n      <Table\n        stacked={breakpoints.sm}\n        className=\"-ctw-mx-px !ctw-rounded-none\"\n        isLoading={isLoading}\n        records={document}\n        columns={patientDocumentColumns(includeViewFhirResource)}\n        handleRowClick={handleRowClick}\n      />\n    </div>\n  );\n}\n","export const documents: fhir4.Bundle = {\n  resourceType: \"Bundle\",\n  id: \"b8627acb-9676-47cd-a5b9-145bb680b8eb\",\n  meta: {\n    lastUpdated: \"2023-02-21T16:37:50.194+00:00\",\n  },\n  type: \"searchset\",\n  link: [\n    {\n      relation: \"self\",\n      url: \"https://api.sandbox.zusapi.com/fhir/DocumentReference?_count=250&_tag%3Anot=https%3A%2F%2Fzusapi.com%2Flens%7CActiveMedications&_tag%3Anot=https%3A%2F%2Fzusapi.com%2Flens%7CChronicConditions&_tag%3Anot=https%3A%2F%2Fzusapi.com%2Fsummary%7CCommon&_tag%3Anot=https%3A%2F%2Fzusapi.com%2Ffhir%2Ftag%2Fupi-record-type%7Cuniversal&patient.identifier=https%3A%2F%2Fzusapi.com%2Ffhir%2Fidentifier%2Funiversal-id%7C348a02df-f1a7-4413-93f9-b0802a7a4796\",\n    },\n    {\n      relation: \"next\",\n      url: \"https://api.sandbox.zusapi.com/fhir/DocumentReference?_count=250&_offset=250&_tag%3Anot=https%3A%2F%2Fzusapi.com%2Flens%7CActiveMedications&_tag%3Anot=https%3A%2F%2Fzusapi.com%2Flens%7CChronicConditions&_tag%3Anot=https%3A%2F%2Fzusapi.com%2Fsummary%7CCommon&_tag%3Anot=https%3A%2F%2Fzusapi.com%2Ffhir%2Ftag%2Fupi-record-type%7Cuniversal&patient.identifier=https%3A%2F%2Fzusapi.com%2Ffhir%2Fidentifier%2Funiversal-id%7C348a02df-f1a7-4413-93f9-b0802a7a4796\",\n    },\n  ],\n  entry: [\n    {\n      fullUrl:\n        \"https://api.sandbox.zusapi.com/fhir/DocumentReference/7fbc3222-4d45-4cf2-9bab-e56867c3c9a2\",\n      resource: {\n        resourceType: \"DocumentReference\",\n        id: \"7fbc3222-4d45-4cf2-9bab-e56867c3c9a2\",\n        meta: {\n          versionId: \"9\",\n          lastUpdated: \"2023-02-02T22:17:32.153+00:00\",\n          source: \"#d6fc69a0d3aa79fb\",\n          tag: [\n            {\n              system: \"https://zusapi.com/accesscontrol/owner\",\n              code: \"builder/f4599d90-6d29-4843-a16d-ae7c469eb229\",\n            },\n          ],\n        },\n        extension: [\n          {\n            url: \"https://zusapi.com/fhir/identifier/universal-id\",\n            valueString: \"348a02df-f1a7-4413-93f9-b0802a7a4796\",\n          },\n        ],\n        masterIdentifier: {\n          use: \"usual\",\n          system: \"urn:oid:2.16.840.1.113883.4.570.10\",\n          value: \"458\",\n        },\n        status: \"current\",\n        docStatus: \"final\",\n        type: {\n          coding: [\n            {\n              system: \"http://loinc.org\",\n              code: \"34133-9\",\n              display: \"Summarization of Episode Note\",\n            },\n          ],\n          text: \"Summarization of Episode Note\",\n        },\n        category: [\n          {\n            coding: [\n              {\n                system: \"http://loinc.org\",\n                code: \"48765-2\",\n                display: \"Allergies, Adverse Reactions, Alerts\",\n              },\n            ],\n            text: \"Allergies, Adverse Reactions, Alerts\",\n          },\n          {\n            coding: [\n              {\n                system: \"http://loinc.org\",\n                code: \"10160-0\",\n                display: \"History of Medication Use\",\n              },\n            ],\n            text: \"History of Medication Use\",\n          },\n          {\n            coding: [\n              {\n                system: \"http://loinc.org\",\n                code: \"11450-4\",\n                display: \"Problem List\",\n              },\n            ],\n            text: \"Problem List\",\n          },\n          {\n            coding: [\n              {\n                system: \"http://loinc.org\",\n                code: \"47519-4\",\n                display: \"History of Procedures\",\n              },\n            ],\n            text: \"History of Procedures\",\n          },\n          {\n            coding: [\n              {\n                system: \"http://loinc.org\",\n                code: \"30954-2\",\n                display: \"Relevant Diagnostic Tests and/or Laboratory Data\",\n              },\n            ],\n            text: \"Relevant Diagnostic Tests and/or Laboratory Data\",\n          },\n          {\n            coding: [\n              {\n                system: \"http://loinc.org\",\n                code: \"42348-3\",\n                display: \"Advance Directives\",\n              },\n            ],\n            text: \"Advance Directives\",\n          },\n          {\n            coding: [\n              {\n                system: \"http://loinc.org\",\n                code: \"46239-0\",\n                display: \"Chief Complaint and Reason for Visit\",\n              },\n            ],\n            text: \"Chief Complaint and Reason for Visit\",\n          },\n          {\n            coding: [\n              {\n                system: \"http://loinc.org\",\n                code: \"8653-8\",\n                display: \"Hospital Discharge Instructions\",\n              },\n            ],\n            text: \"Hospital Discharge Instructions\",\n          },\n          {\n            coding: [\n              {\n                system: \"http://loinc.org\",\n                code: \"10183-2\",\n                display: \"Hospital Discharge Medications\",\n              },\n            ],\n            text: \"Hospital Discharge Medications\",\n          },\n          {\n            coding: [\n              {\n                system: \"http://loinc.org\",\n                code: \"46240-8\",\n                display: \"Encounters\",\n              },\n            ],\n            text: \"Encounters\",\n          },\n          {\n            coding: [\n              {\n                system: \"http://loinc.org\",\n                code: \"47420-5\",\n                display: \"Functional Status\",\n              },\n            ],\n            text: \"Functional Status\",\n          },\n          {\n            coding: [\n              {\n                system: \"http://loinc.org\",\n                code: \"11369-6\",\n                display: \"Immunizations\",\n              },\n            ],\n            text: \"Immunizations\",\n          },\n          {\n            coding: [\n              {\n                system: \"http://loinc.org\",\n                code: \"18776-5\",\n                display: \"Plan of Care\",\n              },\n            ],\n            text: \"Plan of Care\",\n          },\n          {\n            coding: [\n              {\n                system: \"http://loinc.org\",\n                code: \"29762-2\",\n                display: \"Social History\",\n              },\n            ],\n            text: \"Social History\",\n          },\n          {\n            coding: [\n              {\n                system: \"http://loinc.org\",\n                code: \"8716-3\",\n                display: \"Vital Signs\",\n              },\n            ],\n            text: \"Vital Signs\",\n          },\n        ],\n        subject: {\n          reference: \"Patient/b1b9380e-390c-42f9-b7bd-edc939edd5f1\",\n          type: \"Patient\",\n          display: \"SOLOMAN BERGAMEL\",\n        },\n        date: \"2022-04-13T15:00:54.460Z\",\n        author: [\n          {\n            reference: \"Organization/a924058c-f6b5-4cef-8fa5-55e20628bbd7\",\n            type: \"Organization\",\n            display: \"Graham Hospital Association\",\n          },\n          {\n            reference: \"Practitioner/fcd8664e-8840-4756-bd2b-a99db9f89119\",\n            type: \"Practitioner\",\n          },\n        ],\n        custodian: {\n          reference: \"Organization/1325be70-fb8d-4f01-99b9-efca49a09d37\",\n          type: \"Organization\",\n          display: \"Graham Hospital Association\",\n        },\n        description: \"Continuity of Care Document (Transition of Care)\",\n        content: [\n          {\n            attachment: {\n              contentType: \"application/xml\",\n              language: \"en-US\",\n              url: \"Binary/fa5b964d-d509-458a-b893-763052df4adf\",\n              hash: \"DOYC3qYo0MgDnxhooYVutWko1/4=\",\n              title: \"Continuity of Care Document (Transition of Care)\",\n              creation: \"2021-09-10T14:38:39-05:00\",\n            },\n          },\n        ],\n        context: {\n          event: [\n            {\n              coding: [\n                {\n                  system: \"http://loinc.org\",\n                  code: \"34133-9\",\n                  display: \"Summarization of Episode Note\",\n                },\n              ],\n              text: \"Summarization of Episode Note\",\n            },\n          ],\n        },\n      },\n      search: {\n        mode: \"match\",\n      },\n    },\n  ],\n};\n","export const patient = {\n  resourceType: \"Bundle\",\n  id: \"f4da1f39-7638-45e4-999b-9ff33d7c5201\",\n  meta: {\n    lastUpdated: \"2022-11-15T19:37:55.783+00:00\",\n  },\n  type: \"searchset\",\n  entry: [\n    {\n      resource: {\n        resourceType: \"Patient\",\n        id: \"u12345\",\n        meta: {\n          extension: [\n            {\n              url: \"https://zusapi.com/created-at\",\n              valueInstant: \"2023-01-26T15:49:38.110+00:00\",\n            },\n          ],\n          versionId: \"2\",\n          lastUpdated: \"2023-01-26T15:49:38.553+00:00\",\n          source: \"#cacbf4a51c11b1b0\",\n          security: [\n            {\n              system: \"http://terminology.hl7.org/CodeSystem/v3-ActReason\",\n              code: \"HTEST\",\n            },\n          ],\n          tag: [\n            {\n              system: \"https://zusapi.com/thirdparty/source\",\n              code: \"commonwell\",\n            },\n            {\n              system: \"https://zusapi.com/accesscontrol/owner\",\n              code: \"builder/f09f6b6f-ae4b-45f4-a653-5677b1582115\",\n              display: \"HLTH 2022 - Gunther\",\n            },\n          ],\n        },\n        identifier: [\n          {\n            system: \"https://zusapi.com/fhir/identifier/universal-id\",\n            value: \"b640bda1-aec7-4be6-a890-e3685a55bce3\",\n          },\n        ],\n        name: [\n          {\n            family: \"Zhang\",\n            given: [\"Bruno\"],\n          },\n        ],\n        telecom: [\n          {\n            system: \"email\",\n            value: \"brunozhang@example.com\",\n          },\n          {\n            system: \"phone\",\n            value: \"555-569-2000\",\n            use: \"home\",\n          },\n          {\n            system: \"phone\",\n            value: \"555-536-3933\",\n            use: \"mobile\",\n          },\n          {\n            system: \"phone\",\n            value: \"555-843-3265\",\n            use: \"work\",\n          },\n        ],\n        gender: \"male\",\n        birthDate: \"1970-05-09\",\n        address: [\n          {\n            line: [\"357 SHADOW LN\"],\n            city: \"LAS VEGAS\",\n            state: \"NV\",\n            postalCode: \"89106-4119\",\n          },\n        ],\n        managingOrganization: {\n          reference: \"Organization/79a1c124-a752-4d9a-a44e-2c02499ae402\",\n        },\n      },\n      search: {\n        mode: \"match\",\n      },\n    },\n  ],\n};\n","import { rest } from \"msw\";\nimport { documents } from \"./document\";\nimport { patient } from \"./patient\";\nimport { conditionBinary } from \"@/components/content/conditions/story-helpers/mocks/condition-binary\";\n\nfunction mockDocumentRequests() {\n  const mockPatientGet = rest.get(\n    \"https://api.dev.zusapi.com/fhir/Patient\",\n    // Add ctx.delay(750), delay to show loading, we set this to 750ms to be\n    // less than the default testing-library timeout of 1000ms.\n    (req, res, ctx) => res(ctx.delay(750), ctx.status(200), ctx.json(patient))\n  );\n\n  const mockDocumentGet = rest.get(\n    \"https://api.dev.zusapi.com/fhir/DocumentReference\",\n    (req, res, ctx) => res(ctx.status(200), ctx.json(documents))\n  );\n\n  const mockBinary = rest.get(\n    \"https://api.dev.zusapi.com/fhir/Binary\",\n    async (_, res, ctx) => res(ctx.status(200), ctx.json(conditionBinary))\n  );\n  return [mockPatientGet, mockDocumentGet, mockBinary];\n}\n\nexport function setupDocumentMocks() {\n  return {\n    parameters: {\n      msw: mockDocumentRequests(),\n    },\n  };\n}\n","import type { Meta, StoryObj } from \"@storybook/react\";\nimport { PatientDocumentProps, PatientDocuments } from \"./patient-documents\";\nimport { setupDocumentMocks } from \"./story-helpers/mocks/requests\";\nimport { CTWProvider } from \"@/components/core/providers/ctw-provider\";\nimport { PatientProvider } from \"@/components/core/providers/patient-provider\";\nimport { SYSTEM_ZUS_UNIVERSAL_ID } from \"@/fhir/system-urls\";\ntype Props = PatientDocumentProps;\nexport default ({\n  component: PatientDocuments,\n  tags: [\"autodocs\"],\n  argTypes: {\n    className: {\n      options: [\"Blank\", \"Fixed Width\"],\n      control: \"select\",\n      mapping: {\n        Blank: \"\",\n        \"Fixed Width\": \"ctw-m-auto ctw-max-w-[600px]\"\n      }\n    }\n  },\n  args: {\n    className: \"Blank\",\n    readOnly: false\n  },\n  decorators: [(Story, {\n    args\n  }) => <CTWProvider env=\"dev\" authToken=\"dummy-token\" builderId=\"b123\">\n        <PatientProvider patientID=\"u12345\" systemURL={SYSTEM_ZUS_UNIVERSAL_ID}>\n          <Story args={args} />\n        </PatientProvider>\n      </CTWProvider>]\n} as Meta<Props>);\nexport const Basic: StoryObj<Props> = {\n  ...setupDocumentMocks()\n};\nBasic.parameters = {\n  ...Basic.parameters,\n  docs: {\n    ...Basic.parameters?.docs,\n    source: {\n      originalSource: \"{\\n  ...setupDocumentMocks()\\n}\",\n      ...Basic.parameters?.docs?.source\n    }\n  }\n};"],"names":["useDocumentDetailsDrawer","openDrawer","useDrawer","document","props","React","DocumentDetailsDrawer","className","isOpen","onClose","openCCDAModal","useCCDAModal","Drawer","Details","documentData","DocumentButton","item","index","patientDocumentColumns","includeViewFhirResource","documentColumns","ViewFHIR","DocumentModel","FHIRModel","binaryID","formatISODateStringToDate","_a","coding","codeableConceptLabel","applyDocumentFilters","data","documentModel","uniqWith","a","b","isEqual","valuesToDedupeOn","usePatientDocument","useQueryWithPatient","QUERY_KEY_PATIENT_DOCUMENTS","requestContext","patient","bundle","documents","searchCommonRecords","orderBy","e","PatientDocuments","containerRef","useRef","breakpoints","useBreakpoints","patientDocumentQuery","openDetails","handleRowClick","document2","isLoading","cx","Heading","Table","mockDocumentRequests","mockPatientGet","rest","req","res","ctx","mockDocumentGet","mockBinary","_","conditionBinary","setupDocumentMocks","patientDocument_stories","Story","args","CTWProvider","PatientProvider","SYSTEM_ZUS_UNIVERSAL_ID","Basic","_c","_b"],"mappings":"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,UACN,QAAS,sCACX,CACF,EACA,KAAM,sCACR,EACA,CACE,OAAQ,CACN,CACE,OAAQ,mBACR,KAAM,UACN,QAAS,2BACX,CACF,EACA,KAAM,2BACR,EACA,CACE,OAAQ,CACN,CACE,OAAQ,mBACR,KAAM,UACN,QAAS,cACX,CACF,EACA,KAAM,cACR,EACA,CACE,OAAQ,CACN,CACE,OAAQ,mBACR,KAAM,UACN,QAAS,uBACX,CACF,EACA,KAAM,uBACR,EACA,CACE,OAAQ,CACN,CACE,OAAQ,mBACR,KAAM,UACN,QAAS,kDACX,CACF,EACA,KAAM,kDACR,EACA,CACE,OAAQ,CACN,CACE,OAAQ,mBACR,KAAM,UACN,QAAS,oBACX,CACF,EACA,KAAM,oBACR,EACA,CACE,OAAQ,CACN,CACE,OAAQ,mBACR,KAAM,UACN,QAAS,sCACX,CACF,EACA,KAAM,sCACR,EACA,CACE,OAAQ,CACN,CACE,OAAQ,mBACR,KAAM,SACN,QAAS,iCACX,CACF,EACA,KAAM,iCACR,EACA,CACE,OAAQ,CACN,CACE,OAAQ,mBACR,KAAM,UACN,QAAS,gCACX,CACF,EACA,KAAM,gCACR,EACA,CACE,OAAQ,CACN,CACE,OAAQ,mBACR,KAAM,UACN,QAAS,YACX,CACF,EACA,KAAM,YACR,EACA,CACE,OAAQ,CACN,CACE,OAAQ,mBACR,KAAM,UACN,QAAS,mBACX,CACF,EACA,KAAM,mBACR,EACA,CACE,OAAQ,CACN,CACE,OAAQ,mBACR,KAAM,UACN,QAAS,eACX,CACF,EACA,KAAM,eACR,EACA,CACE,OAAQ,CACN,CACE,OAAQ,mBACR,KAAM,UACN,QAAS,cACX,CACF,EACA,KAAM,cACR,EACA,CACE,OAAQ,CACN,CACE,OAAQ,mBACR,KAAM,UACN,QAAS,gBACX,CACF,EACA,KAAM,gBACR,EACA,CACE,OAAQ,CACN,CACE,OAAQ,mBACR,KAAM,SACN,QAAS,aACX,CACF,EACA,KAAM,aACR,CACF,EACA,QAAS,CACP,UAAW,+CACX,KAAM,UACN,QAAS,kBACX,EACA,KAAM,2BACN,OAAQ,CACN,CACE,UAAW,oDACX,KAAM,eACN,QAAS,6BACX,EACA,CACE,UAAW,oDACX,KAAM,cACR,CACF,EACA,UAAW,CACT,UAAW,oDACX,KAAM,eACN,QAAS,6BACX,EACA,YAAa,mDACb,QAAS,CACP,CACE,WAAY,CACV,YAAa,kBACb,SAAU,QACV,IAAK,8CACL,KAAM,+BACN,MAAO,mDACP,SAAU,2BACZ,CACF,CACF,EACA,QAAS,CACP,MAAO,CACL,CACE,OAAQ,CACN,CACE,OAAQ,mBACR,KAAM,UACN,QAAS,+BACX,CACF,EACA,KAAM,+BACR,CACF,CACF,CACF,EACA,OAAQ,CACN,KAAM,OACR,CACF,CACF,CACF,ECzQaF,EAAU,CACrB,aAAc,SACd,GAAI,uCACJ,KAAM,CACJ,YAAa,+BACf,EACA,KAAM,YACN,MAAO,CACL,CACE,SAAU,CACR,aAAc,UACd,GAAI,SACJ,KAAM,CACJ,UAAW,CACT,CACE,IAAK,gCACL,aAAc,+BAChB,CACF,EACA,UAAW,IACX,YAAa,gCACb,OAAQ,oBACR,SAAU,CACR,CACE,OAAQ,qDACR,KAAM,OACR,CACF,EACA,IAAK,CACH,CACE,OAAQ,uCACR,KAAM,YACR,EACA,CACE,OAAQ,yCACR,KAAM,+CACN,QAAS,qBACX,CACF,CACF,EACA,WAAY,CACV,CACE,OAAQ,kDACR,MAAO,sCACT,CACF,EACA,KAAM,CACJ,CACE,OAAQ,QACR,MAAO,CAAC,OAAO,CACjB,CACF,EACA,QAAS,CACP,CACE,OAAQ,QACR,MAAO,wBACT,EACA,CACE,OAAQ,QACR,MAAO,eACP,IAAK,MACP,EACA,CACE,OAAQ,QACR,MAAO,eACP,IAAK,QACP,EACA,CACE,OAAQ,QACR,MAAO,eACP,IAAK,MACP,CACF,EACA,OAAQ,OACR,UAAW,aACX,QAAS,CACP,CACE,KAAM,CAAC,eAAe,EACtB,KAAM,YACN,MAAO,KACP,WAAY,YACd,CACF,EACA,qBAAsB,CACpB,UAAW,mDACb,CACF,EACA,OAAQ,CACN,KAAM,OACR,CACF,CACF,CACF,ECvFA,SAASmB,GAAuB,CAC9B,MAAMC,EAAiBC,EAAAA,KAAK,IAC1B,0CAGA,CAACC,EAAKC,EAAKC,IAAQD,EAAIC,EAAI,MAAM,GAAG,EAAGA,EAAI,OAAO,GAAG,EAAGA,EAAI,KAAKxB,CAAO,CAAC,CAAA,EAGrEyB,EAAkBJ,EAAAA,KAAK,IAC3B,oDACA,CAACC,EAAKC,EAAKC,IAAQD,EAAIC,EAAI,OAAO,GAAG,EAAGA,EAAI,KAAKtB,CAAS,CAAC,CAAA,EAGvDwB,EAAaL,EAAAA,KAAK,IACtB,yCACA,MAAOM,EAAGJ,EAAKC,IAAQD,EAAIC,EAAI,OAAO,GAAG,EAAGA,EAAI,KAAKI,CAAe,CAAC,CAAA,EAEhE,MAAA,CAACR,EAAgBK,EAAiBC,CAAU,CACrD,CAEO,SAASG,GAAqB,CAC5B,MAAA,CACL,WAAY,CACV,IAAKV,EAAqB,CAC5B,CAAA,CAEJ,CCxBA,MAAgBW,GAAA,CACd,UAAWxB,EACX,KAAM,CAAC,UAAU,EACjB,SAAU,CACR,UAAW,CACT,QAAS,CAAC,QAAS,aAAa,EAChC,QAAS,SACT,QAAS,CACP,MAAO,GACP,cAAe,8BACjB,CACF,CACF,EACA,KAAM,CACJ,UAAW,QACX,SAAU,EACZ,EACA,WAAY,CAAC,CAACyB,EAAO,CACnB,KAAAC,CACF,oBAAOC,EAAY,CAAA,IAAI,MAAM,UAAU,cAAc,UAAU,MACzD,EAAArE,EAAA,cAACsE,GAAgB,UAAU,SAAS,UAAWC,CAC7C,EAAAvE,EAAA,cAACmE,GAAM,KAAAC,CAAY,CAAA,CACrB,CACF,CAAc,CACpB,EACaI,EAAyB,CACpC,GAAGP,EAAmB,CACxB,YACAO,EAAM,WAAa,CACjB,GAAGA,EAAM,WACT,KAAM,CACJ,IAAGnD,EAAAmD,EAAM,aAAN,YAAAnD,EAAkB,KACrB,OAAQ,CACN,eAAgB;AAAA;AAAA,GAChB,IAAGoD,GAAAC,EAAAF,EAAM,aAAN,YAAAE,EAAkB,OAAlB,YAAAD,EAAwB,MAC7B,CACF,CACF"}