var se=Object.defineProperty;var ne=(t,r,n)=>r in t?se(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n;var z=(t,r,n)=>(ne(t,typeof r!="symbol"?r+"":r,n),n);import{R as B,r as ie}from"./index-6f814c40.js";import{c as oe}from"./index-74f03c09.js";import{u as ae}from"./resource-details-drawer-11adbf7c.js";import{w as ce}from"./error-boundary-65fe3188.js";import{T as le}from"./table-e0266844.js";import{p as ue,b as fe}from"./request-3ce689a7.js";import{g as de,c as he}from"./_commonjsHelpers-042e6b4d.js";import{f as pe,a as I,m as ye,F as me,c as j,w as ge,s as be,Q as we}from"./patient-helper-263e16dc.js";import"./_baseToString-2a4c2757.js";import{o as ve}from"./sortBy-1cabbe82.js";import"./_baseClone-184e5c2b.js";import"./sortBy-649a17b3.js";import"./_equalByTag-5ee6784b.js";import"./_baseForOwn-54d22bab.js";import{i as Ae}from"./isEqual-ee96640d.js";import"./_createSet-014fa0cf.js";import{u as qe}from"./details-card-1ac2a254.js";import{u as Ee}from"./patient-provider-b9da188f.js";import{u as _e}from"./use-breakpoints-3c25321a.js";function Re(t,r){for(var n=0;n<r.length;n++){const s=r[n];if(typeof s!="string"&&!Array.isArray(s)){for(const o in s)if(o!=="default"&&!(o in t)){const c=Object.getOwnPropertyDescriptor(s,o);c&&Object.defineProperty(t,o,c.get?c:{enumerable:!0,get:()=>s[o]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}const Pe=[{title:"Onset",render:t=>B.createElement("div",{className:"group-hover:ctw-underline"},t.onset)},{title:"Description",dataIndex:"display"},{title:"Type",dataIndex:"type"},{title:"Category",dataIndex:"categories"},{title:"Manifestations",dataIndex:"manifestations"}],L={parse:JSON.parse,stringify:JSON.stringify};var Te=function(r){var n=r.uri,s=r.name,o=r.type;this.uri=n,this.name=s,this.type=o},De=Te,W=function(r){return typeof File<"u"&&r instanceof File||typeof Blob<"u"&&r instanceof Blob||r instanceof De};const Oe=W;var Be=W,Fe=function t(r,n,s){n===void 0&&(n=""),s===void 0&&(s=Be);var o,c=new Map;function l(d,h){var m=c.get(h);m?m.push.apply(m,d):c.set(h,d)}if(s(r))o=null,l([n],r);else{var a=n?n+".":"";if(typeof FileList<"u"&&r instanceof FileList)o=Array.prototype.map.call(r,function(d,h){return l([""+a+h],d),null});else if(Array.isArray(r))o=r.map(function(d,h){var m=t(d,""+a+h,s);return m.files.forEach(l),m.clone});else if(r&&r.constructor===Object){o={};for(var f in r){var g=t(r[f],""+a+f,s);g.files.forEach(l),o[f]=g.clone}}else o=r}return{clone:o,files:c}};const Ce=Fe;var Se=typeof self=="object"?self.FormData:typeof window<"u"?window.FormData:void 0;const xe=t=>Oe(t)||t!==null&&typeof t=="object"&&typeof t.pipe=="function",Ie=(t,r,n,s=L)=>{const{clone:o,files:c}=Ce({query:t,variables:r,operationName:n},"",xe);if(c.size===0){if(!Array.isArray(t))return s.stringify(o);if(typeof r<"u"&&!Array.isArray(r))throw new Error("Cannot create request body with given variable type, array expected");const d=t.reduce((h,m,w)=>(h.push({query:m,variables:r?r[w]:void 0}),h),[]);return s.stringify(d)}const l=typeof FormData>"u"?Se:FormData,a=new l;a.append("operations",s.stringify(o));const f={};let g=0;return c.forEach(d=>{f[++g]=d}),a.append("map",s.stringify(f)),g=0,c.forEach((d,h)=>{a.append(`${++g}`,h)}),a},je=t=>t.toUpperCase(),Ne=t=>{const r={};return t.forEach((n,s)=>{r[s]=n}),r},Me=(t,r,n)=>t.document?t:{document:t,variables:r,requestHeaders:n,signal:void 0},Ue=(t,r,n)=>t.query?t:{query:t,variables:r,requestHeaders:n,signal:void 0},He=(t,r)=>t.documents?t:{documents:t,requestHeaders:r,signal:void 0},G=t=>{var s,o;let r;const n=t.definitions.filter(c=>c.kind==="OperationDefinition");return n.length===1&&(r=(o=(s=n[0])==null?void 0:s.name)==null?void 0:o.value),r},N=t=>{if(typeof t=="string"){let n;try{const s=ue(t);n=G(s)}catch{}return{query:t,operationName:n}}const r=G(t);return{query:fe(t),operationName:r}};class D extends Error{constructor(r,n){const s=`${D.extractMessage(r)}: ${JSON.stringify({response:r,request:n})}`;super(s),Object.setPrototypeOf(this,D.prototype),this.response=r,this.request=n,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,D)}static extractMessage(r){var n,s;return((s=(n=r.errors)==null?void 0:n[0])==null?void 0:s.message)??`GraphQL Error (Code: ${r.status})`}}var R={},Le={get exports(){return R},set exports(t){R=t}};(function(t,r){var n=typeof self<"u"?self:he,s=function(){function c(){this.fetch=!1,this.DOMException=n.DOMException}return c.prototype=n,new c}();(function(c){(function(l){var a={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function f(e){return e&&DataView.prototype.isPrototypeOf(e)}if(a.arrayBuffer)var g=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],d=ArrayBuffer.isView||function(e){return e&&g.indexOf(Object.prototype.toString.call(e))>-1};function h(e){if(typeof e!="string"&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function m(e){return typeof e!="string"&&(e=String(e)),e}function w(e){var i={next:function(){var u=e.shift();return{done:u===void 0,value:u}}};return a.iterable&&(i[Symbol.iterator]=function(){return i}),i}function y(e){this.map={},e instanceof y?e.forEach(function(i,u){this.append(u,i)},this):Array.isArray(e)?e.forEach(function(i){this.append(i[0],i[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(i){this.append(i,e[i])},this)}y.prototype.append=function(e,i){e=h(e),i=m(i);var u=this.map[e];this.map[e]=u?u+", "+i:i},y.prototype.delete=function(e){delete this.map[h(e)]},y.prototype.get=function(e){return e=h(e),this.has(e)?this.map[e]:null},y.prototype.has=function(e){return this.map.hasOwnProperty(h(e))},y.prototype.set=function(e,i){this.map[h(e)]=m(i)},y.prototype.forEach=function(e,i){for(var u in this.map)this.map.hasOwnProperty(u)&&e.call(i,this.map[u],u,this)},y.prototype.keys=function(){var e=[];return this.forEach(function(i,u){e.push(u)}),w(e)},y.prototype.values=function(){var e=[];return this.forEach(function(i){e.push(i)}),w(e)},y.prototype.entries=function(){var e=[];return this.forEach(function(i,u){e.push([u,i])}),w(e)},a.iterable&&(y.prototype[Symbol.iterator]=y.prototype.entries);function A(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function q(e){return new Promise(function(i,u){e.onload=function(){i(e.result)},e.onerror=function(){u(e.error)}})}function C(e){var i=new FileReader,u=q(i);return i.readAsArrayBuffer(e),u}function X(e){var i=new FileReader,u=q(i);return i.readAsText(e),u}function K(e){for(var i=new Uint8Array(e),u=new Array(i.length),v=0;v<i.length;v++)u[v]=String.fromCharCode(i[v]);return u.join("")}function $(e){if(e.slice)return e.slice(0);var i=new Uint8Array(e.byteLength);return i.set(new Uint8Array(e)),i.buffer}function k(){return this.bodyUsed=!1,this._initBody=function(e){this._bodyInit=e,e?typeof e=="string"?this._bodyText=e:a.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:a.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:a.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():a.arrayBuffer&&a.blob&&f(e)?(this._bodyArrayBuffer=$(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||d(e))?this._bodyArrayBuffer=$(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||(typeof e=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):a.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a.blob&&(this.blob=function(){var e=A(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?A(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(C)}),this.text=function(){var e=A(this);if(e)return e;if(this._bodyBlob)return X(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(K(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a.formData&&(this.formData=function(){return this.text().then(ee)}),this.json=function(){return this.text().then(JSON.parse)},this}var Y=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Z(e){var i=e.toUpperCase();return Y.indexOf(i)>-1?i:e}function _(e,i){i=i||{};var u=i.body;if(e instanceof _){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,i.headers||(this.headers=new y(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,!u&&e._bodyInit!=null&&(u=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=i.credentials||this.credentials||"same-origin",(i.headers||!this.headers)&&(this.headers=new y(i.headers)),this.method=Z(i.method||this.method||"GET"),this.mode=i.mode||this.mode||null,this.signal=i.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&u)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(u)}_.prototype.clone=function(){return new _(this,{body:this._bodyInit})};function ee(e){var i=new FormData;return e.trim().split("&").forEach(function(u){if(u){var v=u.split("="),b=v.shift().replace(/\+/g," "),p=v.join("=").replace(/\+/g," ");i.append(decodeURIComponent(b),decodeURIComponent(p))}}),i}function te(e){var i=new y,u=e.replace(/\r?\n[\t ]+/g," ");return u.split(/\r?\n/).forEach(function(v){var b=v.split(":"),p=b.shift().trim();if(p){var O=b.join(":").trim();i.append(p,O)}}),i}k.call(_.prototype);function E(e,i){i||(i={}),this.type="default",this.status=i.status===void 0?200:i.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in i?i.statusText:"OK",this.headers=new y(i.headers),this.url=i.url||"",this._initBody(e)}k.call(E.prototype),E.prototype.clone=function(){return new E(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new y(this.headers),url:this.url})},E.error=function(){var e=new E(null,{status:0,statusText:""});return e.type="error",e};var re=[301,302,303,307,308];E.redirect=function(e,i){if(re.indexOf(i)===-1)throw new RangeError("Invalid status code");return new E(null,{status:i,headers:{location:e}})},l.DOMException=c.DOMException;try{new l.DOMException}catch{l.DOMException=function(i,u){this.message=i,this.name=u;var v=Error(i);this.stack=v.stack},l.DOMException.prototype=Object.create(Error.prototype),l.DOMException.prototype.constructor=l.DOMException}function S(e,i){return new Promise(function(u,v){var b=new _(e,i);if(b.signal&&b.signal.aborted)return v(new l.DOMException("Aborted","AbortError"));var p=new XMLHttpRequest;function O(){p.abort()}p.onload=function(){var T={status:p.status,statusText:p.statusText,headers:te(p.getAllResponseHeaders()||"")};T.url="responseURL"in p?p.responseURL:T.headers.get("X-Request-URL");var x="response"in p?p.response:p.responseText;u(new E(x,T))},p.onerror=function(){v(new TypeError("Network request failed"))},p.ontimeout=function(){v(new TypeError("Network request failed"))},p.onabort=function(){v(new l.DOMException("Aborted","AbortError"))},p.open(b.method,b.url,!0),b.credentials==="include"?p.withCredentials=!0:b.credentials==="omit"&&(p.withCredentials=!1),"responseType"in p&&a.blob&&(p.responseType="blob"),b.headers.forEach(function(T,x){p.setRequestHeader(x,T)}),b.signal&&(b.signal.addEventListener("abort",O),p.onreadystatechange=function(){p.readyState===4&&b.signal.removeEventListener("abort",O)}),p.send(typeof b._bodyInit>"u"?null:b._bodyInit)})}return S.polyfill=!0,c.fetch||(c.fetch=S,c.Headers=y,c.Request=_,c.Response=E),l.Headers=y,l.Request=_,l.Response=E,l.fetch=S,Object.defineProperty(l,"__esModule",{value:!0}),l})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var o=s;r=o.fetch,r.default=o.fetch,r.fetch=o.fetch,r.Headers=o.Headers,r.Request=o.Request,r.Response=o.Response,t.exports=r})(Le,R);const F=de(R),$e=Re({__proto__:null,default:F},[R]),P=t=>{let r={};return t&&(typeof Headers<"u"&&t instanceof Headers||$e&&R.Headers&&t instanceof R.Headers?r=Ne(t):Array.isArray(t)?t.forEach(([n,s])=>{n&&s!==void 0&&(r[n]=s)}):r=t),r},Q=t=>t.replace(/([\s,]|#[^\n\r]+)+/g," ").trim(),ke=t=>{if(!Array.isArray(t.query)){const s=t,o=[`query=${encodeURIComponent(Q(s.query))}`];return t.variables&&o.push(`variables=${encodeURIComponent(s.jsonSerializer.stringify(s.variables))}`),s.operationName&&o.push(`operationName=${encodeURIComponent(s.operationName)}`),o.join("&")}if(typeof t.variables<"u"&&!Array.isArray(t.variables))throw new Error("Cannot create query with given variable type, array expected");const r=t,n=t.query.reduce((s,o,c)=>(s.push({query:Q(o),variables:r.variables?r.jsonSerializer.stringify(r.variables[c]):void 0}),s),[]);return`query=${encodeURIComponent(r.jsonSerializer.stringify(n))}`},ze=t=>async r=>{const{url:n,query:s,variables:o,operationName:c,fetch:l,fetchOptions:a,middleware:f}=r,g={...r.headers};let d="",h;t==="POST"?(h=Ie(s,o,c,a.jsonSerializer),typeof h=="string"&&(g["Content-Type"]="application/json")):d=ke({query:s,variables:o,operationName:c,jsonSerializer:a.jsonSerializer??L});const m={method:t,headers:g,body:h,...a};let w=n,y=m;if(f){const A=await Promise.resolve(f({...m,url:n,operationName:c,variables:o})),{url:q,...C}=A;w=q,y=C}return d&&(w=`${w}?${d}`),await l(w,y)};class Ge{constructor(r,n={}){this.url=r,this.requestConfig=n,this.rawRequest=async(...s)=>{const[o,c,l]=s,a=Ue(o,c,l),{headers:f,fetch:g=F,method:d="POST",requestMiddleware:h,responseMiddleware:m,...w}=this.requestConfig,{url:y}=this;a.signal!==void 0&&(w.signal=a.signal);const{operationName:A}=N(a.query);return M({url:y,query:a.query,variables:a.variables,headers:{...P(U(f)),...P(a.requestHeaders)},operationName:A,fetch:g,method:d,fetchOptions:w,middleware:h}).then(q=>(m&&m(q),q)).catch(q=>{throw m&&m(q),q})}}async request(r,...n){const[s,o]=n,c=Me(r,s,o),{headers:l,fetch:a=F,method:f="POST",requestMiddleware:g,responseMiddleware:d,...h}=this.requestConfig,{url:m}=this;c.signal!==void 0&&(h.signal=c.signal);const{query:w,operationName:y}=N(c.document);return M({url:m,query:w,variables:c.variables,headers:{...P(U(l)),...P(c.requestHeaders)},operationName:y,fetch:a,method:f,fetchOptions:h,middleware:g}).then(A=>(d&&d(A),A.data)).catch(A=>{throw d&&d(A),A})}batchRequests(r,n){const s=He(r,n),{headers:o,...c}=this.requestConfig;s.signal!==void 0&&(c.signal=s.signal);const l=s.documents.map(({document:f})=>N(f).query),a=s.documents.map(({variables:f})=>f);return M({url:this.url,query:l,variables:a,headers:{...P(U(o)),...P(s.requestHeaders)},operationName:void 0,fetch:this.requestConfig.fetch??F,method:this.requestConfig.method||"POST",fetchOptions:c,middleware:this.requestConfig.requestMiddleware}).then(f=>(this.requestConfig.responseMiddleware&&this.requestConfig.responseMiddleware(f),f.data)).catch(f=>{throw this.requestConfig.responseMiddleware&&this.requestConfig.responseMiddleware(f),f})}setHeaders(r){return this.requestConfig.headers=r,this}setHeader(r,n){const{headers:s}=this.requestConfig;return s?s[r]=n:this.requestConfig.headers={[r]:n},this}setEndpoint(r){return this.url=r,this}}const M=async t=>{const{query:r,variables:n,fetchOptions:s}=t,o=ze(je(t.method??"post")),c=Array.isArray(t.query),l=await o(t),a=await Qe(l,s.jsonSerializer??L),f=Array.isArray(a)?!a.some(({data:d})=>!d):Boolean(a.data),g=Array.isArray(a)||!a.errors||Array.isArray(a.errors)&&!a.errors.length||s.errorPolicy==="all"||s.errorPolicy==="ignore";if(l.ok&&g&&f){const{errors:d,...h}=(Array.isArray(a),a),m=s.errorPolicy==="ignore"?h:a;return{...c?{data:m}:m,headers:l.headers,status:l.status}}else{const d=typeof a=="string"?{error:a}:a;throw new D({...d,status:l.status,headers:l.headers},{query:r,variables:n})}},Qe=async(t,r)=>{let n;return t.headers.forEach((s,o)=>{o.toLowerCase()==="content-type"&&(n=s)}),n&&(n.toLowerCase().startsWith("application/json")||n.toLowerCase().startsWith("application/graphql+json")||n.toLowerCase().startsWith("application/graphql-response+json"))?r.parse(await t.text()):t.text()},U=t=>typeof t=="function"?t():t,Ve=(t,...r)=>t.reduce((n,s,o)=>`${n}${s}${o in r?r[o]:""}`,""),Je=t=>{const r=t.env==="production"?"https://fqs.api.zusapi.com/query":`https://fqs.${t.env}.zusapi.com/query`;return new Ge(r,{headers:{authorization:`Bearer ${t.authToken}`}})},We=t=>Ve`
  {
    AllergyIntoleranceList(upid: "${t}") {
      id
      meta {
        tag {
          system
          code
        }
      }
      identifier {
        id
        system
        use
        type {
          coding {
            code
            display
            system
          }
        }
        period {
          start
          end
        }
        value
      }
      type
      clinicalStatus {
        coding {
          code
          display
          system
        }
      }
      code {
        coding {
          code
          display
          system
        }
      }
      category
      onsetAge {
        value
        unit
      }
      onsetRange {
        low {
          value
        }
        high {
          value
        }
      }
      onsetPeriod {
        start
        end
      }
      onsetString
      onsetDateTime
      reaction {
        id
        manifestation {
          coding {
            code
            display
            system
          }
        }
      }
    }
  }
`;function Xe(t){var r,n;return t.onsetAge?pe(t.onsetAge):t.onsetDateTime?I(t.onsetDateTime):t.onsetPeriod?I(t.onsetPeriod.start):t.onsetRange?I((n=(r=t.onsetRange.low)==null?void 0:r.value)==null?void 0:n.toString()):ye(t.onsetString)}class Ke extends me{constructor(){super(...arguments);z(this,"kind","Allergy")}get categories(){var n;return(n=this.resource.category)==null?void 0:n.join(", ")}get clinicalStatus(){return j(this.resource.clinicalStatus)}get display(){return j(this.resource.code)}get manifestations(){var s;const n=[];return(s=this.resource.reaction)==null||s.forEach(o=>o.manifestation.forEach(c=>n.push(j(c)))),n.join(", ")}get onset(){return Xe(this.resource)}get type(){return this.resource.type??""}}const H=t=>{const r=t.map(s=>new Ke(s));return qe(r,(s,o)=>Ae(V(s),V(o)))},V=t=>[t.categories,t.clinicalStatus,t.display,t.manifestations,t.onset,t.type];try{H.displayName="applyAllergyFilters",H.__docgenInfo={description:"",displayName:"applyAllergyFilters",props:{}}}catch{}function Ye(t=!1){return Ee(we,[],ge(async(r,n)=>{try{let s;return t?(s=await Je(r).request(We(n.UPID)),s=s.AllergyIntoleranceList):s=(await be("AllergyIntolerance",r,{patientUPID:n.UPID})).resources,ve(H(s),"onset",["desc"])}catch{throw new Error(`Failed fetching allergies information for patient ${n.UPID}`)}},"req.patient_allergies"))}function Ze({className:t,enableFqs:r}){const n=ie.useRef(null),s=_e(n),o=Ye(r),c=ae({header:f=>f.display,details:et}),l=o.data??[],{isLoading:a}=o;return B.createElement("div",{className:oe(t,"ctw-scrollable-pass-through-height"),ref:n,"data-zus-telemetry-namespace":"Allergies"},B.createElement("div",{className:"ctw-scrollable-pass-through-height"},B.createElement(le,{stacked:s.sm,isLoading:a,records:l,columns:Pe,handleRowClick:c})))}const J=ce(Ze,"PatientAllergies"),et=t=>[{label:"Onset",value:t.onset},{label:"Description",value:t.display},{label:"Type",value:t.type},{label:"Category",value:t.categories},{label:"Manifestations",value:t.manifestations}];try{J.displayName="PatientAllergies",J.__docgenInfo={description:"",displayName:"PatientAllergies",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},enableFqs:{defaultValue:null,description:"",name:"enableFqs",required:!1,type:{name:"boolean"}}}}}catch{}export{J as P};
