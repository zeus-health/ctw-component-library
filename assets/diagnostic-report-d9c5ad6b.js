var q=Object.defineProperty;var V=(t,a,e)=>a in t?q(t,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[a]=e;var l=(t,a,e)=>(V(t,typeof a!="symbol"?a+"":a,e),e);import{R as r,r as _}from"./index-6f814c40.js";import{a as S}from"./use-filtered-sorted-data-34406a93.js";import{c as b}from"./index-74f03c09.js";import{e as g}from"./values-74d3734a.js";import{g as I}from"./_baseForOwn-bf15a333.js";import{f as x,c as w}from"./sortBy-5365e8c3.js";import"./_baseClone-1afc8850.js";import"./sortBy-6233a452.js";import"./_baseIsEqual-bfc35476.js";import{F as E,c as s,H as R,y as u,B as T,aq as C,K as P,a1 as M,Y as B,L as N,ar as k,ac as A,T as z,as as F,N as Y,ab as Q}from"./patient-provider-3a9f6b01.js";import"./_createSet-8cf710c5.js";import{D as U}from"./details-card-505ef9df.js";import{w as L}from"./error-boundary-a6cc52ac.js";import"./request-b468d8d1.js";import{D as h}from"./drawer-10febc18.js";import{i as G,N as H}from"./null-flavor-59b32e73.js";class K extends E{constructor(){super(...arguments);l(this,"kind","DiagnosticReport")}get category(){var n,o,c,v;const e=s((n=this.resource.category)==null?void 0:n[0])||this.reportCategory;if(e)return e;const i=s((o=this.resource.category)==null?void 0:o[0]);return((v=R("Observation",void 0,this.includedResources,(c=this.resource.result)==null?void 0:c[0].reference))==null?void 0:v.category)??`No display value found ${i?" for ":""}${i}`}get displayName(){var n;const{code:e}=this.resource,i=s(e);return G((n=e.coding)==null?void 0:n[0])?I(H,[i,"display"],"Unknown"):i}get effectiveEnd(){var e;return(e=this.resource.effectivePeriod)!=null&&e.end?u(this.resource.effectivePeriod.end):this.effectiveStart}get identifier(){var e;return((e=this.resource.identifier)==null?void 0:e[0].value)??""}get effectiveStart(){var e;return u(((e=this.resource.effectivePeriod)==null?void 0:e.start)||this.resource.effectiveDateTime)}get performer(){var e,i;return((e=this.organization)==null?void 0:e.display)||((i=this.resource.performer)==null?void 0:i[0].display)}get organization(){const e=this.resource.performer??[];return x(e,{type:"Organization"})}get reportCategory(){var e;return((e=T([{system:C},{system:P}],this.resource.code))==null?void 0:e.display)??s(this.resource.code)}get results(){return this.resource.result??[]}}class $ extends E{constructor(){super(...arguments);l(this,"kind","Observation")}get category(){var e;return s((e=this.resource.category)==null?void 0:e[0])}get display(){return s(this.resource.code)}get effectiveStart(){var e;return u(((e=this.resource.effectivePeriod)==null?void 0:e.start)||this.resource.effectiveDateTime)}get identifier(){var e;return((e=this.resource.identifier)==null?void 0:e[0].value)??""}get performer(){var e;return(e=this.resource.performer)==null?void 0:e[0].display}get value(){var e,i;return w([(e=this.resource.valueQuantity)==null?void 0:e.value,(i=this.resource.valueQuantity)==null?void 0:i.unit]).join("")}get interpretation(){var e;return s((e=this.resource.interpretation)==null?void 0:e[0])}get notes(){var e;return((e=this.resource.note)==null?void 0:e[0].text)??""}}const me=[{title:"Report",widthPercent:30,minWidth:320,dataIndex:"displayName"},{title:"Category",dataIndex:"category"},{title:"Started On",dataIndex:"effectiveStart"},{title:"Status",render:t=>r.createElement("div",{className:"ctw-flex"},r.createElement("div",{className:b("ctw-text-md",D(t.resource.status))},"•"),r.createElement("div",{className:"ctw-ml-1"},r.createElement("div",null,g(t.resource.status))))},{title:"Observations",render:t=>r.createElement("div",{className:"ctw-text-center"},t.results.length)}],W=[{title:"Observation Info",render:t=>r.createElement("div",{className:"ctw-flex"},t.effectiveStart&&r.createElement("div",null,r.createElement("span",{className:"ctw-inline-flex ctw-h-5 ctw-rounded-full ctw-bg-notification-light ctw-px-2 ctw-text-xs ctw-leading-5 ctw-text-notification-main"},t.effectiveStart)," "),r.createElement("div",{className:b("ctw-text-md",D(t.resource.status))},"•"),r.createElement("div",{className:"ctw-ml-1"},r.createElement("div",null,g(t.resource.status)," ")))},{title:"Date and Id",render:t=>{var a;return r.createElement("div",{className:"ctw-ml-1"},M(t.category)||t.display," ",(a=t.resource.identifier)==null?void 0:a[0].value)}},{title:"Reading",render:t=>r.createElement("div",{className:"ctw-ml-1"},t.value," ",t.interpretation)},{title:"Notes",render:t=>t.notes&&r.createElement("blockquote",{className:"ctw-mx-3 ctw-my-1 ctw-rounded ctw-bg-bg-lighter ctw-p-1.5 ctw-text-xs ctw-font-light ctw-italic"},t.notes)}];function D(t){switch(t){case"final":case"amended":case"appended":case"corrected":return"ctw-text-success-main";case"cancelled":case"entered-in-error":return"ctw-text-caution-main";case"registered":case"partial":case"preliminary":case"unknown":default:return"ctw-text-content-lighter"}}const d=({className:t,data:a})=>r.createElement("div",{className:t},r.createElement("div",{className:"ctw-text-base ctw-font-medium ctw-uppercase ctw-text-content-light"},"observations"),r.createElement(S,{className:"ctw-patient-observation-details",columns:W,data:a,isLoading:!1,emptyMessage:"There are no observations available."}));try{d.displayName="ObservationsTable",d.__docgenInfo={description:"",displayName:"ObservationsTable",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"ObservationModel[]"}}}}}catch{}const p=t=>[{label:"Organization",value:t.performer},{label:"Identifier",value:t.identifier},{label:"Service category",value:t.category},{label:"Status",value:g(t.resource.status)}],m=({diagnosticReport:t})=>{const[a,e]=_.useState([]);return _.useEffect(()=>{e(w(t.results.map(i=>{const n=R("Observation",void 0,t.includedResources,i.reference);if(n)return new $(n,{[t.id]:t.resource})})))},[t]),r.createElement("div",{className:"ctw-space-y-6","data-zus-telemetry-namespace":"Observations"},r.createElement("div",{className:"ctw-text-2xl"},t.displayName),r.createElement(U,{details:p(t)}),r.createElement(d,{data:a}))},f=L(m,"Observations");try{p.displayName="diagnosticReportData",p.__docgenInfo={description:"",displayName:"diagnosticReportData",props:{kind:{defaultValue:null,description:"",name:"kind",required:!0,type:{name:'"DiagnosticReport"'}},category:{defaultValue:null,description:"",name:"category",required:!0,type:{name:"string | CodeableConcept[]"}},displayName:{defaultValue:null,description:"",name:"displayName",required:!0,type:{name:"any"}},effectiveEnd:{defaultValue:null,description:"",name:"effectiveEnd",required:!0,type:{name:"string | undefined"}},identifier:{defaultValue:null,description:"",name:"identifier",required:!0,type:{name:"string"}},effectiveStart:{defaultValue:null,description:"",name:"effectiveStart",required:!0,type:{name:"string | undefined"}},performer:{defaultValue:null,description:"",name:"performer",required:!0,type:{name:"string | undefined"}},organization:{defaultValue:null,description:"",name:"organization",required:!0,type:{name:"Reference | undefined"}},reportCategory:{defaultValue:null,description:"",name:"reportCategory",required:!0,type:{name:"string"}},results:{defaultValue:null,description:"",name:"results",required:!0,type:{name:"Reference[]"}},resource:{defaultValue:null,description:"",name:"resource",required:!0,type:{name:"DiagnosticReport"}},includedResources:{defaultValue:null,description:"",name:"includedResources",required:!1,type:{name:"ResourceMap"}},revIncludes:{defaultValue:null,description:"",name:"revIncludes",required:!1,type:{name:"Resource[]"}},id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},key:{defaultValue:null,description:"",name:"key",required:!0,type:{name:"string"}},versionId:{defaultValue:null,description:"",name:"versionId",required:!0,type:{name:"string"}},isArchived:{defaultValue:null,description:"",name:"isArchived",required:!0,type:{name:"boolean"}},isSummaryResource:{defaultValue:null,description:"",name:"isSummaryResource",required:!0,type:{name:"boolean"}},resourceType:{defaultValue:null,description:"",name:"resourceType",required:!0,type:{name:"string"}},resourceTypeTitle:{defaultValue:null,description:"",name:"resourceTypeTitle",required:!0,type:{name:"string"}},getBasicResourceByAction:{defaultValue:null,description:"",name:"getBasicResourceByAction",required:!0,type:{name:"(profileAction: string) => Basic | undefined"}},isEnriched:{defaultValue:null,description:"",name:"isEnriched",required:!0,type:{name:"() => boolean"}},toString:{defaultValue:null,description:"",name:"toString",required:!1,type:{name:"() => string"}}}}}catch{}try{m.displayName="Component",m.__docgenInfo={description:"",displayName:"Component",props:{diagnosticReport:{defaultValue:null,description:"",name:"diagnosticReport",required:!0,type:{name:"DiagnosticReportModel"}}}}}catch{}try{f.displayName="ObservationDetails",f.__docgenInfo={description:"",displayName:"ObservationDetails",props:{diagnosticReport:{defaultValue:null,description:"",name:"diagnosticReport",required:!0,type:{name:"DiagnosticReportModel"}}}}}catch{}function fe(){const{openDrawer:t}=B();return a=>{t({component:e=>r.createElement(y,{diagnosticReport:a,...e})})}}function y({className:t,diagnosticReport:a,isOpen:e,onClose:i}){return r.createElement(h,{className:t,title:"Diagnostic Report",isOpen:e,onClose:i,showCloseFooter:!0},r.createElement(h.Body,null,r.createElement(f,{diagnosticReport:a})))}try{y.displayName="ObservationsDrawer",y.__docgenInfo={description:"",displayName:"ObservationsDrawer",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},diagnosticReport:{defaultValue:null,description:"",name:"diagnosticReport",required:!0,type:{name:"DiagnosticReportModel"}},isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}}}}}catch{}function ye(){return N(F,[],O("builder"))}function ge(){return N(k,[],O("outside"))}function O(t){const a=t==="builder"?Y:Q;return async(e,i)=>{try{const{resources:n,bundle:o}=await a("DiagnosticReport",e,{patientUPID:i.UPID,_include:["DiagnosticReport:result"]});return n.map(c=>new K(c,A(o)))}catch(n){throw z.logError(n,`Failed fetching ${t} DiagnosticReport resources`)}}}export{K as D,fe as a,ye as b,me as d,ge as u};
