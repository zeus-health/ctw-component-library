import{r as c,R as e}from"./index-6f814c40.js";import{c as f}from"./index-74f03c09.js";import{e as b,h as H,i as R,t as S,u as F,f as T,s as O,d as I,p as q}from"./requests-996131c8.js";import{$ as L,a0 as V,j as D,d as j,h as B,i as W,p as M,P as $,S as U}from"./index-7892bf45.js";import"./_baseToString-d6b3b198.js";import"./_getTag-f6946e3e.js";import"./_baseClone-73248e56.js";import{b as E}from"./action-list-93d490b0.js";import"./sortBy-1bd29ff1.js";import"./_baseForOwn-d14a5c7b.js";import{m as Q,T as z}from"./table-5f18d0a5.js";import"./_createSet-958401e2.js";import{c as Y}from"./_basePickBy-b8cc8020.js";import"./drawer-6b4601a7.js";import"./spinner-66aa4ba7.js";import"./index-7a14e213.js";import"./_commonjsHelpers-042e6b4d.js";import"./isEqual-f880f949.js";import"./_baseIsEqual-87615994.js";import"./coding-list-1d7c950f.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./data-list-254aa0b0.js";import"./extends-c883cf05.js";import"./uniq-838ae00f.js";import"./noop-640bb2f2.js";import"./isString-de61ee5c.js";import"./index-6de6b113.js";import"./mapValues-bf5b7280.js";import"./debounce-df0b008f.js";import"./toNumber-dfb0a5dc.js";import"./isPlainObject-1763b18f.js";function Z(t,n){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:n},t),c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"}))}const G=c.forwardRef(Z),J=G;function p({hideAdd:t,onToggleShowHistoric:n}){const o=b();return e.createElement("div",{className:"ctw-flex ctw-items-center ctw-justify-end ctw-space-x-2 ctw-border-0 ctw-border-t ctw-border-solid ctw-border-divider-light ctw-py-5 ctw-px-4"},e.createElement(L,{name:"historic",text:"Show Historic",onChange:n}),!t&&e.createElement("button",{type:"button",className:"ctw-btn-icon",onClick:()=>o()},e.createElement(J,{className:"ctw-h-4 ctw-w-4"})))}try{p.displayName="PatientConditionsActions",p.__docgenInfo={description:"",displayName:"PatientConditionsActions",props:{hideAdd:{defaultValue:null,description:"",name:"hideAdd",required:!0,type:{name:"boolean"}},onToggleShowHistoric:{defaultValue:null,description:"",name:"onToggleShowHistoric",required:!0,type:{name:"() => void"}}}}}catch{}function K(t){switch(t){case"Active":return"ctw-text-success-main";case"Pending":return"ctw-text-caution-main";default:return"ctw-text-content-lighter"}}const X=[{widthPercent:30,minWidth:320,render:t=>e.createElement("div",null,e.createElement("div",{className:"ctw-pc-title group-hover:ctw-underline"},t.display),e.createElement("div",{className:"ctw-pc-chapter"},t.ccsChapter))},{render:t=>{var n,o;return e.createElement("div",{className:"ctw-pc-status-container"},e.createElement("div",{className:f("ctw-pc-status-dot",K(t.displayStatus))},"â€¢"),e.createElement("div",{className:"ctw-pc-status-and-extra"},e.createElement("div",{className:"ctw-pc-status"},t.displayStatus),t.isSummaryResource?e.createElement("div",null,E([(o=(n=t.patient)==null?void 0:n.organization)==null?void 0:o.name,t.recordedDate]).join(" ")):e.createElement("div",null,E([t.recorder,t.recordedDate]).join(" "))))},widthPercent:30,minWidth:128},{widthPercent:40,minWidth:132,render:t=>{const n=t.isSummaryResource?"Earliest known onset:":"Onset:";return e.createElement("div",{className:"ctw-pc-onset-notes"},t.onset&&e.createElement("div",null,n," ",t.onset),e.createElement("div",{className:"ctw-pc-notes"},t.notes.join(" ")))}}];function tt(){const[t,n]=c.useState({collection:"patient",showHistoric:!1});function o(a){n(Q(Y(t),a))}function i(a,r){return(t.collection==="patient"?a:r).filter(d=>t.showHistoric?!0:["Active","Pending"].includes(d.displayStatus))}return{filters:t,updateFilters:o,applyFilters:i}}function u({collection:t,otherConditions:n,onCollectionChange:o}){function i(r){return t===r?"ctw-btn-primary":"ctw-btn-default"}const a=n.filter(r=>r.displayStatus==="Active").length;return e.createElement("div",{className:"ctw-flex ctw-items-center ctw-justify-between ctw-py-5 ctw-px-4"},e.createElement("div",{className:"ctw-text-xl ctw-font-medium ctw-text-content-black"},"Conditions"),e.createElement("div",{className:"ctw-space-x-2"},e.createElement("button",{type:"button",className:i("patient"),onClick:()=>o("patient")},"Patient Record"),e.createElement("button",{type:"button",className:f(i("other"),"ctw-space-x-2"),onClick:()=>o("other")},e.createElement("span",null,"Other Provider Records"),e.createElement(V,{text:`${a}`,color:"gray"}))))}try{u.displayName="PatientConditionsHeader",u.__docgenInfo={description:"",displayName:"PatientConditionsHeader",props:{collection:{defaultValue:null,description:"",name:"collection",required:!0,type:{name:"enum",value:[{value:'"patient"'},{value:'"other"'}]}},otherConditions:{defaultValue:null,description:"",name:"otherConditions",required:!0,type:{name:"ConditionModel[]"}},onCollectionChange:{defaultValue:null,description:"",name:"onCollectionChange",required:!0,type:{name:"(collection: FilterCollection) => void"}}}}}catch{}const w=({record:t})=>{const n=H(),o=R();return e.createElement("div",{className:"ctw-flex ctw-space-x-2"},!t.isDeleted&&e.createElement("button",{type:"button",className:"ctw-btn-default",onClick:i=>{i.stopPropagation(),o(t)}},"Remove"),e.createElement("button",{type:"button",className:"ctw-btn-primary",onClick:i=>{i.stopPropagation(),n(t)}},"Edit"))},C=({record:t})=>{const n=b(),{getRequestContext:o}=D();return e.createElement("div",{className:"ctw-flex ctw-space-x-2"},e.createElement("button",{type:"button",className:"ctw-btn-default",onClick:async i=>{i.stopPropagation(),await S(t,await o())}},t.isArchived?"Restore":"Dismiss"),e.createElement("button",{type:"button",className:"ctw-btn-primary",onClick:i=>{i.stopPropagation(),n(t)}},"Add"))};try{w.displayName="PatientConditionHoverActions",w.__docgenInfo={description:"",displayName:"PatientConditionHoverActions",props:{record:{defaultValue:null,description:"",name:"record",required:!0,type:{name:"ConditionModel"}}}}}catch{}try{C.displayName="OtherProviderConditionHoverActions",C.__docgenInfo={description:"",displayName:"OtherProviderConditionHoverActions",props:{record:{defaultValue:null,description:"",name:"record",required:!0,type:{name:"ConditionModel"}}}}}catch{}function h({className:t,readOnly:n=!1}){const{filters:o,updateFilters:i,applyFilters:a}=tt(),r=c.useRef(null),l=j(r),d=F(),y=B(),v=W();function P(){const s=y.isLoading,A=s||v.isLoading;return o.collection==="patient"?s:A}const g=y.data??[],_=T(v.data??[],g,!0),x=a(g,_),k=o.collection==="patient"?w:C;return e.createElement("div",{ref:r,className:f("ctw-patient-conditions",t,{"ctw-patient-conditions-stacked":l.sm})},e.createElement(u,{otherConditions:_,collection:o.collection,onCollectionChange:s=>i({collection:s})}),e.createElement(p,{hideAdd:n||o.collection==="other",onToggleShowHistoric:()=>i({showHistoric:!o.showHistoric})}),e.createElement(z,{stacked:l.sm,className:"-ctw-mx-px !ctw-rounded-none",showTableHead:!1,isLoading:P(),records:x,RowActions:n?void 0:k,columns:X,handleRowClick:s=>d({condition:s,readOnly:n||s.isSummaryResource})}))}try{h.displayName="PatientConditions",h.__docgenInfo={description:"",displayName:"PatientConditions",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},readOnly:{defaultValue:{value:"false"},description:"",name:"readOnly",required:!1,type:{name:"boolean"}}}}}catch{}const Ft={component:h,tags:["docsPage"],argTypes:{className:{options:["Blank","Fixed Width"],control:"select",mapping:{Blank:"","Fixed Width":"ctw-m-auto ctw-max-w-[600px]"}}},args:{className:"Blank",readOnly:!1},decorators:[(t,{args:n})=>e.createElement(M,{env:"dev",authToken:"dummy-token",builderId:"b123"},e.createElement($,{patientID:"u12345",systemURL:U},e.createElement(t,{args:n})))]},m={...O({otherConditions:I,patientConditions:q})};var N;m.parameters={...m.parameters,storySource:{source:`{
  ...setupConditionMocks({
    otherConditions,
    patientConditions
  })
}`,...(N=m.parameters)==null?void 0:N.storySource}};const Tt=["Basic"];export{m as Basic,Tt as __namedExportsOrder,Ft as default};
//# sourceMappingURL=patient-conditions.stories-2f1641d8.js.map
