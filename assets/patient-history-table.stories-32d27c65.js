var I=Object.defineProperty;var _=(t,e,r)=>e in t?I(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var u=(t,e,r)=>(_(t,typeof e!="symbol"?e+"":e,r),r);import{r as m,R as a}from"./index-6f814c40.js";import{c as T}from"./index-74f03c09.js";import{g as H,h as R,u as S,i as b,s as k,j as q,T as C,Q as x,w as A,k as D,H as M,l as B,m as V,C as L,a as U,S as W}from"./patient-allergies-f897ce6b.js";import"./_baseForOwn-6ce43847.js";import"./uniqWith-18747e2c.js";import{c as w,T as F}from"./table-ab102265.js";import"./_baseClone-7e8cfb08.js";import"./_baseIsEqual-2f71925b.js";import{u as Y}from"./uniq-41de9089.js";import"./_baseUniq-cf39c5a7.js";import"./action-list-a695328d.js";import"./request-02bc8afe.js";import"./drawer-3e903764.js";import"./spinner-66aa4ba7.js";import{s as Q}from"./requests-60702e4a.js";import"./_commonjsHelpers-042e6b4d.js";import"./extends-866f950d.js";import"./_basePickBy-a6d7916f.js";import"./toNumber-6e4e7434.js";import"./index-d206d595.js";import"./mapValues-dc8f3697.js";import"./index-6de6b113.js";import"./debounce-5d5a9f7a.js";import"./data-list-254aa0b0.js";import"./isEqual-dc54df64.js";import"./isPlainObject-f4e3af75.js";import"./index-135b3e83.js";class ${constructor(e,r){u(this,"kind","PatientHistory");u(this,"historyInfo");u(this,"patient");this.patient=e,this.historyInfo=r}get messages(){var e;return(e=this.historyInfo)==null?void 0:e._messages}get key(){var e;return((e=this.historyInfo)==null?void 0:e.uuid)||""}get lastRetrievedAt(){var e;return H((e=this.historyInfo)==null?void 0:e._lastUpdated)}get createdAt(){var e;return R((e=this.historyInfo)==null?void 0:e._createdAt,"M/d/yy h:mm a")}get retrievedStatus(){var e;return(e=this.historyInfo)==null?void 0:e.status}}function O(t,e){return S(x,[t,e],async r=>{try{const s=await b(r),o=e*t,f=o+t,d=k(s.data,"_createdAt","desc",!0).slice(o,f),c=Y(w(d.map(i=>i.initialData.patientId)));if(!c.length)return{total:0,patients:[]};const h=await q(r,void 0,c),p=w(d.map(i=>{const l=h.patients.find(n=>n.id===i.initialData.patientId);return l?new $(l,i):void 0}));return{total:s.data.length,patients:p}}catch(s){throw C.logError(s,"Failed fetching patient history patients."),new Error(`Failed fetching patient history patients: ${s}`)}})}const g=A(({className:t,handleRowClick:e,pageSize:r=20,title:s="Patient History Request"})=>{const[o,f]=m.useState(1),[d,c]=m.useState(0),[h,p]=m.useState([]),{data:{patients:i,total:l}={},isFetching:n,isError:E}=O(r,o-1);return m.useEffect(()=>{!n&&i&&(c(l??0),p(i))},[i,l,E,n]),m.useEffect(()=>{E&&(c(0),p([]))},[E,n]),a.createElement(D,{className:T("ctw-patients-table",t),"data-zus-telemetry-namespace":"PatientsTable"},a.createElement(M,{title:s},a.createElement("div",{className:"ctw-relative"},a.createElement("div",{className:"ctw-search-icon-wrapper"},a.createElement(B,{className:"ctw-search-icon"})),a.createElement("input",{type:"text",className:"ctw-patients-table-search",placeholder:"Search",name:"searchPatientName"}))),a.createElement("div",{className:"ctw-overflow-hidden"},a.createElement(F,{records:h,columns:j,pageSize:r,handleRowClick:e,hidePagination:!0},a.createElement(V,{setCurrentPage:f,total:d,currentPage:o,pageSize:r,isLoading:n}))))},"PatientsHistoryTable"),j=[{title:"Name",render:t=>a.createElement(K,{data:t})},{title:"Initiated",render:t=>a.createElement("div",null,t.createdAt)},{title:"Status",render:t=>{var e;return a.createElement(a.Fragment,null,(e=t.messages)==null?void 0:e.map(r=>{var s;return a.createElement("div",{className:"ctw-status-column",key:`${(s=t.historyInfo)==null?void 0:s.uuid}-${r.service}`},a.createElement("div",{className:"ctw-capitalize"},r.service),a.createElement("div",null,"-"),a.createElement("div",null,r.status))}))}}],K=({data:t})=>a.createElement("div",{className:"ctw-flex ctw-items-center"},a.createElement("div",{className:"ctw-ml-4"},a.createElement("div",{className:"ctw-flex ctw-font-medium"},a.createElement("div",{className:"ctw-max-w-xs"},t.patient.fullName),t.patient.resource.gender&&a.createElement("div",{className:"ctw-uppercase"},"(",t.patient.resource.gender[0],")")),a.createElement("div",{className:"ctw-text-content-lighter"},t.patient.dob," (",t.patient.age,")")));try{g.displayName="PatientHistoryTable",g.__docgenInfo={description:"",displayName:"PatientHistoryTable",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"Argument"}},handleRowClick:{defaultValue:null,description:"",name:"handleRowClick",required:!1,type:{name:"((row: PatientHistoryRequestModel) => void)"}},pageSize:{defaultValue:null,description:"",name:"pageSize",required:!1,type:{name:"number"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}},getRowClasses:{defaultValue:null,description:"",name:"getRowClasses",required:!1,type:{name:"((row: PatientModel) => Argument)"}},onRowClick:{defaultValue:null,description:"",name:"onRowClick",required:!1,type:{name:"((row: PatientModel) => void)"}}}}}catch{}const Ie={component:g,tags:["autodocs"],args:{},decorators:[(t,{args:e})=>a.createElement(L,{env:"dev",authToken:"dummy-token",builderId:"b123"},a.createElement(U,{patientID:"u12345",systemURL:W},a.createElement(t,{args:e})))]},y={...Q()};var v,P,N;y.parameters={...y.parameters,docs:{...(v=y.parameters)==null?void 0:v.docs,source:{originalSource:`{
  ...setupPatientHistoryMocks()
}`,...(N=(P=y.parameters)==null?void 0:P.docs)==null?void 0:N.source}}};const _e=["Basic"];export{y as Basic,_e as __namedExportsOrder,Ie as default};
