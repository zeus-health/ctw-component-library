import{R as t,r as _}from"./index-6f814c40.js";import{c as W}from"./index-74f03c09.js";import{f as Z,P as K,h as X,i as ee,t as te,u as ne,s as z,d as ae,p as re,e as q}from"./requests-350ae0bf.js";import{u as Q,P as oe}from"./use-patient-history-b631b3ce.js";import{F as se,D as ie,T as ce}from"./tab-group-21709d74.js";import{C as de,T as le}from"./table-12f80a1c.js";import"./_baseToString-7c0e3f59.js";import{c as C,f as pe}from"./sortBy-cdc8b01b.js";import"./_baseClone-3ae78372.js";import"./sortBy-ee350c06.js";import{b as I}from"./_equalByTag-eda72788.js";import"./_baseForOwn-03e9c2f3.js";import"./_createSet-6ff8e1d4.js";import{c as ue}from"./_basePickBy-b5376a08.js";import{u as v}from"./uniq-8676ca12.js";import{u as me,C as ye,S as Ce}from"./patient-helper-e281ba6b.js";import{s as fe}from"./sort-2ee927a0.js";import{B as he}from"./badge-8ef10589.js";import{e as G,u as we}from"./conditions-2cd64fa4.js";import{w as ge}from"./error-boundary-d1aa0574.js";import{u as ve}from"./use-breakpoints-ed433bef.js";import{P as _e}from"./patient-provider-d8a611e8.js";import"./_commonjsHelpers-042e6b4d.js";import"./drawer-de3413cf.js";import"./index-6de6b113.js";import"./medication-4b27da28.js";import"./collapsible-data-list-details-f7571cef.js";import"./document-icon-581c51b2.js";import"./uniqBy-7bfbe8b6.js";import"./_baseIsEqual-7d59e24c.js";import"./mapValues-c63fd567.js";import"./isPlainObject-243fdc78.js";import"./request-5d5ec5f4.js";import"./urls-e3325bab.js";import"./spinner-66aa4ba7.js";import"./startCase-e12a4b87.js";import"./combobox-field-881c664c.js";import"./debounce-5029c56d.js";import"./toNumber-d7ce3bd9.js";import"./modal-ccda-d0449947.js";import"./isEqual-298b6ab1.js";import"./uniqWith-79e2a4b4.js";import"./coding-list-1d7c950f.js";import"./loading-c7ff698a.js";import"./condition-binary-d416dd33.js";import"./dropdown-menu-e59b19de.js";import"./extends-98964cd2.js";import"./isString-933c0e0c.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./pickBy-f6e57f40.js";import"./ctw-box-d758dfda.js";function b({hideAdd:e,sortOptions:n,updateSorts:r,activeCollection:o,currentSorts:a,filterItems:l,setFilters:p,filters:s}){const c=Z(),d=Q();return t.createElement("div",{className:"ctw-flex ctw-flex-wrap ctw-items-center ctw-justify-between ctw-py-2 sm:ctw-pt-1.5"},t.createElement("div",{className:"ctw-flex ctw-flex-wrap ctw-gap-x-2"},t.createElement(Se,{options:n,updateSorts:r,activeCollection:o,currentSorts:a}),t.createElement(se,{filters:l,handleOnChange:p,defaultState:s})),d.lastRetrievedAt&&e&&t.createElement(K,{patientHistory:d,message:"Last Retrieved"}),!e&&t.createElement("button",{type:"button",className:"ctw-btn-primary ctw-p-0",onClick:()=>c()},"Add Condition"))}const Se=({options:e,updateSorts:n,activeCollection:r,currentSorts:o})=>t.createElement(ie,{type:"select",buttonClassName:"ctw-bg-transparent ctw-border-none ctw-p-0",onItemSelect:a=>{const{dir:l,key:p,isDate:s}=e.filter(c=>c.display===a.key)[0];n({[r]:{key:p,dir:l,isDate:s,display:a.name}})},items:e.map(a=>({key:a.display,name:a.display,isSelected:o.display===a.display}))},t.createElement("div",{className:"ctw-btn-default ctw-flex ctw-items-center ctw-space-x-1"},t.createElement("span",null,"Sort"),t.createElement(de,{className:"ctw-h-4"})));try{b.displayName="PatientConditionsActions",b.__docgenInfo={description:"",displayName:"PatientConditionsActions",props:{hideAdd:{defaultValue:null,description:"",name:"hideAdd",required:!0,type:{name:"boolean"}},sortOptions:{defaultValue:null,description:"",name:"sortOptions",required:!0,type:{name:"SortOption<ConditionModel>[]"}},updateSorts:{defaultValue:null,description:"",name:"updateSorts",required:!0,type:{name:"(newSorts: Partial<Sort>) => void"}},activeCollection:{defaultValue:null,description:"",name:"activeCollection",required:!0,type:{name:"enum",value:[{value:'"patient"'},{value:'"other"'}]}},currentSorts:{defaultValue:null,description:"",name:"currentSorts",required:!0,type:{name:"Sort"}},filterItems:{defaultValue:null,description:"",name:"filterItems",required:!0,type:{name:"FilterItem[]"}},setFilters:{defaultValue:null,description:"",name:"setFilters",required:!0,type:{name:"(filterChangeEvent: FilterChangeEvent) => void"}},filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"FilterChangeEvent"}}}}}catch{}function Ee(e){switch(e){case"Active":return"ctw-text-success-main";case"Pending":return"ctw-text-caution-main";default:return"ctw-text-content-lighter"}}const be=[{widthPercent:30,minWidth:320,render:e=>t.createElement("div",null,t.createElement("div",{className:"ctw-pc-title group-hover:ctw-underline"},e.display),t.createElement("div",{className:"ctw-pc-chapter"},e.ccsChapter))},{render:e=>{var n,r;return t.createElement("div",{className:"ctw-pc-status-container"},t.createElement("div",{className:W("ctw-pc-status-dot",Ee(e.displayStatus))},"â€¢"),t.createElement("div",{className:"ctw-pc-status-and-extra"},t.createElement("div",{className:"ctw-pc-status"},e.displayStatus),e.isSummaryResource?t.createElement("div",null,C([(r=(n=e.patient)==null?void 0:n.organization)==null?void 0:r.name,e.recordedDate]).join(" ")):t.createElement("div",null,C([e.recorder,e.recordedDate]).join(" "))))},widthPercent:30,minWidth:128},{widthPercent:40,minWidth:132,render:e=>{const n=e.isSummaryResource?"Earliest known onset:":"Onset:";return t.createElement("div",{className:"ctw-pc-onset-notes"},e.onset&&t.createElement("div",null,n," ",e.onset),t.createElement("div",{className:"ctw-pc-notes"},e.notes.join(" ")))}}],ke={patient:{displayStatus:{key:"displayStatus",selected:["Active","Pending","Unknown"],type:"checkbox"}},other:{displayStatus:{key:"displayStatus",selected:["Active","Pending","Unknown"],type:"checkbox"}}};function k(e){const[n,r]=_.useState({...ke});function o(s){r(()=>({...n,[e]:{...a(s)}}))}const a=s=>{const c=ue(s),d=pe(c,i=>typeof(i==null?void 0:i.selected)>"u"&&(i==null?void 0:i.type)==="checkbox"||(i==null?void 0:i.type)==="select");return d!=null&&d.key?{...c,[d.key]:{isOpen:!0}}:s};function l(s){var c,d;return[{key:"displayStatus",type:"checkbox",icon:"eye",display:()=>"Status",values:v(s.map(i=>i.displayStatus)),isOpen:(c=n[e].displayStatus)==null?void 0:c.isOpen},{key:"ccsChapter",type:"checkbox",icon:"eye",display:()=>"Category",values:C(v(s.map(i=>i.ccsChapter))),isOpen:(d=n[e].ccsChapter)==null?void 0:d.isOpen}]}function p(s,c){const d=e==="patient"?s:c;return d.filter(i=>Object.entries(n[e]).every(([F,u])=>{if((u==null?void 0:u.type)==="checkbox"&&I(u.selected)){const m=u.selected.filter(S=>C(v(d.map(h=>h[u.key]))).includes(S)),f=i[u.key]??"";return m.length<1||m.includes(String(f))}return!0}))}return{filters:n,updateFilters:o,applyFilters:p,availableFilters:l}}try{k.displayName="useConditionFilters",k.__docgenInfo={description:"",displayName:"useConditionFilters",props:{}}}catch{}const N=({record:e})=>{const n=X(),r=ee();return t.createElement("div",{className:"ctw-flex ctw-space-x-2"},!e.isDeleted&&t.createElement("button",{type:"button",className:"ctw-btn-default",onClick:o=>{o.stopPropagation(),r(e)}},"Remove"),t.createElement("button",{type:"button",className:"ctw-btn-primary",onClick:o=>{o.stopPropagation(),n(e)}},"Edit"))},P=({record:e})=>{const n=Z(),{getRequestContext:r}=me();return t.createElement("div",{className:"ctw-flex ctw-space-x-2"},t.createElement("button",{type:"button",className:"ctw-btn-default",onClick:async o=>{o.stopPropagation(),await te(e,await r())}},e.isArchived?"Restore":"Dismiss"),t.createElement("button",{type:"button",className:"ctw-btn-primary",onClick:o=>{o.stopPropagation(),n(e)}},"Add"))};try{N.displayName="PatientConditionHoverActions",N.__docgenInfo={description:"",displayName:"PatientConditionHoverActions",props:{record:{defaultValue:null,description:"",name:"record",required:!0,type:{name:"ConditionModel"}}}}}catch{}try{P.displayName="OtherProviderConditionHoverActions",P.__docgenInfo={description:"",displayName:"OtherProviderConditionHoverActions",props:{record:{defaultValue:null,description:"",name:"record",required:!0,type:{name:"ConditionModel"}}}}}catch{}const L={key:"recordedDate",dir:"desc",display:"Last Updated Date (Newest to Oldest)"},Ne={patient:{...L},other:{...L}},Pe=[{display:"Name (A-Z)",key:"display",dir:"asc"},{display:"Name (Z-A)",key:"display",dir:"desc"},{display:"Category (A-Z)",key:"ccsChapter",dir:"asc"},{display:"Category (Z-A)",key:"ccsChapter",dir:"desc"},{display:"Status (A-Z)",key:"displayStatus",dir:"asc"},{display:"Status (Z-A)",key:"displayStatus",dir:"desc"},{display:"Last Updated Date (Oldest to Newest)",key:"recordedDate",dir:"asc",isDate:!0},{display:"Last Updated Date (Newest to Oldest)",key:"recordedDate",dir:"desc",isDate:!0}];function A(e){const[n,r]=_.useState(Ne);function o(l){r({...n,...l})}function a(l){const p=n[e];return fe(l,s=>s[p.key],p.dir,p.isDate)}return{applySorts:a,sortOptions:Pe,updateSorts:o,currentSorts:n}}try{A.displayName="useConditionSorts",A.__docgenInfo={description:"",displayName:"useConditionSorts",props:{}}}catch{}const Ae=[{key:"inactive-provider-records",getPanelClassName:e=>e?"ctw-mt-0":"ctw-mt-2",display:()=>"condition list",render:()=>null},{key:"other-provider-records",getPanelClassName:e=>e?"ctw-mt-0":"ctw-mt-2",display:()=>t.createElement(t.Fragment,null,t.createElement("span",{className:"ctw-pr-2 ctw-capitalize"},"other provider records"),t.createElement(Oe,null)),render:()=>null}];function O({collection:e,onCollectionChange:n,forceHorizontalTabs:r=!1}){const o=Q();return t.createElement(t.Fragment,null,e==="other"&&t.createElement(oe,{status:o.lastStatus,date:o.dateCreatedAt}),t.createElement(ce,{content:Ae,forceHorizontalTabs:r,onChange:a=>{n(a===0?"patient":"other")}}))}const Oe=()=>{const n=G().data.filter(r=>r.displayStatus==="Active");return n.length>0?t.createElement(he,{color:"notification",text:n.length.toString(),className:"ctw-h-5"}):null};try{O.displayName="PatientConditionsTabs",O.__docgenInfo={description:"",displayName:"PatientConditionsTabs",props:{collection:{defaultValue:null,description:"",name:"collection",required:!0,type:{name:"enum",value:[{value:'"patient"'},{value:'"other"'}]}},forceHorizontalTabs:{defaultValue:{value:"false"},description:"",name:"forceHorizontalTabs",required:!1,type:{name:"boolean"}},onCollectionChange:{defaultValue:null,description:"",name:"onCollectionChange",required:!0,type:{name:"(collection: FilterCollection) => void"}}}}}catch{}const xe=(e,n)=>e.filter(r=>Object.entries(n).every(([o,a])=>{if((a==null?void 0:a.type)==="checkbox"&&I(a.selected)){const l=a.selected.filter(s=>C(v(e.map(c=>c[a.key]))).includes(s)),p=r[a.key];return l.length<1||l.includes(String(p))}return!0})),x=ge(({className:e,readOnly:n=!1,hideBuilderOwnedRecords:r=!1,hideOutsideOwnedRecords:o=!1})=>{const[a,l]=_.useState(r?"other":"patient"),{filters:p,updateFilters:s,availableFilters:c}=k(a),{applySorts:d,sortOptions:i,updateSorts:F,currentSorts:u}=A(a),m=_.useRef(null),f=ve(m),S=ne(),h=we(),T=G();function Y(){const y=h.isLoading,J=y||T.isLoading;return a==="patient"?y:J}const D=h.data??[],R=T.data;let E=xe(a==="patient"?D:R,p[a]);E=d(E);const $=a==="patient"?N:P;return t.createElement("div",{ref:m,className:W("ctw-patient-conditions ctw-items-center ctw-justify-between ctw-bg-white",e,{"ctw-patient-conditions-stacked":f.sm})},!(r||o)&&t.createElement(O,{forceHorizontalTabs:!0,collection:a,onCollectionChange:l}),t.createElement(b,{sortOptions:i,updateSorts:F,activeCollection:a,hideAdd:n||a==="other",currentSorts:u[a],filterItems:c(a==="patient"?D:R),setFilters:s,filters:p[a]}),t.createElement(le,{stacked:f.sm,removeLeftAndRightBorders:!0,className:"-ctw-mx-px !ctw-rounded-none",showTableHead:!1,emptyMessage:"There are no condition records available.",isLoading:Y(),records:E,RowActions:n?void 0:$,columns:be,handleRowClick:y=>S({condition:y,readOnly:n||y.isSummaryResource})}))},"PatientConditions");try{x.displayName="PatientConditions",x.__docgenInfo={description:"",displayName:"PatientConditions",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},readOnly:{defaultValue:null,description:"",name:"readOnly",required:!1,type:{name:"boolean"}},hideBuilderOwnedRecords:{defaultValue:null,description:"",name:"hideBuilderOwnedRecords",required:!1,type:{name:"boolean"}},hideOutsideOwnedRecords:{defaultValue:null,description:"",name:"hideOutsideOwnedRecords",required:!1,type:{name:"boolean"}}}}}catch{}const At={component:x,tags:["autodocs"],argTypes:{className:{options:["Blank","Fixed Width"],control:"select",mapping:{Blank:"","Fixed Width":"ctw-m-auto ctw-max-w-[600px]"}}},args:{className:"Blank",readOnly:!1},decorators:[(e,{args:n})=>t.createElement(ye,{env:"dev",authToken:"dummy-token",builderId:"b123"},t.createElement(_e,{patientID:"u12345",systemURL:Ce},t.createElement(e,{args:n})))]},w={...z({otherConditions:ae,patientConditions:re})},g={...z({otherConditions:q,patientConditions:q})};var H,V,B;w.parameters={...w.parameters,docs:{...(H=w.parameters)==null?void 0:H.docs,source:{originalSource:`{
  ...setupConditionMocks({
    otherConditions,
    patientConditions
  })
}`,...(B=(V=w.parameters)==null?void 0:V.docs)==null?void 0:B.source}}};var U,M,j;g.parameters={...g.parameters,docs:{...(U=g.parameters)==null?void 0:U.docs,source:{originalSource:`{
  ...setupConditionMocks({
    otherConditions: emptyConditions,
    patientConditions: emptyConditions
  })
}`,...(j=(M=g.parameters)==null?void 0:M.docs)==null?void 0:j.source}}};const Ot=["Basic","Empty"];export{w as Basic,g as Empty,Ot as __namedExportsOrder,At as default};
//# sourceMappingURL=patient-conditions.stories-efe31e48.js.map
