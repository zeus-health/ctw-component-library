import{r as l,R as a}from"./index-6f814c40.js";import{c as k}from"./index-74f03c09.js";import{O as fe,a as be}from"./other-provider-meds-table-262c3b67.js";import{u as ye,c as he,d as ve,b as ne,S as oe}from"./use-filtered-sorted-data-8434ae56.js";import"./_baseToString-4993715b.js";import{c as we}from"./filter-d57b1580.js";import"./_baseClone-25b1595e.js";import"./sortBy-919d7262.js";import"./_equalByTag-aaf39779.js";import"./_baseForOwn-d8306f34.js";import"./_createSet-12ef9b81.js";import{m as se,d as $,P as Te}from"./provider-meds-table-fa5def75.js";import{u as ge,a as ie,M as xe}from"./use-medications-e29e9b2a.js";import{p as Ee,g as Pe,t as Se,i as ee}from"./values-0b6ffb91.js";import{s as Ie}from"./sort-1cf1fc5b.js";import{w as Ae,S as _e}from"./error-boundary-51e62529.js";import{L as Me,F as Oe}from"./filter-bar-6e12b5f5.js";import{u as ke}from"./use-breakpoints-96c0a4a7.js";import{h as le,c as Ne,C as N,y as D,s as G,a as j,$ as H,I as ce,o as F,M as V,e as De,j as g,O as A,T as x,u as de,t as He,S as te,v as re}from"./use-watch-a9671586.js";import{s as Re}from"./calculate-active-index-048f6a58.js";function qe({onFocus:e}){let[t,r]=l.useState(!0);return t?a.createElement(le,{as:"button",type:"button",features:Ne.Focusable,onFocus:s=>{s.preventDefault();let n,c=50;function i(){if(c--<=0){n&&cancelAnimationFrame(n);return}if(e()){r(!1),cancelAnimationFrame(n);return}n=requestAnimationFrame(i)}n=requestAnimationFrame(i)}}):null}var Ce=(e=>(e[e.SetSelectedIndex=0]="SetSelectedIndex",e[e.RegisterTab=1]="RegisterTab",e[e.UnregisterTab=2]="UnregisterTab",e[e.RegisterPanel=3]="RegisterPanel",e[e.UnregisterPanel=4]="UnregisterPanel",e))(Ce||{});let Fe={[0](e,t){let r=e.tabs.filter(c=>{var i;return!((i=c.current)!=null&&i.hasAttribute("disabled"))});if(t.index<0)return{...e,selectedIndex:e.tabs.indexOf(r[0])};if(t.index>e.tabs.length)return{...e,selectedIndex:e.tabs.indexOf(r[r.length-1])};let s=e.tabs.slice(0,t.index),n=[...e.tabs.slice(t.index),...s].find(c=>r.includes(c));return n?{...e,selectedIndex:e.tabs.indexOf(n)}:e},[1](e,t){var r;if(e.tabs.includes(t.tab))return e;let s=e.tabs[e.selectedIndex],n=re([...e.tabs,t.tab],i=>i.current),c=(r=n.indexOf(s))!=null?r:e.selectedIndex;return c===-1&&(c=e.selectedIndex),{...e,tabs:n,selectedIndex:c}},[2](e,t){return{...e,tabs:e.tabs.filter(r=>r!==t.tab)}},[3](e,t){return e.panels.includes(t.panel)?e:{...e,panels:re([...e.panels,t.panel],r=>r.current)}},[4](e,t){return{...e,panels:e.panels.filter(r=>r!==t.panel)}}},Q=l.createContext(null);Q.displayName="TabsSSRContext";function J(e){let t=l.useContext(Q);if(t===null){let r=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,J),r}return t}let K=l.createContext(null);K.displayName="TabsDataContext";function _(e){let t=l.useContext(K);if(t===null){let r=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,_),r}return t}let X=l.createContext(null);X.displayName="TabsActionsContext";function Y(e){let t=l.useContext(X);if(t===null){let r=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,Y),r}return t}function Ve(e,t){return de(t.type,Fe,e,t)}let $e=l.Fragment,ze=N(function(e,t){let{defaultIndex:r=0,vertical:s=!1,manual:n=!1,onChange:c,selectedIndex:i=null,...v}=e;const m=s?"vertical":"horizontal",w=n?"manual":"auto";let u=i!==null,h=D(t),[p,o]=l.useReducer(Ve,{selectedIndex:i??r,tabs:[],panels:[]}),T=l.useMemo(()=>({selectedIndex:p.selectedIndex}),[p.selectedIndex]),f=G(c||(()=>{})),b=G(p.tabs),E=l.useMemo(()=>({orientation:m,activation:w,...p}),[m,w,p]),S=G(u?e.selectedIndex:p.selectedIndex),I=l.useMemo(()=>({registerTab(y){return o({type:1,tab:y}),()=>o({type:2,tab:y})},registerPanel(y){return o({type:3,panel:y}),()=>o({type:4,panel:y})},change(y){S.current!==y&&f.current(y),u||o({type:0,index:y})}}),[o,u]);j(()=>{o({type:0,index:i??r})},[i]);let M=l.useRef({tabs:[],panels:[]}),z={ref:h};return a.createElement(Q.Provider,{value:M},a.createElement(X.Provider,{value:I},a.createElement(K.Provider,{value:E},E.tabs.length<=0&&a.createElement(qe,{onFocus:()=>{var y,R;for(let q of b.current)if(((y=q.current)==null?void 0:y.tabIndex)===0)return(R=q.current)==null||R.focus(),!0;return!1}}),H({ourProps:z,theirProps:v,slot:T,defaultTag:$e,name:"Tabs"}))))}),Ge="div",Le=N(function(e,t){let{orientation:r,selectedIndex:s}=_("Tab.List"),n=D(t);return H({ourProps:{ref:n,role:"tablist","aria-orientation":r},theirProps:e,slot:{selectedIndex:s},defaultTag:Ge,name:"Tabs.List"})}),Be="button",Ue=N(function(e,t){var r,s;let n=`headlessui-tabs-tab-${ce()}`,{orientation:c,activation:i,selectedIndex:v,tabs:m,panels:w}=_("Tab"),u=Y("Tab"),h=_("Tab"),p=J("Tab"),o=l.useRef(null),T=D(o,t);j(()=>u.registerTab(o),[u,o]);let f=p.current.tabs.indexOf(n);f===-1&&(f=p.current.tabs.push(n)-1);let b=m.indexOf(o);b===-1&&(b=f);let E=b===v,S=F(d=>{var P;let C=d();if(C===V.Success&&i==="auto"){let pe=(P=De(o))==null?void 0:P.activeElement,Z=h.tabs.findIndex(me=>me.current===pe);Z!==-1&&u.change(Z)}return C}),I=F(d=>{let P=m.map(C=>C.current).filter(Boolean);if(d.key===g.Space||d.key===g.Enter){d.preventDefault(),d.stopPropagation(),u.change(b);return}switch(d.key){case g.Home:case g.PageUp:return d.preventDefault(),d.stopPropagation(),S(()=>A(P,x.First));case g.End:case g.PageDown:return d.preventDefault(),d.stopPropagation(),S(()=>A(P,x.Last))}if(S(()=>de(c,{vertical(){return d.key===g.ArrowUp?A(P,x.Previous|x.WrapAround):d.key===g.ArrowDown?A(P,x.Next|x.WrapAround):V.Error},horizontal(){return d.key===g.ArrowLeft?A(P,x.Previous|x.WrapAround):d.key===g.ArrowRight?A(P,x.Next|x.WrapAround):V.Error}}))===V.Success)return d.preventDefault()}),M=l.useRef(!1),z=F(()=>{var d;M.current||(M.current=!0,(d=o.current)==null||d.focus(),u.change(b),He(()=>{M.current=!1}))}),y=F(d=>{d.preventDefault()}),R=l.useMemo(()=>({selected:E}),[E]),q=e,ue={ref:T,onKeyDown:I,onMouseDown:y,onClick:z,id:n,role:"tab",type:Re(e,o),"aria-controls":(s=(r=w[b])==null?void 0:r.current)==null?void 0:s.id,"aria-selected":E,tabIndex:E?0:-1};return H({ourProps:ue,theirProps:q,slot:R,defaultTag:Be,name:"Tabs.Tab"})}),We="div",je=N(function(e,t){let{selectedIndex:r}=_("Tab.Panels"),s=D(t),n=l.useMemo(()=>({selectedIndex:r}),[r]);return H({ourProps:{ref:s},theirProps:e,slot:n,defaultTag:We,name:"Tabs.Panels"})}),Qe="div",Je=te.RenderStrategy|te.Static,Ke=N(function(e,t){var r,s,n,c;let{selectedIndex:i,tabs:v,panels:m}=_("Tab.Panel"),w=Y("Tab.Panel"),u=J("Tab.Panel"),h=`headlessui-tabs-panel-${ce()}`,p=l.useRef(null),o=D(p,t);j(()=>w.registerPanel(p),[w,p]);let T=u.current.panels.indexOf(h);T===-1&&(T=u.current.panels.push(h)-1);let f=m.indexOf(p);f===-1&&(f=T);let b=f===i,E=l.useMemo(()=>({selected:b}),[b]),S=e,I={ref:o,id:h,role:"tabpanel","aria-labelledby":(s=(r=v[f])==null?void 0:r.current)==null?void 0:s.id,tabIndex:b?0:-1};return!b&&((n=e.unmount)==null||n)&&!((c=e.static)!=null&&c)?a.createElement(le,{as:"span",...I}):H({ourProps:I,theirProps:S,slot:E,defaultTag:Qe,features:Je,visible:b,name:"Tabs.Panel"})}),O=Object.assign(Ue,{Group:ze,List:Le,Panels:je,Panel:Ke});function L(e){const t=ye(e,"lastPrescriber");return we([{key:"isArchived",type:"tag",icon:he,display:({listView:r})=>r?"show dismissed records":"dismissed records"},t.length<2?null:{key:"lastPrescriber",type:"checkbox",icon:ve,values:t,display:"prescriber"}])}try{L.displayName="medicationFilters",L.__docgenInfo={description:"",displayName:"medicationFilters",props:{}}}catch{}function B({className:e,onAfterOpenHistoryDrawer:t,onOpenHistoryDrawer:r}){const[s,n]=l.useState([]),c=ge(),{builderMedications:i,isLoading:v}=ie(),{data:m,setSort:w}=ne({defaultFilters:{},defaultSort:$,records:i});function u(h){ee(r)&&r(),c({medication:h}),setTimeout(()=>{ee(t)&&t()},0)}return l.useEffect(()=>{n(Ie(m.filter(h=>h.displayStatus!=="Active"),Ee(Pe("display"),Se),"asc"))},[m]),a.createElement(a.Fragment,null,a.createElement("div",{className:"ctw-flex ctw-flex-wrap ctw-gap-x-2"},a.createElement(oe,{className:"ctw-my-2",options:se,onChange:w,defaultSort:$})),a.createElement(xe,{className:e,medicationStatements:s,isLoading:v,handleRowClick:u}))}try{B.displayName="ProviderInactiveMedicationsTable",B.__docgenInfo={description:`Displays a table of inactive medication records. These are builder-owned medications
that have a status other than "active". These are not to be confused with "dismissed" or "archived"
medication records pulled from the network of other providers.`,displayName:"ProviderInactiveMedicationsTable",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},onOpenHistoryDrawer:{defaultValue:null,description:"",name:"onOpenHistoryDrawer",required:!1,type:{name:"(() => void)"}},onAfterOpenHistoryDrawer:{defaultValue:null,description:"",name:"onAfterOpenHistoryDrawer",required:!1,type:{name:"(() => void)"}}}}}catch{}function Xe({children:e,className:t,forceHorizontalTabs:r=!1,content:s,onChange:n}){const[c,i]=l.useState(0),v=l.useRef(null),m=ke(v),w=!r&&m.sm,[u,h]=l.useState({0:!0}),p=o=>{i(o),h({...u,[o]:!0}),n&&n(o)};return a.createElement("div",{ref:v,className:k(t,"ctw-tab-group ctw-relative ctw-w-full")},a.createElement(O.Group,{selectedIndex:c,onChange:p},w&&a.createElement(Me,{btnClassName:"ctw-tab ctw-capitalize",optionsClassName:"ctw-tab-list ctw-capitalize",onChange:p,items:s}),a.createElement(O.List,{className:k("ctw-border-default ctw-flex ctw-justify-start ctw-border-b ctw-border-divider-light",{"ctw-hidden":w})},s.map(({key:o,display:T})=>a.createElement(O,{key:o,"data-zus-telemetry-click":`Tab[${o}]`,onClick:Ye,className:({selected:f})=>k(["ctw-tab ctw-text-sm ctw-capitalize","hover:after:ctw-bg-content-black","focus-visible:ctw-outline-primary-dark focus-visible:after:ctw-bg-transparent"],{"after:ctw-bg-content-black":f,"ctw-text-content-light":!f})},T()))),e,a.createElement(O.Panels,null,s.map((o,T)=>{var f;return a.createElement(O.Panel,{key:o.key,className:k((f=o.getPanelClassName)==null?void 0:f.call(o,m.sm)),unmount:!1},u[T]&&o.render(m.sm))}))))}const U=Ae(Xe,"TabGroup",!1);function Ye(){typeof document<"u"&&requestAnimationFrame(()=>{document.activeElement instanceof HTMLElement&&document.activeElement.blur()})}try{U.displayName="TabGroup",U.__docgenInfo={description:"",displayName:"TabGroup",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},content:{defaultValue:null,description:"",name:"content",required:!0,type:{name:"TabGroupItem[]"}},forceHorizontalTabs:{defaultValue:null,description:"",name:"forceHorizontalTabs",required:!1,type:{name:"boolean"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((index: number) => void)"}}}}}catch{}const Ze=e=>[{key:"medication-list",display:()=>"medication list",render:()=>a.createElement(Te,{onOpenHistoryDrawer:e.onOpenHistoryDrawer,onAfterOpenHistoryDrawer:e.onAfterOpenHistoryDrawer})},{key:"inactive-provider-records",display:()=>"inactive",render:()=>a.createElement(B,{onOpenHistoryDrawer:e.onOpenHistoryDrawer,onAfterOpenHistoryDrawer:e.onAfterOpenHistoryDrawer})},{key:"other-provider-records",display:()=>a.createElement(a.Fragment,null,a.createElement("span",{className:"ctw-pr-2 ctw-capitalize"},"other provider records"),a.createElement(be,null)),render:()=>a.createElement(W,{...e})}];function W({handleAddToRecord:e,hideAddToRecord:t,onOpenHistoryDrawer:r,onAfterOpenHistoryDrawer:s}){const{otherProviderMedications:n}=ie(),{data:c,filters:i,setFilters:v,setSort:m}=ne({defaultFilters:{},defaultSort:$,records:n});return a.createElement(a.Fragment,null,a.createElement("div",{className:"ctw-flex ctw-flex-wrap ctw-gap-x-2"},a.createElement(oe,{className:"ctw-my-2",options:se,onChange:m,defaultSort:$}),a.createElement(Oe,{filters:L(n??[]),onChange:v,defaultState:{}})),a.createElement(fe,{records:c,showDismissed:!!i.isArchived,handleAddToRecord:e,hideAddToRecord:t,onOpenHistoryDrawer:r,onAfterOpenHistoryDrawer:s}))}function ae({className:e,forceHorizontalTabs:t=!1,...r}){const s=Ze(r);return a.createElement(_e,{className:k("ctw-patient-medications ctw-space-y-3 ctw-bg-white",e)},a.createElement(U,{content:s,forceHorizontalTabs:t,className:e}))}try{W.displayName="OtherProviderMedsTableTab",W.__docgenInfo={description:"",displayName:"OtherProviderMedsTableTab",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},forceHorizontalTabs:{defaultValue:null,description:"",name:"forceHorizontalTabs",required:!1,type:{name:"boolean"}},hideAddToRecord:{defaultValue:null,description:"",name:"hideAddToRecord",required:!1,type:{name:"boolean"}},handleAddToRecord:{defaultValue:null,description:"",name:"handleAddToRecord",required:!1,type:{name:"((m: MedicationStatementModel) => void)"}},onOpenHistoryDrawer:{defaultValue:null,description:"",name:"onOpenHistoryDrawer",required:!1,type:{name:"(() => void)"}},onAfterOpenHistoryDrawer:{defaultValue:null,description:"",name:"onAfterOpenHistoryDrawer",required:!1,type:{name:"(() => void)"}}}}}catch{}try{ae.displayName="PatientMedications",ae.__docgenInfo={description:`This component is a tabbed view of patient medications from the current
provider, other providers and historical. When rendered in a small breakpoint
the component will change from horizontal tabs to a vertical dropdown menu.
If this is undesired, you may set the property \`forceHorizontalTabs\` to true
and the tabs will remain visible and horizontal. The \`forceHorizontalTabs\`
prop will not prevent the medication tables from switching to their stacked
view when viewed on smaller screens.`,displayName:"PatientMedications",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},forceHorizontalTabs:{defaultValue:{value:"false"},description:"",name:"forceHorizontalTabs",required:!1,type:{name:"boolean"}},hideAddToRecord:{defaultValue:null,description:"",name:"hideAddToRecord",required:!1,type:{name:"boolean"}},handleAddToRecord:{defaultValue:null,description:"",name:"handleAddToRecord",required:!1,type:{name:"((m: MedicationStatementModel) => void)"}},onOpenHistoryDrawer:{defaultValue:null,description:"",name:"onOpenHistoryDrawer",required:!1,type:{name:"(() => void)"}},onAfterOpenHistoryDrawer:{defaultValue:null,description:"",name:"onAfterOpenHistoryDrawer",required:!1,type:{name:"(() => void)"}}}}}catch{}export{W as O,ae as P,U as T};
