import{R as t,r as p}from"./index-6f814c40.js";import{D as _,e as S}from"./data-list-254aa0b0.js";import{D as y}from"./drawer-ed34104d.js";import{a as q,M as R,s as V,g as x,b as F}from"./medication-history-b83d044d.js";import{L as C}from"./loading-c7ff698a.js";import{k as I}from"./values-e0b170db.js";import{b as A,u as v}from"./patient-provider-bbc62e03.js";import{c as L}from"./index-74f03c09.js";import{T}from"./table-6b14d129.js";import{u as k}from"./use-breakpoints-8921c18b.js";import{a8 as B,ar as O,w as D,a4 as z,a3 as Q}from"./patient-helper-9ca0101c.js";import{M as w}from"./sort-5c3c7af1.js";function H(e,r){return e?[{label:"Status",value:e.displayStatus},{label:"Last Fill Date",value:e.lastFillDate},{label:"Quantity",value:e.quantity},{label:"Days Supply",value:e.daysSupply},{label:"Refills",value:e.refills},{label:"Instructions",value:e.dosage},{label:"Prescriber",value:r},{label:"Last Prescribed Date",value:e.lastPrescribedDate},...S("Note",e.notesDisplay)]:[]}const b=({medication:e,onDismissal:r,...l})=>{const{lastPrescriber:c,isLoading:s}=q(e==null?void 0:e.resource),n=H(e,c);return t.createElement(y,{title:"Medication Details",...l},t.createElement(y.Body,null,t.createElement("div",{className:"ctw-space-y-5"},t.createElement("div",{className:"ctw-flex ctw-justify-between ctw-space-x-8"},t.createElement("h3",{className:"ctw-m-0 ctw-text-3xl ctw-font-light"},e==null?void 0:e.display)),s&&t.createElement(C,null),!s&&t.createElement(_,{title:"Summary",data:n}),e&&t.createElement(R,{medication:e}))),t.createElement(y.Footer,null,t.createElement("div",{className:"ctw-flex ctw-justify-end ctw-space-x-2"},I(r)&&!(e!=null&&e.isArchived)&&t.createElement("button",{type:"button",className:"ctw-btn-primary",onClick:()=>{r(e),l.onClose()},"data-zus-telemetry-click":"Dismiss"},"Dismiss"),t.createElement("button",{type:"button",className:"ctw-btn-default",onClick:l.onClose,"data-zus-telemetry-click":"Close"},"Close"))))};try{b.displayName="MedicationDrawer",b.__docgenInfo={description:"",displayName:"MedicationDrawer",props:{medication:{defaultValue:null,description:"",name:"medication",required:!1,type:{name:"MedicationStatementModel"}},onDismissal:{defaultValue:null,description:"",name:"onDismissal",required:!1,type:{name:"((m: MedicationStatementModel) => void)"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},onOpen:{defaultValue:null,description:"",name:"onOpen",required:!1,type:{name:"(() => void)"}},onAfterOpen:{defaultValue:null,description:"",name:"onAfterOpen",required:!1,type:{name:"(() => void)"}}}}}catch{}function ne(){const{openDrawer:e}=A();return({medication:r})=>{e({component:l=>t.createElement(b,{medication:r,...l})})}}const h=({children:e,className:r="",emptyMessage:l="No medications on record.",hideMenu:c=!1,medicationStatements:s,telemetryNamespace:n,...f})=>{const u=p.useRef(null),i=k(u),o=[{title:"Medication Name",render:a=>t.createElement(t.Fragment,null,t.createElement("div",{className:"ctw-font-medium group-hover:ctw-underline"},a.display),t.createElement("div",{className:"ctw-font-light"},a.dosage)),widthPercent:35,minWidth:270}],m=[...o,{title:"Dispensed",render:a=>t.createElement(t.Fragment,null,a.quantity&&t.createElement("div",null,a.quantity),a.refills&&t.createElement("div",null,a.refills," refills")),widthPercent:14},{title:"Status",render:a=>t.createElement("div",{className:"ctw-capitalize"},t.createElement("div",{className:"ctw-text-content-black"},a.status),a.isArchived&&t.createElement("div",{className:"ctw-font-light"},"Dismissed")),sortIndices:[{index:"status"},{index:"dateAsserted",dir:"desc"}],widthPercent:14},{title:"Last Filled",dataIndex:"lastFillDate",sortIndices:[{index:"lastFillDate",isDate:!0}],widthPercent:18},{title:"Last Prescribed",render:a=>t.createElement(t.Fragment,null,a.lastPrescribedDate&&t.createElement("div",null,a.lastPrescribedDate),a.lastPrescriber&&t.createElement("div",null,a.lastPrescriber)),sortIndices:[{index:"lastPrescribedDate",isDate:!0},{index:"lastPrescriber",dir:"asc"}],widthPercent:18,minWidth:"90px"}];return t.createElement("div",{className:L(r,"ctw-scrollable-pass-through-height"),ref:u,"data-zus-telemetry-namespace":n},t.createElement(T,{showTableHead:!i.sm,stacked:i.sm,records:s,columns:i.sm?o:m,emptyMessage:l,...f}),e)};try{h.displayName="MedicationsTableBase",h.__docgenInfo={description:"",displayName:"MedicationsTableBase",props:{className:{defaultValue:{value:""},description:"",name:"className",required:!1,type:{name:"Argument"}},emptyMessage:{defaultValue:{value:"No medications on record."},description:"Displayed when we have 0 records.",name:"emptyMessage",required:!1,type:{name:"string | (string & ReactElement<any, string | JSXElementConstructor<any>>)"}},hideMenu:{defaultValue:{value:"false"},description:"",name:"hideMenu",required:!1,type:{name:"boolean"}},medicationStatements:{defaultValue:null,description:"",name:"medicationStatements",required:!0,type:{name:"MedicationStatementModel[]"}},telemetryNamespace:{defaultValue:null,description:"",name:"telemetryNamespace",required:!1,type:{name:"string"}},pageSize:{defaultValue:null,description:"",name:"pageSize",required:!1,type:{name:"number"}},handleRowClick:{defaultValue:null,description:"",name:"handleRowClick",required:!1,type:{name:"((record: MedicationStatementModel) => void)"}},RowActions:{defaultValue:null,description:"",name:"RowActions",required:!1,type:{name:"ComponentType<{ record: MedicationStatementModel; }>"}},getRowClassName:{defaultValue:null,description:"",name:"getRowClassName",required:!1,type:{name:"((record: MedicationStatementModel) => Argument)"}},isLoading:{defaultValue:null,description:"",name:"isLoading",required:!1,type:{name:"boolean"}},showTableHead:{defaultValue:null,description:"",name:"showTableHead",required:!1,type:{name:"boolean"}},stacked:{defaultValue:null,description:"",name:"stacked",required:!1,type:{name:"boolean"}},hidePagination:{defaultValue:null,description:"",name:"hidePagination",required:!1,type:{name:"boolean"}}}}}catch{}function Y(){return v(z,[{informationSourceNot:"Patient"}],D(x,"req.builder_medications"))}function j(){return v(Q,[{_revinclude:"Basic:subject"}],D(F,"req.active_medications"))}function re(){const[e,r]=p.useState(),[l,c]=p.useState(),s=j(),n=Y();p.useEffect(()=>{var o,m;if((o=s.data)!=null&&o.bundle&&((m=n.data)!=null&&m.bundle)){const{medications:a,bundle:N}=s.data,{medications:P}=n.data,M=B(N),g=O([s.data.bundle,n.data.bundle]),E=V(a.map(d=>new w(d,g,M.get(d.id??""))),P.map(d=>new w(d,g,M.get(d.id??""))));r(E.builderMedications),c(E.otherProviderMedications)}},[s.data,n.data]);const f=n.isLoading||s.isLoading,u=n.isFetching||s.isFetching,i=n.isError||s.isError;return{isFetching:u,isLoading:f,isError:i,builderMedications:e,otherProviderMedications:l}}export{h as M,re as a,ne as u};
