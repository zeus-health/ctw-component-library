{"version":3,"file":"patient-conditions.stories-efe31e48.js","sources":["../../src/components/content/conditions/patient-conditions-actions.tsx","../../src/components/content/conditions/patient-conditions-columns.tsx","../../src/components/content/conditions/patient-conditions-filters.tsx","../../src/components/content/conditions/patient-conditions-menu-actions.tsx","../../src/components/content/conditions/patient-conditions-sort.tsx","../../src/components/content/conditions/patient-conditions-tabs.tsx","../../src/utils/filters.ts","../../src/components/content/conditions/patient-conditions.tsx","../../src/components/content/conditions/patient-conditions.stories.tsx"],"sourcesContent":["import { ChevronDownIcon } from \"@heroicons/react/outline\";\nimport { PatientHistoryTableHeaderMessage } from \"../patient-history/patient-history-table-header\";\nimport { usePatientHistory } from \"../patient-history/use-patient-history\";\nimport { useAddConditionForm } from \"./condition-hooks\";\nimport { FilterCollection } from \"./patient-conditions-filters\";\nimport { Sort, SortOption } from \"./patient-conditions-sort\";\nimport { DropdownMenuAction } from \"@/components/core/dropdown-action-menu\";\nimport { FilterBar } from \"@/components/core/filter-bar/filter-bar\";\nimport {\n  FilterChangeEvent,\n  FilterItem,\n} from \"@/components/core/filter-bar/filter-bar-types\";\nimport { ConditionModel } from \"@/fhir/models\";\n\nexport type PatientConditionsActionsProps = {\n  hideAdd: boolean;\n  sortOptions: SortOption<ConditionModel>[];\n  updateSorts: (newSorts: Partial<Sort>) => void;\n  activeCollection: FilterCollection;\n  currentSorts: Sort;\n  filterItems: FilterItem[];\n  setFilters: (filterChangeEvent: FilterChangeEvent) => void;\n  filters: FilterChangeEvent;\n};\n\nexport function PatientConditionsActions({\n  hideAdd,\n  sortOptions,\n  updateSorts,\n  activeCollection,\n  currentSorts,\n  filterItems,\n  setFilters,\n  filters,\n}: PatientConditionsActionsProps) {\n  const showAddConditionForm = useAddConditionForm();\n  const patientHistory = usePatientHistory();\n\n  return (\n    <div className=\"ctw-flex ctw-flex-wrap ctw-items-center ctw-justify-between ctw-py-2 sm:ctw-pt-1.5\">\n      <div className=\"ctw-flex ctw-flex-wrap ctw-gap-x-2\">\n        <SortButton\n          options={sortOptions}\n          updateSorts={updateSorts}\n          activeCollection={activeCollection}\n          currentSorts={currentSorts}\n        />\n        <FilterBar\n          filters={filterItems}\n          handleOnChange={setFilters}\n          defaultState={filters}\n        />\n      </div>\n\n      {patientHistory.lastRetrievedAt && hideAdd && (\n        <PatientHistoryTableHeaderMessage\n          patientHistory={patientHistory}\n          message=\"Last Retrieved\"\n        />\n      )}\n      {!hideAdd && (\n        <button\n          type=\"button\"\n          className=\"ctw-btn-primary ctw-p-0\"\n          onClick={() => showAddConditionForm()}\n        >\n          Add Condition\n        </button>\n      )}\n    </div>\n  );\n}\n\ntype SortButtonProps<T> = {\n  options: SortOption<T>[];\n  updateSorts: (newSorts: Partial<Sort>) => void;\n  activeCollection: FilterCollection;\n  currentSorts: Sort;\n};\n\nconst SortButton = ({\n  options,\n  updateSorts,\n  activeCollection,\n  currentSorts,\n}: SortButtonProps<ConditionModel>) => (\n  <DropdownMenuAction\n    type=\"select\"\n    buttonClassName=\"ctw-bg-transparent ctw-border-none ctw-p-0\"\n    onItemSelect={(event) => {\n      const { dir, key, isDate } = options.filter(\n        (option) => option.display === event.key\n      )[0];\n\n      updateSorts({\n        [activeCollection]: { key, dir, isDate, display: event.name },\n      });\n    }}\n    items={options.map((option) => ({\n      key: option.display,\n      name: option.display,\n      isSelected: currentSorts.display === option.display,\n    }))}\n  >\n    <div className=\"ctw-btn-default ctw-flex ctw-items-center ctw-space-x-1\">\n      <span>Sort</span>\n      <ChevronDownIcon className=\"ctw-h-4\" />\n    </div>\n  </DropdownMenuAction>\n);\n","import cx from \"classnames\";\nimport { TableColumn } from \"@/components/core/table/table-helpers\";\nimport { ConditionModel } from \"@/fhir/models\";\nimport { compact } from \"@/utils/nodash\";\n\nfunction statusToColor(status: string) {\n  switch (status) {\n    case \"Active\":\n      return \"ctw-text-success-main\";\n    case \"Pending\":\n      return \"ctw-text-caution-main\";\n    default:\n      return \"ctw-text-content-lighter\";\n  }\n}\n\nexport const patientConditionsColumns: TableColumn<ConditionModel>[] = [\n  {\n    widthPercent: 30,\n    minWidth: 320,\n    render: (condition) => (\n      <div>\n        <div className=\"ctw-pc-title group-hover:ctw-underline\">\n          {condition.display}\n        </div>\n        <div className=\"ctw-pc-chapter\">{condition.ccsChapter}</div>\n      </div>\n    ),\n  },\n  {\n    render: (condition) => (\n      <div className=\"ctw-pc-status-container\">\n        <div\n          className={cx(\n            \"ctw-pc-status-dot\",\n            statusToColor(condition.displayStatus)\n          )}\n        >\n          &bull;\n        </div>\n        <div className=\"ctw-pc-status-and-extra\">\n          <div className=\"ctw-pc-status\">{condition.displayStatus}</div>\n\n          {condition.isSummaryResource ? (\n            <div>\n              {compact([\n                condition.patient?.organization?.name,\n                condition.recordedDate,\n              ]).join(\" \")}\n            </div>\n          ) : (\n            <div>\n              {compact([condition.recorder, condition.recordedDate]).join(\" \")}\n            </div>\n          )}\n        </div>\n      </div>\n    ),\n    widthPercent: 30,\n    minWidth: 128,\n  },\n  {\n    widthPercent: 40,\n    minWidth: 132,\n    render: (condition) => {\n      const onsetText = condition.isSummaryResource\n        ? \"Earliest known onset:\"\n        : \"Onset:\";\n\n      return (\n        <div className=\"ctw-pc-onset-notes\">\n          {condition.onset && (\n            <div>\n              {onsetText} {condition.onset}\n            </div>\n          )}\n          <div className=\"ctw-pc-notes\">{condition.notes.join(\" \")}</div>\n        </div>\n      );\n    },\n  },\n];\n","import { useState } from \"react\";\nimport {\n  FilterChangeEvent,\n  FilterItem,\n} from \"@/components/core/filter-bar/filter-bar-types\";\nimport { ConditionModel } from \"@/fhir/models\";\nimport { cloneDeep, compact, find, isArray, uniq } from \"@/utils/nodash\";\n\nexport type FilterCollection = \"patient\" | \"other\";\n\nexport type Filters = {\n  patient: FilterChangeEvent;\n  other: FilterChangeEvent;\n};\n\nconst DEFAULT_FILTERS: Filters = {\n  patient: {\n    displayStatus: {\n      key: \"displayStatus\",\n      selected: [\"Active\", \"Pending\", \"Unknown\"],\n      type: \"checkbox\",\n    },\n  },\n  other: {\n    displayStatus: {\n      key: \"displayStatus\",\n      selected: [\"Active\", \"Pending\", \"Unknown\"],\n      type: \"checkbox\",\n    },\n  },\n};\n\nexport function useConditionFilters(collection: FilterCollection) {\n  const [filters, setFilters] = useState<Filters>({\n    ...DEFAULT_FILTERS,\n  });\n\n  function updateFilters(newFilters: Partial<FilterChangeEvent>) {\n    setFilters(() => ({\n      ...filters,\n      [collection]: {\n        ...assignOpenStatus(newFilters),\n      },\n    }));\n  }\n\n  const assignOpenStatus = (newFilters: Partial<FilterChangeEvent>) => {\n    const reasssignedFilters = cloneDeep(newFilters);\n    const itemToOpen = find(\n      reasssignedFilters,\n      (o) =>\n        (typeof o?.selected === \"undefined\" && o?.type === \"checkbox\") ||\n        o?.type === \"select\"\n    );\n\n    if (itemToOpen?.key) {\n      return { ...reasssignedFilters, [itemToOpen.key]: { isOpen: true } };\n    }\n    return newFilters;\n  };\n\n  function availableFilters(conditions: ConditionModel[]): FilterItem[] {\n    return [\n      {\n        key: \"displayStatus\",\n        type: \"checkbox\",\n        icon: \"eye\",\n        display: () => \"Status\",\n        values: uniq(conditions.map((c) => c.displayStatus)),\n        isOpen: filters[collection].displayStatus?.isOpen,\n      },\n      {\n        key: \"ccsChapter\",\n        type: \"checkbox\",\n        icon: \"eye\",\n        display: () => \"Category\",\n        values: compact(uniq(conditions.map((c) => c.ccsChapter))),\n        isOpen: filters[collection].ccsChapter?.isOpen,\n      },\n    ];\n  }\n\n  function applyFilters(\n    patientConditions: ConditionModel[],\n    otherConditions: ConditionModel[]\n  ) {\n    const conditions =\n      collection === \"patient\" ? patientConditions : otherConditions;\n\n    return conditions.filter((condition) =>\n      Object.entries(filters[collection]).every(([_, filterItem]) => {\n        if (filterItem?.type === \"checkbox\" && isArray(filterItem.selected)) {\n          const filteredList = filterItem.selected.filter((item) =>\n            compact(\n              uniq(\n                conditions.map((c) => c[filterItem.key as keyof ConditionModel])\n              )\n            ).includes(item)\n          );\n\n          const targetFilter =\n            condition[filterItem.key as keyof ConditionModel] ?? \"\";\n\n          return (\n            filteredList.length < 1 ||\n            filteredList.includes(String(targetFilter))\n          );\n        }\n\n        return true;\n      })\n    );\n  }\n\n  return {\n    filters,\n    updateFilters,\n    applyFilters,\n    availableFilters,\n  };\n}\n","import { toggleArchive } from \"../conditions-helper\";\nimport {\n  useAddConditionForm,\n  useConfirmDeleteCondition,\n  useEditConditionForm,\n} from \"./condition-hooks\";\nimport { ConditionModel } from \"@/fhir/models\";\nimport { RowActionsProps, useCTW } from \"@/index\";\n\nexport const PatientConditionHoverActions = ({\n  record,\n}: RowActionsProps<ConditionModel>) => {\n  const showEditConditionForm = useEditConditionForm();\n  const confirmDelete = useConfirmDeleteCondition();\n\n  return (\n    <div className=\"ctw-flex ctw-space-x-2\">\n      {!record.isDeleted && (\n        <button\n          type=\"button\"\n          className=\"ctw-btn-default\"\n          onClick={(event) => {\n            event.stopPropagation();\n            confirmDelete(record);\n          }}\n        >\n          Remove\n        </button>\n      )}\n\n      <button\n        type=\"button\"\n        className=\"ctw-btn-primary\"\n        onClick={(event) => {\n          event.stopPropagation();\n          showEditConditionForm(record);\n        }}\n      >\n        Edit\n      </button>\n    </div>\n  );\n};\n\nexport const OtherProviderConditionHoverActions = ({\n  record,\n}: RowActionsProps<ConditionModel>) => {\n  const showAddConditionForm = useAddConditionForm();\n  const { getRequestContext } = useCTW();\n\n  return (\n    <div className=\"ctw-flex ctw-space-x-2\">\n      <button\n        type=\"button\"\n        className=\"ctw-btn-default\"\n        onClick={async (event) => {\n          event.stopPropagation();\n          await toggleArchive(record, await getRequestContext());\n        }}\n      >\n        {record.isArchived ? \"Restore\" : \"Dismiss\"}\n      </button>\n\n      <button\n        type=\"button\"\n        className=\"ctw-btn-primary\"\n        onClick={(event) => {\n          event.stopPropagation();\n          showAddConditionForm(record);\n        }}\n      >\n        Add\n      </button>\n    </div>\n  );\n};\n","import { useState } from \"react\";\nimport { FilterCollection } from \"./patient-conditions-filters\";\nimport { ConditionModel } from \"@/fhir/models\";\nimport { sort } from \"@/utils/sort\";\n\nexport type SortDir = \"asc\" | \"desc\";\n\nexport type Sort = {\n  key: string;\n  dir: SortDir;\n  display: string;\n  isDate?: boolean;\n};\n\nconst DEFAULT_SORT: Sort = {\n  key: \"recordedDate\",\n  dir: \"desc\",\n  display: \"Last Updated Date (Newest to Oldest)\",\n};\n\nconst DEFAULT_SORTS = {\n  patient: {\n    ...DEFAULT_SORT,\n  },\n  other: {\n    ...DEFAULT_SORT,\n  },\n};\n\nexport type SortOption<T> = {\n  display: string;\n  key: keyof T;\n  dir: SortDir;\n  isDate?: boolean;\n};\n\nconst SORT_OPTIONS: SortOption<ConditionModel>[] = [\n  {\n    display: \"Name (A-Z)\",\n    key: \"display\",\n    dir: \"asc\",\n  },\n  {\n    display: \"Name (Z-A)\",\n    key: \"display\",\n    dir: \"desc\",\n  },\n  {\n    display: \"Category (A-Z)\",\n    key: \"ccsChapter\",\n    dir: \"asc\",\n  },\n  {\n    display: \"Category (Z-A)\",\n    key: \"ccsChapter\",\n    dir: \"desc\",\n  },\n  {\n    display: \"Status (A-Z)\",\n    key: \"displayStatus\",\n    dir: \"asc\",\n  },\n  {\n    display: \"Status (Z-A)\",\n    key: \"displayStatus\",\n    dir: \"desc\",\n  },\n  {\n    display: \"Last Updated Date (Oldest to Newest)\",\n    key: \"recordedDate\",\n    dir: \"asc\",\n    isDate: true,\n  },\n  {\n    display: \"Last Updated Date (Newest to Oldest)\",\n    key: \"recordedDate\",\n    dir: \"desc\",\n    isDate: true,\n  },\n];\n\nexport function useConditionSorts(activeCollection: FilterCollection) {\n  const [sorts, setSorts] = useState(DEFAULT_SORTS);\n\n  function updateSorts(newSorts: Partial<Sort>) {\n    setSorts({ ...sorts, ...newSorts });\n  }\n\n  function applySorts(conditions: ConditionModel[]) {\n    const activeSort = sorts[activeCollection];\n    return sort(\n      conditions,\n      (c) => c[activeSort.key as keyof ConditionModel],\n      activeSort.dir,\n      activeSort.isDate\n    );\n  }\n\n  return {\n    applySorts,\n    sortOptions: SORT_OPTIONS,\n    updateSorts,\n    currentSorts: sorts,\n  };\n}\n","import { PatientHistoryStatus } from \"../patient-history/patient-history-message-status\";\nimport { usePatientHistory } from \"../patient-history/use-patient-history\";\nimport { FilterCollection } from \"./patient-conditions-filters\";\nimport { Badge } from \"@/components/core/badge\";\nimport { TabGroup, TabGroupItem } from \"@/components/core/tab-group/tab-group\";\nimport { useOtherProviderConditionsDeduped } from \"@/fhir/conditions\";\nimport { ConditionModel } from \"@/fhir/models\";\n\nexport type PatientConditionsTabsProps = {\n  collection: FilterCollection;\n  forceHorizontalTabs?: boolean;\n  onCollectionChange: (collection: FilterCollection) => void;\n};\n\nconst tabbedContent: TabGroupItem<ConditionModel>[] = [\n  {\n    key: \"inactive-provider-records\",\n    getPanelClassName: (sm: boolean) => (sm ? \"ctw-mt-0\" : \"ctw-mt-2\"),\n    display: () => \"condition list\",\n    render: () => null,\n  },\n  {\n    key: \"other-provider-records\",\n    getPanelClassName: (sm: boolean) => (sm ? \"ctw-mt-0\" : \"ctw-mt-2\"),\n    display: () => (\n      <>\n        <span className=\"ctw-pr-2 ctw-capitalize\">other provider records</span>\n        <BadgeOtherProviderConditionsCount />\n      </>\n    ),\n    render: () => null,\n  },\n];\n\nexport function PatientConditionsTabs({\n  collection,\n  onCollectionChange,\n  forceHorizontalTabs = false,\n}: PatientConditionsTabsProps) {\n  const patientHistory = usePatientHistory();\n\n  return (\n    <>\n      {collection === \"other\" && (\n        <PatientHistoryStatus\n          status={patientHistory.lastStatus}\n          date={patientHistory.dateCreatedAt}\n        />\n      )}\n      <TabGroup\n        content={tabbedContent}\n        forceHorizontalTabs={forceHorizontalTabs}\n        onChange={(index) => {\n          onCollectionChange(index === 0 ? \"patient\" : \"other\");\n        }}\n      />\n    </>\n  );\n}\n\nexport const BadgeOtherProviderConditionsCount = () => {\n  const otherConditionsQuery = useOtherProviderConditionsDeduped();\n  const activeUnarchivedConditions = otherConditionsQuery.data.filter(\n    (condition) => condition.displayStatus === \"Active\"\n  );\n\n  if (activeUnarchivedConditions.length > 0) {\n    return (\n      <Badge\n        color=\"notification\"\n        text={activeUnarchivedConditions.length.toString()}\n        className=\"ctw-h-5\"\n      />\n    );\n  }\n  return null;\n};\n","import { Resource } from \"fhir/r4\";\nimport { FilterChangeEvent } from \"@/components/core/filter-bar/filter-bar-types\";\nimport { compact, isArray, uniq } from \"@/utils/nodash/\";\n\nexport const applyFilters = <T extends Resource>(\n  resources: T[],\n  filters: FilterChangeEvent\n) =>\n  resources.filter((resource) =>\n    Object.entries(filters).every(([_, filterItem]) => {\n      if (filterItem?.type === \"checkbox\" && isArray(filterItem.selected)) {\n        const filteredList = filterItem.selected.filter((item) =>\n          compact(\n            uniq(resources.map((c) => c[filterItem.key as keyof T]))\n          ).includes(item as T[keyof T])\n        );\n\n        const targetFilter = resource[filterItem.key as keyof T];\n\n        return (\n          filteredList.length < 1 || filteredList.includes(String(targetFilter))\n        );\n      }\n\n      return true;\n    })\n  );\n","import cx from \"classnames\";\nimport { useRef, useState } from \"react\";\nimport { useConditionHistory } from \"../condition-history/conditions-history-drawer\";\nimport { PatientConditionsActions } from \"./patient-conditions-actions\";\nimport { patientConditionsColumns } from \"./patient-conditions-columns\";\nimport {\n  FilterCollection,\n  useConditionFilters,\n} from \"./patient-conditions-filters\";\nimport {\n  OtherProviderConditionHoverActions,\n  PatientConditionHoverActions,\n} from \"./patient-conditions-menu-actions\";\nimport { useConditionSorts } from \"./patient-conditions-sort\";\nimport { PatientConditionsTabs } from \"./patient-conditions-tabs\";\nimport { withErrorBoundary } from \"@/components/core/error-boundary\";\nimport { Table } from \"@/components/core/table/table\";\nimport {\n  useOtherProviderConditionsDeduped,\n  usePatientConditions,\n} from \"@/fhir/conditions\";\nimport { useBreakpoints } from \"@/hooks/use-breakpoints\";\nimport \"./patient-conditions.scss\";\nimport { applyFilters } from \"@/utils/filters\";\n\nexport type PatientConditionsProps = {\n  className?: string;\n  readOnly?: boolean;\n  hideBuilderOwnedRecords?: boolean;\n  hideOutsideOwnedRecords?: boolean;\n};\n\nexport const PatientConditions = withErrorBoundary(\n  ({\n    className,\n    readOnly = false,\n    hideBuilderOwnedRecords = false,\n    hideOutsideOwnedRecords = false,\n  }: PatientConditionsProps) => {\n    // State.\n    const [collection, setCollection] = useState<FilterCollection>(\n      hideBuilderOwnedRecords ? \"other\" : \"patient\"\n    );\n    const { filters, updateFilters, availableFilters } =\n      useConditionFilters(collection);\n    const { applySorts, sortOptions, updateSorts, currentSorts } =\n      useConditionSorts(collection);\n    const containerRef = useRef<HTMLDivElement>(null);\n    const breakpoints = useBreakpoints(containerRef);\n\n    // Drawer helpers.\n    const showConditionHistory = useConditionHistory();\n\n    // Data fetching.\n    const patientConditionsQuery = usePatientConditions();\n    const otherConditionsQuery = useOtherProviderConditionsDeduped();\n\n    function isLoading() {\n      const isLoadingPatient = patientConditionsQuery.isLoading;\n      const isLoadingOther = isLoadingPatient || otherConditionsQuery.isLoading;\n      return collection === \"patient\" ? isLoadingPatient : isLoadingOther;\n    }\n\n    // Get our conditions.\n    const patientConditions = patientConditionsQuery.data ?? [];\n    const otherConditions = otherConditionsQuery.data;\n\n    let conditions = applyFilters(\n      collection === \"patient\" ? patientConditions : otherConditions,\n      filters[collection]\n    );\n    conditions = applySorts(conditions);\n    const RowActions =\n      collection === \"patient\"\n        ? PatientConditionHoverActions\n        : OtherProviderConditionHoverActions;\n\n    return (\n      <div\n        ref={containerRef}\n        className={cx(\n          \"ctw-patient-conditions ctw-items-center ctw-justify-between ctw-bg-white\",\n          className,\n          {\n            \"ctw-patient-conditions-stacked\": breakpoints.sm,\n          }\n        )}\n      >\n        {!(hideBuilderOwnedRecords || hideOutsideOwnedRecords) && (\n          <PatientConditionsTabs\n            forceHorizontalTabs\n            collection={collection}\n            onCollectionChange={setCollection}\n          />\n        )}\n\n        <PatientConditionsActions\n          sortOptions={sortOptions}\n          updateSorts={updateSorts}\n          activeCollection={collection}\n          hideAdd={readOnly || collection === \"other\"}\n          currentSorts={currentSorts[collection]}\n          filterItems={availableFilters(\n            collection === \"patient\" ? patientConditions : otherConditions\n          )}\n          setFilters={updateFilters}\n          filters={filters[collection]}\n        />\n\n        <Table\n          stacked={breakpoints.sm}\n          removeLeftAndRightBorders\n          className=\"-ctw-mx-px !ctw-rounded-none\"\n          showTableHead={false}\n          emptyMessage=\"There are no condition records available.\"\n          isLoading={isLoading()}\n          records={conditions}\n          RowActions={readOnly ? undefined : RowActions}\n          columns={patientConditionsColumns}\n          handleRowClick={(condition) =>\n            showConditionHistory({\n              condition,\n              readOnly: readOnly || condition.isSummaryResource,\n            })\n          }\n        />\n      </div>\n    );\n  },\n  \"PatientConditions\"\n);\n","import type { Meta, StoryObj } from \"@storybook/react\";\nimport { PatientConditions, PatientConditionsProps } from \"./patient-conditions\";\nimport { emptyConditions } from \"./story-helpers/mocks/empty-conditions\";\nimport { otherConditions } from \"./story-helpers/mocks/other-conditions\";\nimport { patientConditions } from \"./story-helpers/mocks/patient-conditions\";\nimport { setupConditionMocks } from \"./story-helpers/mocks/requests\";\nimport { CTWProvider } from \"@/components/core/providers/ctw-provider\";\nimport { PatientProvider } from \"@/components/core/providers/patient-provider\";\nimport { SYSTEM_ZUS_UNIVERSAL_ID } from \"@/fhir/system-urls\";\ntype Props = PatientConditionsProps;\nexport default ({\n  component: PatientConditions,\n  tags: [\"autodocs\"],\n  argTypes: {\n    className: {\n      options: [\"Blank\", \"Fixed Width\"],\n      control: \"select\",\n      mapping: {\n        Blank: \"\",\n        \"Fixed Width\": \"ctw-m-auto ctw-max-w-[600px]\"\n      }\n    }\n  },\n  args: {\n    className: \"Blank\",\n    readOnly: false\n  },\n  decorators: [(Story, {\n    args\n  }) => <CTWProvider env=\"dev\" authToken=\"dummy-token\" builderId=\"b123\">\n        <PatientProvider patientID=\"u12345\" systemURL={SYSTEM_ZUS_UNIVERSAL_ID}>\n          <Story args={args} />\n        </PatientProvider>\n      </CTWProvider>]\n} as Meta<Props>);\nexport const Basic: StoryObj<Props> = {\n  ...setupConditionMocks({\n    otherConditions,\n    patientConditions\n  })\n};\nexport const Empty: StoryObj<Props> = {\n  ...setupConditionMocks({\n    otherConditions: emptyConditions,\n    patientConditions: emptyConditions\n  })\n};\nBasic.parameters = {\n  ...Basic.parameters,\n  docs: {\n    ...Basic.parameters?.docs,\n    source: {\n      originalSource: \"{\\n  ...setupConditionMocks({\\n    otherConditions,\\n    patientConditions\\n  })\\n}\",\n      ...Basic.parameters?.docs?.source\n    }\n  }\n};\nEmpty.parameters = {\n  ...Empty.parameters,\n  docs: {\n    ...Empty.parameters?.docs,\n    source: {\n      originalSource: \"{\\n  ...setupConditionMocks({\\n    otherConditions: emptyConditions,\\n    patientConditions: emptyConditions\\n  })\\n}\",\n      ...Empty.parameters?.docs?.source\n    }\n  }\n};"],"names":["PatientConditionsActions","hideAdd","sortOptions","updateSorts","activeCollection","currentSorts","filterItems","setFilters","filters","showAddConditionForm","useAddConditionForm","patientHistory","usePatientHistory","React","SortButton","FilterBar","PatientHistoryTableHeaderMessage","options","DropdownMenuAction","event","dir","key","isDate","option","ChevronDownIcon","statusToColor","status","patientConditionsColumns","condition","cx","compact","_b","_a","onsetText","DEFAULT_FILTERS","useConditionFilters","collection","useState","updateFilters","newFilters","assignOpenStatus","reasssignedFilters","cloneDeep","itemToOpen","find","o","availableFilters","conditions","uniq","c","applyFilters","patientConditions","otherConditions","_","filterItem","isArray","filteredList","item","targetFilter","PatientConditionHoverActions","record","showEditConditionForm","useEditConditionForm","confirmDelete","useConfirmDeleteCondition","OtherProviderConditionHoverActions","getRequestContext","useCTW","toggleArchive","DEFAULT_SORT","DEFAULT_SORTS","SORT_OPTIONS","useConditionSorts","sorts","setSorts","newSorts","applySorts","activeSort","sort","tabbedContent","sm","BadgeOtherProviderConditionsCount","PatientConditionsTabs","onCollectionChange","forceHorizontalTabs","PatientHistoryStatus","TabGroup","index","activeUnarchivedConditions","useOtherProviderConditionsDeduped","Badge","resources","resource","PatientConditions","withErrorBoundary","className","readOnly","hideBuilderOwnedRecords","hideOutsideOwnedRecords","setCollection","containerRef","useRef","breakpoints","useBreakpoints","showConditionHistory","useConditionHistory","patientConditionsQuery","usePatientConditions","otherConditionsQuery","isLoading","isLoadingPatient","isLoadingOther","RowActions","Table","patientConditions_stories","Story","args","CTWProvider","PatientProvider","SYSTEM_ZUS_UNIVERSAL_ID","Basic","setupConditionMocks","Empty","emptyConditions","_c"],"mappings":"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"}