import{w as S}from"./iframe.c37057f7.js";import{M as Q}from"./index.7f360363.js";var k=(t=>(t.CHANNEL_CREATED="channelCreated",t.CONFIG_ERROR="configError",t.STORY_INDEX_INVALIDATED="storyIndexInvalidated",t.STORY_SPECIFIED="storySpecified",t.SET_CONFIG="setConfig",t.SET_STORIES="setStories",t.SET_INDEX="setIndex",t.SET_CURRENT_STORY="setCurrentStory",t.CURRENT_STORY_WAS_SET="currentStoryWasSet",t.FORCE_RE_RENDER="forceReRender",t.FORCE_REMOUNT="forceRemount",t.PRELOAD_ENTRIES="preloadStories",t.STORY_PREPARED="storyPrepared",t.STORY_CHANGED="storyChanged",t.STORY_UNCHANGED="storyUnchanged",t.STORY_RENDERED="storyRendered",t.STORY_MISSING="storyMissing",t.STORY_ERRORED="storyErrored",t.STORY_THREW_EXCEPTION="storyThrewException",t.STORY_RENDER_PHASE_CHANGED="storyRenderPhaseChanged",t.PLAY_FUNCTION_THREW_EXCEPTION="playFunctionThrewException",t.UPDATE_STORY_ARGS="updateStoryArgs",t.STORY_ARGS_UPDATED="storyArgsUpdated",t.RESET_STORY_ARGS="resetStoryArgs",t.SET_GLOBALS="setGlobals",t.UPDATE_GLOBALS="updateGlobals",t.GLOBALS_UPDATED="globalsUpdated",t.REGISTER_SUBSCRIPTION="registerSubscription",t.PREVIEW_KEYDOWN="previewKeydown",t.SELECT_STORY="selectStory",t.STORIES_COLLAPSE_ALL="storiesCollapseAll",t.STORIES_EXPAND_ALL="storiesExpandAll",t.DOCS_RENDERED="docsRendered",t.SHARED_STATE_CHANGED="sharedStateChanged",t.SHARED_STATE_SET="sharedStateSet",t.NAVIGATE_URL="navigateUrl",t.UPDATE_QUERY_PARAMS="updateQueryParams",t))(k||{}),{CHANNEL_CREATED:vt,CONFIG_ERROR:Pt,STORY_INDEX_INVALIDATED:wt,STORY_SPECIFIED:bt,SET_STORIES:$t,SET_INDEX:Yt,SET_CONFIG:z,SET_CURRENT_STORY:Ut,CURRENT_STORY_WAS_SET:Gt,FORCE_RE_RENDER:Ht,FORCE_REMOUNT:q,STORY_PREPARED:jt,STORY_CHANGED:Bt,STORY_UNCHANGED:Mt,PRELOAD_ENTRIES:kt,STORY_RENDERED:Ft,STORY_MISSING:xt,STORY_ERRORED:Wt,STORY_THREW_EXCEPTION:Xt,STORY_RENDER_PHASE_CHANGED:J,PLAY_FUNCTION_THREW_EXCEPTION:Vt,UPDATE_STORY_ARGS:Kt,STORY_ARGS_UPDATED:Qt,RESET_STORY_ARGS:zt,SET_GLOBALS:qt,UPDATE_GLOBALS:Jt,GLOBALS_UPDATED:Zt,REGISTER_SUBSCRIPTION:te,PREVIEW_KEYDOWN:ee,SELECT_STORY:se,STORIES_COLLAPSE_ALL:re,STORIES_EXPAND_ALL:ne,DOCS_RENDERED:ie,SHARED_STATE_CHANGED:ae,SHARED_STATE_SET:oe,NAVIGATE_URL:le,UPDATE_QUERY_PARAMS:he}=k,F=(t=>(t.TAB="tab",t.PANEL="panel",t.TOOL="tool",t.TOOLEXTRA="toolextra",t.PREVIEW="preview",t.NOTES_ELEMENT="notes-element",t))(F||{}),{LOGLEVEL:Z,console:I}=S,A={trace:1,debug:2,info:3,warn:4,error:5,silent:10},tt=Z,p=A[tt]||A.info,et={trace:(t,...e)=>p<=A.trace&&I.trace(t,...e),debug:(t,...e)=>p<=A.debug&&I.debug(t,...e),info:(t,...e)=>p<=A.info&&I.info(t,...e),warn:(t,...e)=>p<=A.warn&&I.warn(t,...e),error:(t,...e)=>p<=A.error&&I.error(t,...e),log:(t,...e)=>p<A.silent&&I.log(t,...e)},st=()=>Math.random().toString(16).slice(2),rt=class{constructor({transport:t,async:e=!1}={}){this.sender=st(),this.events={},this.data={},this.isAsync=e,t&&(this.transport=t,this.transport.setHandler(s=>this.handleEvent(s)))}get hasTransport(){return!!this.transport}addListener(t,e){this.events[t]=this.events[t]||[],this.events[t].push(e)}emit(t,...e){let s={type:t,args:e,from:this.sender},i={};e.length>=1&&e[0]&&e[0].options&&(i=e[0].options);let a=()=>{this.transport&&this.transport.send(s,i),this.handleEvent(s)};this.isAsync?setImmediate(a):a()}last(t){return this.data[t]}eventNames(){return Object.keys(this.events)}listenerCount(t){let e=this.listeners(t);return e?e.length:0}listeners(t){return this.events[t]||void 0}once(t,e){let s=this.onceListener(t,e);this.addListener(t,s)}removeAllListeners(t){t?this.events[t]&&delete this.events[t]:this.events={}}removeListener(t,e){let s=this.listeners(t);s&&(this.events[t]=s.filter(i=>i!==e))}on(t,e){this.addListener(t,e)}off(t,e){this.removeListener(t,e)}handleEvent(t){let e=this.listeners(t.type);e&&e.length&&e.forEach(s=>{s.apply(t,t.args)}),this.data[t.type]=t.args}onceListener(t,e){let s=(...i)=>(this.removeListener(t,s),e(...i));return s}};function nt(){let t={setHandler:()=>{},send:()=>{}};return new rt({transport:t})}var it=class{constructor(){this.loaders={},this.elements={},this.config={},this.getChannel=()=>(this.channel||this.setChannel(nt()),this.channel),this.getServerChannel=()=>{if(!this.serverChannel)throw new Error("Accessing non-existent serverChannel");return this.serverChannel},this.ready=()=>this.promise,this.hasChannel=()=>!!this.channel,this.hasServerChannel=()=>!!this.serverChannel,this.setChannel=t=>{this.channel=t,this.resolve()},this.setServerChannel=t=>{this.serverChannel=t},this.getElements=t=>(this.elements[t]||(this.elements[t]={}),this.elements[t]),this.addPanel=(t,e)=>{this.add(t,{type:F.PANEL,...e})},this.add=(t,e)=>{let{type:s}=e,i=this.getElements(s);i[t]={id:t,...e}},this.setConfig=t=>{Object.assign(this.config,t),this.hasChannel()&&this.getChannel().emit(z,t)},this.getConfig=()=>this.config,this.register=(t,e)=>{this.loaders[t]&&et.warn(`${t} was loaded twice, this could have bad side-effects`),this.loaders[t]=e},this.loadAddons=t=>{Object.values(this.loaders).forEach(e=>e(t))},this.promise=new Promise(t=>{this.resolve=()=>t(this.getChannel())})}},C="__STORYBOOK_ADDONS";function at(){return S[C]||(S[C]=new it),S[C]}var ot=at(),x=(t=>(t.CHANNEL_CREATED="channelCreated",t.CONFIG_ERROR="configError",t.STORY_INDEX_INVALIDATED="storyIndexInvalidated",t.STORY_SPECIFIED="storySpecified",t.SET_CONFIG="setConfig",t.SET_STORIES="setStories",t.SET_INDEX="setIndex",t.SET_CURRENT_STORY="setCurrentStory",t.CURRENT_STORY_WAS_SET="currentStoryWasSet",t.FORCE_RE_RENDER="forceReRender",t.FORCE_REMOUNT="forceRemount",t.PRELOAD_ENTRIES="preloadStories",t.STORY_PREPARED="storyPrepared",t.STORY_CHANGED="storyChanged",t.STORY_UNCHANGED="storyUnchanged",t.STORY_RENDERED="storyRendered",t.STORY_MISSING="storyMissing",t.STORY_ERRORED="storyErrored",t.STORY_THREW_EXCEPTION="storyThrewException",t.STORY_RENDER_PHASE_CHANGED="storyRenderPhaseChanged",t.PLAY_FUNCTION_THREW_EXCEPTION="playFunctionThrewException",t.UPDATE_STORY_ARGS="updateStoryArgs",t.STORY_ARGS_UPDATED="storyArgsUpdated",t.RESET_STORY_ARGS="resetStoryArgs",t.SET_GLOBALS="setGlobals",t.UPDATE_GLOBALS="updateGlobals",t.GLOBALS_UPDATED="globalsUpdated",t.REGISTER_SUBSCRIPTION="registerSubscription",t.PREVIEW_KEYDOWN="previewKeydown",t.SELECT_STORY="selectStory",t.STORIES_COLLAPSE_ALL="storiesCollapseAll",t.STORIES_EXPAND_ALL="storiesExpandAll",t.DOCS_RENDERED="docsRendered",t.SHARED_STATE_CHANGED="sharedStateChanged",t.SHARED_STATE_SET="sharedStateSet",t.NAVIGATE_URL="navigateUrl",t.UPDATE_QUERY_PARAMS="updateQueryParams",t))(x||{}),{CHANNEL_CREATED:ce,CONFIG_ERROR:_e,STORY_INDEX_INVALIDATED:de,STORY_SPECIFIED:Se,SET_STORIES:Ee,SET_INDEX:Re,SET_CONFIG:lt,SET_CURRENT_STORY:ht,CURRENT_STORY_WAS_SET:Te,FORCE_RE_RENDER:Oe,FORCE_REMOUNT:$,STORY_PREPARED:ge,STORY_CHANGED:ue,STORY_UNCHANGED:Ae,PRELOAD_ENTRIES:ye,STORY_RENDERED:Ie,STORY_MISSING:pe,STORY_ERRORED:Ne,STORY_THREW_EXCEPTION:fe,STORY_RENDER_PHASE_CHANGED:ct,PLAY_FUNCTION_THREW_EXCEPTION:Ce,UPDATE_STORY_ARGS:De,STORY_ARGS_UPDATED:me,RESET_STORY_ARGS:Le,SET_GLOBALS:ve,UPDATE_GLOBALS:Pe,GLOBALS_UPDATED:we,REGISTER_SUBSCRIPTION:be,PREVIEW_KEYDOWN:$e,SELECT_STORY:Ye,STORIES_COLLAPSE_ALL:Ue,STORIES_EXPAND_ALL:Ge,DOCS_RENDERED:He,SHARED_STATE_CHANGED:je,SHARED_STATE_SET:Be,NAVIGATE_URL:Me,UPDATE_QUERY_PARAMS:ke}=x,_t=new Error("ignoredException"),W=(t=>(t.TAB="tab",t.PANEL="panel",t.TOOL="tool",t.TOOLEXTRA="toolextra",t.PREVIEW="preview",t.NOTES_ELEMENT="notes-element",t))(W||{}),{LOGLEVEL:dt,console:N}=S,y={trace:1,debug:2,info:3,warn:4,error:5,silent:10},St=dt,f=y[St]||y.info,P={trace:(t,...e)=>f<=y.trace&&N.trace(t,...e),debug:(t,...e)=>f<=y.debug&&N.debug(t,...e),info:(t,...e)=>f<=y.info&&N.info(t,...e),warn:(t,...e)=>f<=y.warn&&N.warn(t,...e),error:(t,...e)=>f<=y.error&&N.error(t,...e),log:(t,...e)=>f<y.silent&&N.log(t,...e)},L=new Set,R=t=>(e,...s)=>{if(!L.has(e))return L.add(e),P[t](e,...s)};R.clear=()=>L.clear();R.trace=R("trace");R.debug=R("debug");R.info=R("info");R.warn=R("warn");R.error=R("error");R.log=R("log");var Et=()=>Math.random().toString(16).slice(2),Rt=class{constructor({transport:t,async:e=!1}={}){this.sender=Et(),this.events={},this.data={},this.isAsync=e,t&&(this.transport=t,this.transport.setHandler(s=>this.handleEvent(s)))}get hasTransport(){return!!this.transport}addListener(t,e){this.events[t]=this.events[t]||[],this.events[t].push(e)}emit(t,...e){let s={type:t,args:e,from:this.sender},i={};e.length>=1&&e[0]&&e[0].options&&(i=e[0].options);let a=()=>{this.transport&&this.transport.send(s,i),this.handleEvent(s)};this.isAsync?setImmediate(a):a()}last(t){return this.data[t]}eventNames(){return Object.keys(this.events)}listenerCount(t){let e=this.listeners(t);return e?e.length:0}listeners(t){return this.events[t]||void 0}once(t,e){let s=this.onceListener(t,e);this.addListener(t,s)}removeAllListeners(t){t?this.events[t]&&delete this.events[t]:this.events={}}removeListener(t,e){let s=this.listeners(t);s&&(this.events[t]=s.filter(i=>i!==e))}on(t,e){this.addListener(t,e)}off(t,e){this.removeListener(t,e)}handleEvent(t){let e=this.listeners(t.type);e&&e.length&&e.forEach(s=>{s.apply(t,t.args)}),this.data[t.type]=t.args}onceListener(t,e){let s=(...i)=>(this.removeListener(t,s),e(...i));return s}};function Tt(){let t={setHandler:()=>{},send:()=>{}};return new Rt({transport:t})}var Ot=class{constructor(){this.loaders={},this.elements={},this.config={},this.getChannel=()=>(this.channel||this.setChannel(Tt()),this.channel),this.getServerChannel=()=>{if(!this.serverChannel)throw new Error("Accessing non-existent serverChannel");return this.serverChannel},this.ready=()=>this.promise,this.hasChannel=()=>!!this.channel,this.hasServerChannel=()=>!!this.serverChannel,this.setChannel=t=>{this.channel=t,this.resolve()},this.setServerChannel=t=>{this.serverChannel=t},this.getElements=t=>(this.elements[t]||(this.elements[t]={}),this.elements[t]),this.addPanel=(t,e)=>{this.add(t,{type:W.PANEL,...e})},this.add=(t,e)=>{let{type:s}=e,i=this.getElements(s);i[t]={id:t,...e}},this.setConfig=t=>{Object.assign(this.config,t),this.hasChannel()&&this.getChannel().emit(lt,t)},this.getConfig=()=>this.config,this.register=(t,e)=>{this.loaders[t]&&P.warn(`${t} was loaded twice, this could have bad side-effects`),this.loaders[t]=e},this.loadAddons=t=>{Object.values(this.loaders).forEach(e=>e(t))},this.promise=new Promise(t=>{this.resolve=()=>t(this.getChannel())})}},D="__STORYBOOK_ADDONS";function gt(){return S[D]||(S[D]=new Ot),S[D]}var ut=gt(),At=(t=>(t.DONE="done",t.ERROR="error",t.ACTIVE="active",t.WAITING="waiting",t))(At||{}),g={CALL:"storybook/instrumenter/call",SYNC:"storybook/instrumenter/sync",START:"storybook/instrumenter/start",BACK:"storybook/instrumenter/back",GOTO:"storybook/instrumenter/goto",NEXT:"storybook/instrumenter/next",END:"storybook/instrumenter/end"},M,X=((M=S.FEATURES)==null?void 0:M.interactionsDebugger)!==!0,Y={debugger:!X,start:!1,back:!1,goto:!1,next:!1,end:!1},U=new Error("This function ran after the play function completed. Did you forget to `await` it?"),G=t=>Object.prototype.toString.call(t)==="[object Object]",yt=t=>Object.prototype.toString.call(t)==="[object Module]",It=t=>{if(!G(t)&&!yt(t))return!1;if(t.constructor===void 0)return!0;let e=t.constructor.prototype;return!(!G(e)||Object.prototype.hasOwnProperty.call(e,"isPrototypeOf")===!1)},pt=t=>{try{return new t.constructor}catch{return{}}},m=()=>({renderPhase:void 0,isDebugging:!1,isPlaying:!1,isLocked:!1,cursor:0,calls:[],shadowCalls:[],callRefsByResult:new Map,chainedCallIds:new Set,ancestors:[],playUntil:void 0,resolvers:{},syncTimeout:void 0}),H=(t,e=!1)=>{let s=(e?t.shadowCalls:t.calls).filter(a=>a.retain);if(!s.length)return;let i=new Map(Array.from(t.callRefsByResult.entries()).filter(([,a])=>a.retain));return{cursor:s.length,calls:s,callRefsByResult:i}},Nt=class{constructor(){this.initialized=!1,this.channel=ut.getChannel(),this.state=S.window.parent.__STORYBOOK_ADDON_INTERACTIONS_INSTRUMENTER_STATE__||{};let t=({storyId:n,isPlaying:o=!0,isDebugging:r=!1})=>{let l=this.getState(n);this.setState(n,{...m(),...H(l,r),shadowCalls:r?l.shadowCalls:[],chainedCallIds:r?l.chainedCallIds:new Set,playUntil:r?l.playUntil:void 0,isPlaying:o,isDebugging:r}),this.sync(n)};this.channel.on($,t),this.channel.on(ct,({storyId:n,newPhase:o})=>{let{isDebugging:r}=this.getState(n);this.setState(n,{renderPhase:o}),o==="preparing"&&r&&t({storyId:n}),o==="playing"&&t({storyId:n,isDebugging:r}),o==="played"&&this.setState(n,{isLocked:!1,isPlaying:!1,isDebugging:!1}),o==="errored"&&this.setState(n,{isLocked:!1,isPlaying:!1})}),this.channel.on(ht,()=>{this.initialized?this.cleanup():this.initialized=!0});let e=({storyId:n,playUntil:o})=>{this.getState(n).isDebugging||this.setState(n,({calls:l})=>({calls:[],shadowCalls:l.map(h=>({...h,status:"waiting"})),isDebugging:!0}));let r=this.getLog(n);this.setState(n,({shadowCalls:l})=>{var d;if(o||!r.length)return{playUntil:o};let h=l.findIndex(_=>_.id===r[0].callId);return{playUntil:(d=l.slice(0,h).filter(_=>_.interceptable&&!_.ancestors.length).slice(-1)[0])==null?void 0:d.id}}),this.channel.emit($,{storyId:n,isDebugging:!0})},s=({storyId:n})=>{var l;let o=this.getLog(n).filter(h=>!h.ancestors.length),r=o.reduceRight((h,d,_)=>h>=0||d.status==="waiting"?h:_,-1);e({storyId:n,playUntil:(l=o[r-1])==null?void 0:l.callId})},i=({storyId:n,callId:o})=>{var T;let{calls:r,shadowCalls:l,resolvers:h}=this.getState(n),d=r.find(({id:E})=>E===o),_=l.find(({id:E})=>E===o);if(!d&&_&&Object.values(h).length>0){let E=(T=this.getLog(n).find(O=>O.status==="waiting"))==null?void 0:T.callId;_.id!==E&&this.setState(n,{playUntil:_.id}),Object.values(h).forEach(O=>O())}else e({storyId:n,playUntil:o})},a=({storyId:n})=>{var r;let{resolvers:o}=this.getState(n);if(Object.values(o).length>0)Object.values(o).forEach(l=>l());else{let l=(r=this.getLog(n).find(h=>h.status==="waiting"))==null?void 0:r.callId;l?e({storyId:n,playUntil:l}):c({storyId:n})}},c=({storyId:n})=>{this.setState(n,{playUntil:void 0,isDebugging:!1}),Object.values(this.getState(n).resolvers).forEach(o=>o())};this.channel.on(g.START,e),this.channel.on(g.BACK,s),this.channel.on(g.GOTO,i),this.channel.on(g.NEXT,a),this.channel.on(g.END,c)}getState(t){return this.state[t]||m()}setState(t,e){let s=this.getState(t),i=typeof e=="function"?e(s):e;this.state={...this.state,[t]:{...s,...i}},S.window.parent.__STORYBOOK_ADDON_INTERACTIONS_INSTRUMENTER_STATE__=this.state}cleanup(){this.state=Object.entries(this.state).reduce((e,[s,i])=>{let a=H(i);return a&&(e[s]=Object.assign(m(),a)),e},{});let t={controlStates:Y,logItems:[]};this.channel.emit(g.SYNC,t),S.window.parent.__STORYBOOK_ADDON_INTERACTIONS_INSTRUMENTER_STATE__=this.state}getLog(t){let{calls:e,shadowCalls:s}=this.getState(t),i=[...s];e.forEach((c,n)=>{i[n]=c});let a=new Set;return i.reduceRight((c,n)=>(n.args.forEach(o=>{o!=null&&o.__callId__&&a.add(o.__callId__)}),n.path.forEach(o=>{o.__callId__&&a.add(o.__callId__)}),(n.interceptable||n.exception)&&!a.has(n.id)&&(c.unshift({callId:n.id,status:n.status,ancestors:n.ancestors}),a.add(n.id)),c),[])}instrument(t,e){if(!It(t))return t;let{mutate:s=!1,path:i=[]}=e;return Object.keys(t).reduce((a,c)=>{let n=t[c];return typeof n!="function"?(a[c]=this.instrument(n,{...e,path:i.concat(c)}),a):typeof n.__originalFn__=="function"?(a[c]=n,a):(a[c]=(...o)=>this.track(c,n,o,e),a[c].__originalFn__=n,Object.defineProperty(a[c],"name",{value:c,writable:!1}),Object.keys(n).length>0&&Object.assign(a[c],this.instrument({...n},{...e,path:i.concat(c)})),a)},s?t:pt(t))}track(t,e,s,i){var E,O,u,b;let a=((E=s==null?void 0:s[0])==null?void 0:E.__storyId__)||((b=(u=(O=S.window.__STORYBOOK_PREVIEW__)==null?void 0:O.urlStore)==null?void 0:u.selection)==null?void 0:b.storyId),{cursor:c,ancestors:n}=this.getState(a);this.setState(a,{cursor:c+1});let o=`${n.slice(-1)[0]||a} [${c}] ${t}`,{path:r=[],intercept:l=!1,retain:h=!1}=i,d=typeof l=="function"?l(t,r):l,_={id:o,cursor:c,storyId:a,ancestors:n,path:r,method:t,args:s,interceptable:d,retain:h},T=(d&&!n.length?this.intercept:this.invoke).call(this,e,_,i);return this.instrument(T,{...i,mutate:!0,path:[{__callId__:_.id}]})}intercept(t,e,s){let{chainedCallIds:i,isDebugging:a,playUntil:c}=this.getState(e.storyId),n=i.has(e.id);return!a||n||c?(c===e.id&&this.setState(e.storyId,{playUntil:void 0}),this.invoke(t,e,s)):new Promise(o=>{this.setState(e.storyId,({resolvers:r})=>({isLocked:!1,resolvers:{...r,[e.id]:o}}))}).then(()=>(this.setState(e.storyId,o=>{let{[e.id]:r,...l}=o.resolvers;return{isLocked:!0,resolvers:l}}),this.invoke(t,e,s)))}invoke(t,e,s){let{callRefsByResult:i,renderPhase:a}=this.getState(e.storyId),c=r=>{var l,h;if(i.has(r))return i.get(r);if(r instanceof Array)return r.map(c);if(r instanceof Date)return{__date__:{value:r.toISOString()}};if(r instanceof Error){let{name:d,message:_,stack:T}=r;return{__error__:{name:d,message:_,stack:T}}}if(r instanceof RegExp){let{flags:d,source:_}=r;return{__regexp__:{flags:d,source:_}}}if(r instanceof S.window.HTMLElement){let{prefix:d,localName:_,id:T,classList:E,innerText:O}=r,u=Array.from(E);return{__element__:{prefix:d,localName:_,id:T,classNames:u,innerText:O}}}return typeof r=="function"?{__function__:{name:r.name}}:typeof r=="symbol"?{__symbol__:{description:r.description}}:typeof r=="object"&&((l=r==null?void 0:r.constructor)==null?void 0:l.name)&&((h=r==null?void 0:r.constructor)==null?void 0:h.name)!=="Object"?{__class__:{name:r.constructor.name}}:Object.prototype.toString.call(r)==="[object Object]"?Object.fromEntries(Object.entries(r).map(([d,_])=>[d,c(_)])):r},n={...e,args:e.args.map(c)};e.path.forEach(r=>{r!=null&&r.__callId__&&this.setState(e.storyId,({chainedCallIds:l})=>({chainedCallIds:new Set(Array.from(l).concat(r.__callId__))}))});let o=r=>{if(r instanceof Error){let{name:l,message:h,stack:d,callId:_=e.id}=r,T={name:l,message:h,stack:d,callId:_};if(this.update({...n,status:"error",exception:T}),this.setState(e.storyId,E=>({callRefsByResult:new Map([...Array.from(E.callRefsByResult.entries()),[r,{__callId__:e.id,retain:e.retain}]])})),e.ancestors.length)throw Object.prototype.hasOwnProperty.call(r,"callId")||Object.defineProperty(r,"callId",{value:e.id}),r;if(r!==U)throw P.warn(r),_t}throw r};try{if(a==="played"&&!e.retain)throw U;let r=(s.getArgs?s.getArgs(e,this.getState(e.storyId)):e.args).map(h=>typeof h!="function"||Object.keys(h).length?h:(...d)=>{let{cursor:_,ancestors:T}=this.getState(e.storyId);this.setState(e.storyId,{cursor:0,ancestors:[...T,e.id]});let E=()=>this.setState(e.storyId,{cursor:_,ancestors:T}),O=!1;try{let u=h(...d);return u instanceof Promise?(O=!0,u.finally(E)):u}finally{O||E()}}),l=t(...r);return l&&["object","function","symbol"].includes(typeof l)&&this.setState(e.storyId,h=>({callRefsByResult:new Map([...Array.from(h.callRefsByResult.entries()),[l,{__callId__:e.id,retain:e.retain}]])})),this.update({...n,status:l instanceof Promise?"active":"done"}),l instanceof Promise?l.then(h=>(this.update({...n,status:"done"}),h),o):l}catch(r){return o(r)}}update(t){this.channel.emit(g.CALL,t),this.setState(t.storyId,({calls:e})=>{let s=e.concat(t).reduce((i,a)=>Object.assign(i,{[a.id]:a}),{});return{calls:Object.values(s).sort((i,a)=>i.id.localeCompare(a.id,void 0,{numeric:!0}))}}),this.sync(t.storyId)}sync(t){let e=()=>{var l;let{isLocked:s,isPlaying:i}=this.getState(t),a=this.getLog(t),c=(l=a.filter(({ancestors:h})=>!h.length).find(h=>h.status==="waiting"))==null?void 0:l.callId,n=a.some(h=>h.status==="active");if(X||s||n||a.length===0){let h={controlStates:Y,logItems:a};this.channel.emit(g.SYNC,h);return}let o=a.some(h=>["done","error"].includes(h.status)),r={controlStates:{debugger:!0,start:o,back:o,goto:!0,next:i,end:i},logItems:a,pausedAt:c};this.channel.emit(g.SYNC,r)};this.setState(t,({syncTimeout:s})=>(clearTimeout(s),{syncTimeout:setTimeout(e,0)}))}};function V(t,e={}){var s,i,a,c;try{let n=!1,o=!1;return(i=(s=S.window.location)==null?void 0:s.search)!=null&&i.includes("instrument=true")?n=!0:(c=(a=S.window.location)==null?void 0:a.search)!=null&&c.includes("instrument=false")&&(o=!0),S.window.parent===S.window&&!n||o?t:(S.window.__STORYBOOK_ADDON_INTERACTIONS_INSTRUMENTER__||(S.window.__STORYBOOK_ADDON_INTERACTIONS_INSTRUMENTER__=new Nt),S.window.__STORYBOOK_ADDON_INTERACTIONS_INSTRUMENTER__.instrument(t,e))}catch(n){return R.warn(n),t}}var j=new Q(global),ft=j.fn.bind(j),{action:Ct}=V({action:ft},{retain:!0}),K=ot.getChannel(),B=new Set,w=[];K.on(q,()=>w.forEach(t=>{var e;return(e=t==null?void 0:t.mockClear)==null?void 0:e.call(t)}));K.on(J,({newPhase:t})=>{t==="loading"&&w.forEach(e=>{var s;return(s=e==null?void 0:e.mockClear)==null?void 0:s.call(e)})});var v=(t,e,s)=>{if(B.has(e))return e;B.add(e);try{if(Object.prototype.toString.call(e)==="[object Object]"){for(let[i,a]of Object.entries(e))e[i]=v(t,a,i);return e}if(Array.isArray(e))return e.map((i,a)=>v(t,i,`${s}[${a}]`));if(typeof e=="function"&&e.isAction){Object.defineProperty(e,"name",{value:s,writable:!1}),Object.defineProperty(e,"__storyId__",{value:t,writable:!1});let i=Ct(e);return w.push(i),i}}catch{}return e},Dt=({id:t,initialArgs:e})=>v(t,e),Fe=[Dt],{step:xe}=V({step:(t,e,s)=>e(s)},{intercept:!0}),We={throwPlayFunctionExceptions:!1};export{Fe as argsEnhancers,We as parameters,xe as runStep};
//# sourceMappingURL=preview.90eb86ec.js.map
