import{R as e,r as A}from"./index-6f814c40.js";import{c as m}from"./index-74f03c09.js";import{h as k,i as q,j as L,t as O,u as V,f as D,s as S,d as I,p as M,e as b}from"./requests-e9b49d79.js";import{a1 as B,i as j,a2 as d,a3 as W,w as U,u as Q,f as $,h as z,C as G,a as Y,S as Z}from"./patient-allergies-7913bd41.js";import"./_baseToString-5e23e5e6.js";import{c as N,m as J,T as K}from"./table-7a0d2d89.js";import"./_baseClone-59dfd81b.js";import"./sortBy-7530ff7d.js";import"./_equalByTag-2573c09c.js";import"./_baseForOwn-0b302854.js";import"./_createSet-00935424.js";import{c as X}from"./_basePickBy-d4bc7435.js";import"./action-list-ada7e7df.js";import"./drawer-39fcad7e.js";import"./spinner-66aa4ba7.js";import"./request-47bfd586.js";import"./_commonjsHelpers-042e6b4d.js";import"./modal-ccda-d210e6b0.js";import"./isEqual-1a694167.js";import"./_baseIsEqual-4482d138.js";import"./coding-list-1d7c950f.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./mapValues-3edfa6db.js";import"./uniq-38208ea9.js";import"./_baseUniq-701deb29.js";import"./data-list-254aa0b0.js";import"./extends-298b405d.js";import"./isString-45b38206.js";import"./index-6de6b113.js";import"./debounce-c94122dc.js";import"./toNumber-4334224f.js";import"./isPlainObject-d68c8411.js";function C({hideAdd:t,onToggleShowHistoric:n}){const o=k();return e.createElement("div",{className:"ctw-flex ctw-items-center ctw-justify-end ctw-space-x-2 ctw-p-3"},e.createElement(B,{name:"historic",text:"Historic",onChange:n}),!t&&e.createElement("button",{type:"button",className:"ctw-btn-primary",onClick:()=>o()},"Add Condition"))}try{C.displayName="PatientConditionsActions",C.__docgenInfo={description:"",displayName:"PatientConditionsActions",props:{hideAdd:{defaultValue:null,description:"",name:"hideAdd",required:!0,type:{name:"boolean"}},onToggleShowHistoric:{defaultValue:null,description:"",name:"onToggleShowHistoric",required:!0,type:{name:"() => void"}}}}}catch{}function tt(t){switch(t){case"Active":return"ctw-text-success-main";case"Pending":return"ctw-text-caution-main";default:return"ctw-text-content-lighter"}}const et=[{widthPercent:30,minWidth:320,render:t=>e.createElement("div",null,e.createElement("div",{className:"ctw-pc-title group-hover:ctw-underline"},t.display),e.createElement("div",{className:"ctw-pc-chapter"},t.ccsChapter))},{render:t=>{var n,o;return e.createElement("div",{className:"ctw-pc-status-container"},e.createElement("div",{className:m("ctw-pc-status-dot",tt(t.displayStatus))},"â€¢"),e.createElement("div",{className:"ctw-pc-status-and-extra"},e.createElement("div",{className:"ctw-pc-status"},t.displayStatus),t.isSummaryResource?e.createElement("div",null,N([(o=(n=t.patient)==null?void 0:n.organization)==null?void 0:o.name,t.recordedDate]).join(" ")):e.createElement("div",null,N([t.recorder,t.recordedDate]).join(" "))))},widthPercent:30,minWidth:128},{widthPercent:40,minWidth:132,render:t=>{const n=t.isSummaryResource?"Earliest known onset:":"Onset:";return e.createElement("div",{className:"ctw-pc-onset-notes"},t.onset&&e.createElement("div",null,n," ",t.onset),e.createElement("div",{className:"ctw-pc-notes"},t.notes.join(" ")))}}];function nt(){const[t,n]=A.useState({collection:"patient",showHistoric:!1});function o(r){n(J(X(t),r))}function i(r,s){return(t.collection==="patient"?r:s).filter(a=>t.showHistoric?!0:["Active","Pending"].includes(a.displayStatus))}return{filters:t,updateFilters:o,applyFilters:i}}const w=({record:t})=>{const n=q(),o=L();return e.createElement("div",{className:"ctw-flex ctw-space-x-2"},!t.isDeleted&&e.createElement("button",{type:"button",className:"ctw-btn-default",onClick:i=>{i.stopPropagation(),o(t)}},"Remove"),e.createElement("button",{type:"button",className:"ctw-btn-primary",onClick:i=>{i.stopPropagation(),n(t)}},"Edit"))},y=({record:t})=>{const n=k(),{getRequestContext:o}=j();return e.createElement("div",{className:"ctw-flex ctw-space-x-2"},e.createElement("button",{type:"button",className:"ctw-btn-default",onClick:async i=>{i.stopPropagation(),await O(t,await o())}},t.isArchived?"Restore":"Dismiss"),e.createElement("button",{type:"button",className:"ctw-btn-primary",onClick:i=>{i.stopPropagation(),n(t)}},"Add"))};try{w.displayName="PatientConditionHoverActions",w.__docgenInfo={description:"",displayName:"PatientConditionHoverActions",props:{record:{defaultValue:null,description:"",name:"record",required:!0,type:{name:"ConditionModel"}}}}}catch{}try{y.displayName="OtherProviderConditionHoverActions",y.__docgenInfo={description:"",displayName:"OtherProviderConditionHoverActions",props:{record:{defaultValue:null,description:"",name:"record",required:!0,type:{name:"ConditionModel"}}}}}catch{}function h({collection:t,otherConditions:n,onCollectionChange:o}){function i(a){return t===a?"ctw-text-content-black":"ctw-text-content-light"}const r=n.filter(a=>a.displayStatus==="Active").length;function s(){typeof document<"u"&&requestAnimationFrame(()=>{document.activeElement instanceof HTMLElement&&document.activeElement.blur()})}const l="ctw-relative ctw-tab-underline ctw-tab";return e.createElement("div",{className:"ctw-justify-end ctw-space-x-2 ctw-border-0 ctw-border-b ctw-border-t ctw-border-solid ctw-border-divider-light"},e.createElement("div",{className:"ctw-space-x-4"},e.createElement(d.Group,{onChange:a=>{o(a===0?"patient":"other")}},e.createElement(d.List,{className:"ctw-mt-3"},e.createElement(d,{onClick:s,className:({selected:a})=>m(i("patient"),l,{"ctw-tab-underline-selected":a})},"Condition List"),e.createElement(d,{onClick:s,className:({selected:a})=>m(i("other"),l,"ctw-space-x-2",{"ctw-tab-underline-selected":a})},e.createElement("span",null,"Other Provider Records"),e.createElement(W,{text:`${r}`,color:"primary"}))))))}try{h.displayName="PatientConditionsTabs",h.__docgenInfo={description:"",displayName:"PatientConditionsTabs",props:{collection:{defaultValue:null,description:"",name:"collection",required:!0,type:{name:"enum",value:[{value:'"patient"'},{value:'"other"'}]}},otherConditions:{defaultValue:null,description:"",name:"otherConditions",required:!0,type:{name:"ConditionModel[]"}},onCollectionChange:{defaultValue:null,description:"",name:"onCollectionChange",required:!0,type:{name:"(collection: FilterCollection) => void"}}}}}catch{}const f=U(({className:t,readOnly:n=!1})=>{const{filters:o,updateFilters:i,applyFilters:r}=nt(),s=A.useRef(null),l=Q(s),a=V(),v=$(),g=z();function T(){const c=v.isLoading,F=c||g.isLoading;return o.collection==="patient"?c:F}const E=v.data??[],_=D(g.data??[],E,!0),H=r(E,_),R=o.collection==="patient"?w:y;return e.createElement("div",{ref:s,className:m("ctw-patient-conditions",t,{"ctw-patient-conditions-stacked":l.sm})},e.createElement("div",{className:"ctw-items-center ctw-justify-between ctw-py-5"},e.createElement("div",{className:"ctw-ml-3 ctw-text-xl ctw-font-medium ctw-text-content-black"},"Conditions"),e.createElement(h,{otherConditions:_,collection:o.collection,onCollectionChange:c=>i({collection:c})}),e.createElement(C,{hideAdd:n||o.collection==="other",onToggleShowHistoric:()=>i({showHistoric:!o.showHistoric})}),e.createElement(K,{stacked:l.sm,className:"-ctw-mx-px !ctw-rounded-none",showTableHead:!1,emptyMessage:"There are no condition records available.",isLoading:T(),records:H,RowActions:n?void 0:R,columns:et,handleRowClick:c=>a({condition:c,readOnly:n||c.isSummaryResource})})))},"PatientConditions");try{f.displayName="PatientConditions",f.__docgenInfo={description:"",displayName:"PatientConditions",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},readOnly:{defaultValue:null,description:"",name:"readOnly",required:!1,type:{name:"boolean"}}}}}catch{}const Lt={component:f,tags:["autodocs"],argTypes:{className:{options:["Blank","Fixed Width"],control:"select",mapping:{Blank:"","Fixed Width":"ctw-m-auto ctw-max-w-[600px]"}}},args:{className:"Blank",readOnly:!1},decorators:[(t,{args:n})=>e.createElement(G,{env:"dev",authToken:"dummy-token",builderId:"b123"},e.createElement(Y,{patientID:"u12345",systemURL:Z},e.createElement(t,{args:n})))]},p={...S({otherConditions:I,patientConditions:M})},u={...S({otherConditions:b,patientConditions:b})};var x;p.parameters={...p.parameters,storySource:{source:`{
  ...setupConditionMocks({
    otherConditions,
    patientConditions
  })
}`,...(x=p.parameters)==null?void 0:x.storySource}};var P;u.parameters={...u.parameters,storySource:{source:`{
  ...setupConditionMocks({
    otherConditions: emptyConditions,
    patientConditions: emptyConditions
  })
}`,...(P=u.parameters)==null?void 0:P.storySource}};const Ot=["Basic","Empty"];export{p as Basic,u as Empty,Ot as __namedExportsOrder,Lt as default};
//# sourceMappingURL=patient-conditions.stories-71e333c0.js.map
