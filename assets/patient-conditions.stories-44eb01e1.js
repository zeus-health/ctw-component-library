import{R as e,r as A}from"./index-6f814c40.js";import{c as p}from"./index-74f03c09.js";import{h as k,P as L,i as O,j as M,t as V,u as D,f as I,s as H,d as j,p as B,e as b}from"./requests-88f5dd51.js";import{u as S,P as W}from"./use-patient-history-2a1cac02.js";import{aa as U,u as Q,ab as m,ac as $,w as z,h as G,j as Y,k as Z,C as J,a as K,S as X}from"./patient-allergies-940c13bb.js";import"./_baseToString-7c0e3f59.js";import{c as N,m as tt,T as et}from"./table-8acfb15e.js";import"./_baseClone-17ec433b.js";import"./sortBy-a390368e.js";import"./_equalByTag-eda72788.js";import"./_baseForOwn-7324d3a8.js";import"./_createSet-6ff8e1d4.js";import{c as nt}from"./_basePickBy-fa3aec3b.js";import"./action-list-fa5a295c.js";import"./drawer-39fcad7e.js";import"./spinner-66aa4ba7.js";import"./request-47bfd586.js";import"./_commonjsHelpers-042e6b4d.js";import"./modal-ccda-6c17bc78.js";import"./isEqual-298b6ab1.js";import"./_baseIsEqual-7d59e24c.js";import"./coding-list-1d7c950f.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./mapValues-13598fe6.js";import"./uniq-8676ca12.js";import"./data-list-254aa0b0.js";import"./extends-b0154772.js";import"./isString-933c0e0c.js";import"./debounce-5029c56d.js";import"./toNumber-d7ce3bd9.js";import"./index-6de6b113.js";import"./isPlainObject-f51be120.js";function w({hideAdd:t,onToggleShowHistoric:n}){const o=k(),i=S();return e.createElement("div",{className:"ctw-flex ctw-items-center ctw-justify-end ctw-space-x-2 ctw-p-3"},i.lastRetrievedAt&&t&&e.createElement(L,{patientHistory:i,message:"Last Retrieved"}),e.createElement(U,{name:"historic",text:"Historic",onChange:n}),!t&&e.createElement("button",{type:"button",className:"ctw-btn-primary",onClick:()=>o()},"Add Condition"))}try{w.displayName="PatientConditionsActions",w.__docgenInfo={description:"",displayName:"PatientConditionsActions",props:{hideAdd:{defaultValue:null,description:"",name:"hideAdd",required:!0,type:{name:"boolean"}},onToggleShowHistoric:{defaultValue:null,description:"",name:"onToggleShowHistoric",required:!0,type:{name:"() => void"}}}}}catch{}function ot(t){switch(t){case"Active":return"ctw-text-success-main";case"Pending":return"ctw-text-caution-main";default:return"ctw-text-content-lighter"}}const it=[{widthPercent:30,minWidth:320,render:t=>e.createElement("div",null,e.createElement("div",{className:"ctw-pc-title group-hover:ctw-underline"},t.display),e.createElement("div",{className:"ctw-pc-chapter"},t.ccsChapter))},{render:t=>{var n,o;return e.createElement("div",{className:"ctw-pc-status-container"},e.createElement("div",{className:p("ctw-pc-status-dot",ot(t.displayStatus))},"â€¢"),e.createElement("div",{className:"ctw-pc-status-and-extra"},e.createElement("div",{className:"ctw-pc-status"},t.displayStatus),t.isSummaryResource?e.createElement("div",null,N([(o=(n=t.patient)==null?void 0:n.organization)==null?void 0:o.name,t.recordedDate]).join(" ")):e.createElement("div",null,N([t.recorder,t.recordedDate]).join(" "))))},widthPercent:30,minWidth:128},{widthPercent:40,minWidth:132,render:t=>{const n=t.isSummaryResource?"Earliest known onset:":"Onset:";return e.createElement("div",{className:"ctw-pc-onset-notes"},t.onset&&e.createElement("div",null,n," ",t.onset),e.createElement("div",{className:"ctw-pc-notes"},t.notes.join(" ")))}}];function at(){const[t,n]=A.useState({collection:"patient",showHistoric:!1});function o(s){n(tt(nt(t),s))}function i(s,r){return(t.collection==="patient"?s:r).filter(d=>t.showHistoric?!0:["Active","Pending"].includes(d.displayStatus))}return{filters:t,updateFilters:o,applyFilters:i}}const y=({record:t})=>{const n=O(),o=M();return e.createElement("div",{className:"ctw-flex ctw-space-x-2"},!t.isDeleted&&e.createElement("button",{type:"button",className:"ctw-btn-default",onClick:i=>{i.stopPropagation(),o(t)}},"Remove"),e.createElement("button",{type:"button",className:"ctw-btn-primary",onClick:i=>{i.stopPropagation(),n(t)}},"Edit"))},h=({record:t})=>{const n=k(),{getRequestContext:o}=Q();return e.createElement("div",{className:"ctw-flex ctw-space-x-2"},e.createElement("button",{type:"button",className:"ctw-btn-default",onClick:async i=>{i.stopPropagation(),await V(t,await o())}},t.isArchived?"Restore":"Dismiss"),e.createElement("button",{type:"button",className:"ctw-btn-primary",onClick:i=>{i.stopPropagation(),n(t)}},"Add"))};try{y.displayName="PatientConditionHoverActions",y.__docgenInfo={description:"",displayName:"PatientConditionHoverActions",props:{record:{defaultValue:null,description:"",name:"record",required:!0,type:{name:"ConditionModel"}}}}}catch{}try{h.displayName="OtherProviderConditionHoverActions",h.__docgenInfo={description:"",displayName:"OtherProviderConditionHoverActions",props:{record:{defaultValue:null,description:"",name:"record",required:!0,type:{name:"ConditionModel"}}}}}catch{}function f({collection:t,otherConditions:n,onCollectionChange:o}){function i(a){return t===a?"ctw-text-content-black":"ctw-text-content-light"}const s=n.filter(a=>a.displayStatus==="Active").length;function r(){typeof document<"u"&&requestAnimationFrame(()=>{document.activeElement instanceof HTMLElement&&document.activeElement.blur()})}const l="ctw-relative ctw-tab-underline ctw-tab",d=S();return e.createElement("div",{className:"ctw-justify-end ctw-space-x-2 ctw-border-0 ctw-border-b ctw-border-t ctw-border-solid ctw-border-divider-light"},t==="other"&&e.createElement("div",{className:"ctw-space-y-3"},e.createElement(W,{status:d.lastStatus,date:d.dateCreatedAt})),e.createElement("div",{className:"ctw-space-x-4"},e.createElement(m.Group,{onChange:a=>{o(a===0?"patient":"other")}},e.createElement(m.List,{className:"ctw-mt-3"},e.createElement(m,{onClick:r,className:({selected:a})=>p(i("patient"),l,{"ctw-tab-underline-selected":a})},"Condition List"),e.createElement(m,{onClick:r,className:({selected:a})=>p(i("other"),l,"ctw-space-x-2",{"ctw-tab-underline-selected":a})},e.createElement("span",null,"Other Provider Records"),e.createElement($,{text:`${s}`,color:"primary"}))))))}try{f.displayName="PatientConditionsTabs",f.__docgenInfo={description:"",displayName:"PatientConditionsTabs",props:{collection:{defaultValue:null,description:"",name:"collection",required:!0,type:{name:"enum",value:[{value:'"patient"'},{value:'"other"'}]}},otherConditions:{defaultValue:null,description:"",name:"otherConditions",required:!0,type:{name:"ConditionModel[]"}},onCollectionChange:{defaultValue:null,description:"",name:"onCollectionChange",required:!0,type:{name:"(collection: FilterCollection) => void"}}}}}catch{}const v=z(({className:t,readOnly:n=!1})=>{const{filters:o,updateFilters:i,applyFilters:s}=at(),r=A.useRef(null),l=G(r),d=D(),a=Y(),E=Z();function T(){const c=a.isLoading,q=c||E.isLoading;return o.collection==="patient"?c:q}const g=a.data??[],_=I(E.data??[],g,!0),R=s(g,_),F=o.collection==="patient"?y:h;return e.createElement("div",{ref:r,className:p("ctw-patient-conditions",t,{"ctw-patient-conditions-stacked":l.sm})},e.createElement("div",{className:"ctw-items-center ctw-justify-between ctw-py-5"},e.createElement("div",{className:"ctw-ml-3 ctw-text-xl ctw-font-medium ctw-text-content-black"},"Conditions"),e.createElement(f,{otherConditions:_,collection:o.collection,onCollectionChange:c=>i({collection:c})}),e.createElement(w,{hideAdd:n||o.collection==="other",onToggleShowHistoric:()=>i({showHistoric:!o.showHistoric})}),e.createElement(et,{stacked:l.sm,className:"-ctw-mx-px !ctw-rounded-none",showTableHead:!1,emptyMessage:"There are no condition records available.",isLoading:T(),records:R,RowActions:n?void 0:F,columns:it,handleRowClick:c=>d({condition:c,readOnly:n||c.isSummaryResource})})))},"PatientConditions");try{v.displayName="PatientConditions",v.__docgenInfo={description:"",displayName:"PatientConditions",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},readOnly:{defaultValue:null,description:"",name:"readOnly",required:!1,type:{name:"boolean"}}}}}catch{}const Vt={component:v,tags:["autodocs"],argTypes:{className:{options:["Blank","Fixed Width"],control:"select",mapping:{Blank:"","Fixed Width":"ctw-m-auto ctw-max-w-[600px]"}}},args:{className:"Blank",readOnly:!1},decorators:[(t,{args:n})=>e.createElement(J,{env:"dev",authToken:"dummy-token",builderId:"b123"},e.createElement(K,{patientID:"u12345",systemURL:X},e.createElement(t,{args:n})))]},u={...H({otherConditions:j,patientConditions:B})},C={...H({otherConditions:b,patientConditions:b})};var P;u.parameters={...u.parameters,storySource:{source:`{
  ...setupConditionMocks({
    otherConditions,
    patientConditions
  })
}`,...(P=u.parameters)==null?void 0:P.storySource}};var x;C.parameters={...C.parameters,storySource:{source:`{
  ...setupConditionMocks({
    otherConditions: emptyConditions,
    patientConditions: emptyConditions
  })
}`,...(x=C.parameters)==null?void 0:x.storySource}};const Dt=["Basic","Empty"];export{u as Basic,C as Empty,Dt as __namedExportsOrder,Vt as default};
//# sourceMappingURL=patient-conditions.stories-44eb01e1.js.map
