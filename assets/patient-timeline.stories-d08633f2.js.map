{"version":3,"file":"patient-timeline.stories-d08633f2.js","sources":["../../src/components/content/timeline/encounter-details-drawer.tsx","../../src/components/core/simple-more-list.tsx","../../src/components/content/timeline/patient-timeline-columns.tsx","../../src/fhir/models/encounter.ts","../../src/fhir/encounters.ts","../../src/components/content/timeline/patient-timeline.tsx","../../src/components/content/timeline/story-helpers/mocks/encounters.ts","../../src/components/content/timeline/story-helpers/mocks/patient.ts","../../src/components/content/timeline/story-helpers/mocks/requests.ts","../../src/components/content/timeline/patient-timeline.stories.tsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport { DocumentButton } from \"../CCDA/document-button\";\nimport { useCCDAModal } from \"../CCDA/modal-ccda\";\nimport { CodingList } from \"@/components/core/coding-list\";\nimport { Details } from \"@/components/core/collapsible-data-list-details\";\nimport { Drawer } from \"@/components/core/drawer\";\nimport { Loading } from \"@/components/core/loading\";\nimport { useCTW } from \"@/components/core/providers/ctw-provider\";\nimport { useDrawer } from \"@/components/core/providers/drawer-provider\";\nimport { getBinaryId } from \"@/fhir/binaries\";\nimport { EncounterModel } from \"@/fhir/models/encounter\";\nimport { searchProvenances } from \"@/fhir/provenance\";\nimport { capitalize } from \"@/utils/nodash\";\n\nexport function useEncounterDetailsDrawer() {\n  const { openDrawer } = useDrawer();\n\n  return (encounter: EncounterModel) => {\n    openDrawer({\n      component: (props) => (\n        <EncounterDetailsDrawer encounter={encounter} {...props} />\n      ),\n    });\n  };\n}\n\nexport type EncounterDetailsDrawerProps = {\n  className?: string;\n  encounter: EncounterModel;\n  isOpen: boolean;\n  onClose: () => void;\n};\n\nexport function EncounterDetailsDrawer({\n  encounter,\n  className,\n  isOpen,\n  onClose,\n}: EncounterDetailsDrawerProps) {\n  const openCCDAModal = useCCDAModal();\n  const [isLoading, setIsLoading] = useState(true);\n  const [binaryId, setBinaryId] = useState<string>();\n  const { getRequestContext } = useCTW();\n\n  useEffect(() => {\n    async function load() {\n      setIsLoading(true);\n      const requestContext = await getRequestContext();\n      const provenances = await searchProvenances(requestContext, [encounter]);\n      setBinaryId(getBinaryId(provenances, encounter.id));\n      setIsLoading(false);\n    }\n\n    void load();\n  }, [encounter, getRequestContext]);\n\n  return (\n    <Drawer\n      className={className}\n      title=\"Encounter Details\"\n      isOpen={isOpen}\n      onClose={onClose}\n      showCloseFooter\n    >\n      <Drawer.Body>\n        <div className=\"ctw-py-2\">\n          <div className=\"ctw-text-2xl\">\n            {encounter.periodStart} - {encounter.periodEnd}\n          </div>\n          <div className=\"ctw-text-sm\">{encounter.typeDisplay}</div>\n        </div>\n\n        {isLoading ? (\n          <Loading message=\"Loading encounter data...\" />\n        ) : (\n          <Details\n            data={encounterData(encounter)}\n            documentButton={\n              binaryId ? (\n                <DocumentButton\n                  onClick={() => openCCDAModal(binaryId, \"Encounter\")}\n                  text=\"Source Document\"\n                />\n              ) : undefined\n            }\n          />\n        )}\n      </Drawer.Body>\n    </Drawer>\n  );\n}\n\nexport const encounterData = (encounter: EncounterModel) => [\n  { label: \"Period Start\", value: encounter.periodStart },\n  { label: \"Period End\", value: encounter.periodEnd },\n  { label: \"Status\", value: capitalize(encounter.status) },\n  { label: \"Class\", value: encounter.class },\n  {\n    label: \"Type\",\n    value: encounter.typeCodings.length ? (\n      <CodingList codings={encounter.typeCodings} />\n    ) : undefined,\n  },\n  { label: \"Location\", value: encounter.location },\n  { label: \"Participants\", value: encounter.participants },\n  { label: \"Reason\", value: encounter.reason },\n  { label: \"Diagnosis\", value: encounter.diagnosis },\n  { label: \"Discharge Disposition\", value: encounter.dischargeDisposition },\n];\n","type SimpleMoreListProps = {\n  className?: string;\n  items: string[];\n  limit: number;\n  total: number;\n};\n\nexport const SimpleMoreList = ({\n  className,\n  items,\n  limit,\n  total,\n}: SimpleMoreListProps) => (\n  <div className={className}>\n    {items.slice(0, limit).map((item, index) => (\n      // eslint-disable-next-line react/no-array-index-key\n      <div key={item + index}>\n        <div>{item}</div>\n      </div>\n    ))}\n    {total > limit && (\n      <div className=\"ctw-font-medium\">+ {total - limit} more</div>\n    )}\n  </div>\n);\n","import { SimpleMoreList } from \"@/components/core/simple-more-list\";\nimport { TableColumn } from \"@/components/core/table/table-helpers\";\nimport { ViewFHIR } from \"@/components/core/view-fhir\";\nimport { EncounterModel } from \"@/fhir/models/encounter\";\n\nexport const patientTimelineColumns = (includeViewFhirResource = true) => {\n  const timellineColumns: TableColumn<EncounterModel>[] = [\n    {\n      widthPercent: 20,\n      minWidth: 150,\n      render: (encounter) => (\n        <div>\n          <div className=\"ctw-cell-title group-hover:ctw-underline\">\n            {encounter.periodStart}\n          </div>\n          <div>{encounter.typeDisplay}</div>\n        </div>\n      ),\n    },\n    {\n      widthPercent: 30,\n      minWidth: 250,\n      render: (encounter) => {\n        const { participant } = encounter.resource;\n        if (!participant || participant.length === 0) return null;\n\n        const items = participant.map((p) => {\n          const name = p.individual?.display ?? \"\";\n          let qualification = p.type?.[0].text ?? \"\";\n          if ([\"noinformation\", \"unk\"].includes(qualification.toLowerCase())) {\n            qualification = \"\";\n          }\n          if (name && qualification) {\n            return `${name} (${qualification})`;\n          }\n          return name || qualification;\n        });\n\n        return (\n          <div>\n            <div className=\"ctw-cell-title\">{encounter.location}</div>\n            <SimpleMoreList\n              items={items}\n              limit={3}\n              total={participant.length}\n            />\n          </div>\n        );\n      },\n    },\n    {\n      widthPercent: 40,\n      minWidth: 200,\n      render: (encounter) => {\n        const { diagnosis } = encounter.resource;\n        if (!diagnosis || diagnosis.length === 0) return null;\n\n        return (\n          <div>\n            <div className=\"ctw-cell-title\">Diagnosis</div>\n            <SimpleMoreList\n              items={diagnosis.map((d) => d.condition.display ?? \"\")}\n              limit={3}\n              total={diagnosis.length}\n            />\n          </div>\n        );\n      },\n    },\n  ];\n\n  if (includeViewFhirResource) {\n    timellineColumns.push({\n      widthPercent: 10,\n      minWidth: 200,\n      render: (encounter) => (\n        <ViewFHIR name=\"Encounter Resource\" resource={encounter.resource} />\n      ),\n    });\n  }\n\n  return timellineColumns;\n};\n","import { Coding } from \"fhir/r4\";\nimport { codeableConceptLabel, findCoding } from \"../codeable-concept\";\nimport { formatDateISOToLocal } from \"../formatters\";\nimport { SYSTEM_ACT_CODE } from \"../system-urls\";\nimport { FHIRModel } from \"./fhir-model\";\nimport { compact, find, flatten } from \"@/utils/nodash\";\n\nexport class EncounterModel extends FHIRModel<fhir4.Encounter> {\n  get class(): string | undefined {\n    const { display, code } = this.resource.class;\n    return display ?? code !== \"UNK\" ? code : undefined;\n  }\n\n  get diagnosis(): string | undefined {\n    const diagnoses = compact(\n      this.resource.diagnosis?.map((d) => d.condition.display)\n    );\n    return diagnoses.length ? diagnoses.join(\", \") : undefined;\n  }\n\n  get dischargeDisposition(): string | undefined {\n    return codeableConceptLabel(\n      this.resource.hospitalization?.dischargeDisposition\n    );\n  }\n\n  get location(): string | undefined {\n    const locations = compact(\n      this.resource.location?.map((l) => l.location.display)\n    );\n    return locations.length ? locations.join(\", \") : undefined;\n  }\n\n  get participants(): string | undefined {\n    const participants = compact(\n      this.resource.participant?.map((p) => p.individual?.display)\n    );\n    return participants.length ? participants.join(\", \") : undefined;\n  }\n\n  get periodEnd() {\n    return formatDateISOToLocal(this.resource.period?.end);\n  }\n\n  get periodStart() {\n    return formatDateISOToLocal(this.resource.period?.start);\n  }\n\n  get reason(): string | undefined {\n    const reasons = compact(\n      this.resource.reasonCode?.map((d) => codeableConceptLabel(d))\n    );\n\n    return reasons.length ? reasons.join(\", \") : undefined;\n  }\n\n  get status() {\n    return this.resource.status;\n  }\n\n  get typeCodings(): Coding[] {\n    return compact(flatten(this.resource.type?.map((t) => t.coding)));\n  }\n\n  get typeDisplay(): string | undefined {\n    const codeableConcept = find(this.resource.type, {\n      coding: [{ system: SYSTEM_ACT_CODE }],\n    });\n    const coding = findCoding(SYSTEM_ACT_CODE, codeableConcept);\n    return coding?.display || coding?.code;\n  }\n}\n","import { getIncludedBasics } from \"./bundle\";\nimport { EncounterModel } from \"./models/encounter\";\nimport { searchCommonRecords } from \"./search-helpers\";\nimport { useQueryWithPatient } from \"@/components/core/providers/patient-provider\";\nimport { QUERY_KEY_PATIENT_ENCOUNTERS } from \"@/utils/query-keys\";\nimport { Telemetry } from \"@/utils/telemetry\";\n\nexport function usePatientEncounters() {\n  return useQueryWithPatient(\n    QUERY_KEY_PATIENT_ENCOUNTERS,\n    [],\n    async (requestContext, patient) => {\n      try {\n        const { bundle, resources: encounters } = await searchCommonRecords(\n          \"Encounter\",\n          requestContext,\n          {\n            patientUPID: patient.UPID,\n          }\n        );\n        const models = setupEncounterModels(encounters, bundle);\n        return models;\n      } catch (e) {\n        Telemetry.logError(\n          e as Error,\n          \"Failed fetching timeline information for patient\"\n        );\n        throw new Error(\n          `Failed fetching timeline information for patient: ${e}`\n        );\n      }\n    }\n  );\n}\nfunction setupEncounterModels(\n  resources: fhir4.Encounter[],\n  bundle: fhir4.Bundle\n): EncounterModel[] {\n  const basicsMap = getIncludedBasics(bundle);\n  return resources.map(\n    (c) => new EncounterModel(c, undefined, basicsMap.get(c.id ?? \"\"))\n  );\n}\n","import { useEncounterDetailsDrawer } from \"./encounter-details-drawer\";\nimport { patientTimelineColumns } from \"./patient-timeline-columns\";\nimport { Table } from \"@/components/core/table/table\";\nimport { usePatientEncounters } from \"@/fhir/encounters\";\nimport { orderBy } from \"@/utils/nodash\";\n\nexport type PatientTimelineProps = {\n  className?: string;\n  includeViewFhirResource: boolean;\n};\n\nexport function PatientTimeline({\n  className,\n  includeViewFhirResource,\n}: PatientTimelineProps) {\n  const patientEncounterQuery = usePatientEncounters();\n  const openDetails = useEncounterDetailsDrawer();\n\n  const encounters = orderBy(\n    patientEncounterQuery.data ?? [],\n    [(encounter) => encounter.resource.period?.start ?? \"\"],\n    [\"desc\"]\n  );\n\n  return (\n    <div className={className}>\n      <Table\n        className=\"-ctw-mx-px !ctw-rounded-none\"\n        showTableHead={false}\n        isLoading={patientEncounterQuery.isLoading}\n        records={encounters}\n        columns={patientTimelineColumns(includeViewFhirResource)}\n        handleRowClick={(encounter) => openDetails(encounter)}\n      />\n    </div>\n  );\n}\n","export const encounters: fhir4.Bundle = {\n  resourceType: \"Bundle\",\n  id: \"4b58609b-b4c2-43bb-81de-21b9a02fa62f\",\n  meta: {\n    lastUpdated: \"2023-01-03T22:30:53.366+00:00\",\n  },\n  type: \"searchset\",\n  total: 6,\n  entry: [\n    {\n      fullUrl:\n        \"https://api.dev.zusapi.com/fhir/Encounter/5af9550a-f9c7-4ca6-86b2-ecdb4c164ec3\",\n      resource: {\n        resourceType: \"Encounter\",\n        id: \"5af9550a-f9c7-4ca6-86b2-ecdb4c164ec3\",\n        meta: {\n          extension: [\n            {\n              url: \"https://zusapi.com/created-at\",\n              valueInstant: \"2023-01-03T20:11:44.150+00:00\",\n            },\n          ],\n          versionId: \"1\",\n          lastUpdated: \"2023-01-03T20:11:44.232+00:00\",\n          source: \"#GKzYTPJnzCuiBU0w\",\n          tag: [\n            {\n              system: \"https://zusapi.com/thirdparty/source\",\n              code: \"commonwell\",\n            },\n            {\n              system: \"https://zusapi.com/accesscontrol/owner\",\n              code: \"builder/d037b2ef-66d6-4fcc-b228-2bc748ce4d0e\",\n              display: \"CTW Health\",\n            },\n          ],\n        },\n        extension: [\n          {\n            url: \"https://zusapi.com/fhir/identifier/universal-id\",\n            valueString: \"7bd02b95-a275-485b-8053-2ef190d2d86a\",\n          },\n        ],\n        status: \"finished\",\n        class: {\n          system: \"http://terminology.hl7.org/CodeSystem/v3-NullFlavor\",\n          code: \"UNK\",\n        },\n        type: [\n          {\n            coding: [\n              {\n                system: \"http://www.ama-assn.org/go/cpt\",\n                code: \"99203\",\n                display: \"Office Visit\",\n              },\n              {\n                system: \"urn:oid:1.2.840.114350.1.13.418.2.7.4.698084.30\",\n                code: \"101\",\n              },\n              {\n                system: \"urn:oid:2.16.840.1.113883.5.4\",\n                code: \"AMB\",\n              },\n              {\n                system: \"urn:oid:1.2.840.114350.1.72.1.30\",\n                code: \"101\",\n              },\n              {\n                system: \"urn:oid:1.2.840.114350.1.72.1.30.1\",\n                code: \"4\",\n              },\n            ],\n            text: \"Office Visit\",\n          },\n        ],\n        subject: {\n          reference: \"Patient/6e6ea727-a7ac-47d0-96b8-536e1073826c\",\n          type: \"Patient\",\n        },\n        participant: [\n          {\n            type: [\n              {\n                coding: [\n                  {\n                    display: \"MinuteClinic\",\n                  },\n                  {\n                    system:\n                      \"urn:oid:1.2.840.114350.1.13.418.2.7.10.836982.1050\",\n                    code: \"175\",\n                    display: \"MinuteClinic\",\n                  },\n                ],\n                text: \"MinuteClinic\",\n              },\n            ],\n            individual: {\n              reference: \"Practitioner/8653ba26-4f9e-48f6-b3a5-a386345bc990\",\n              type: \"Practitioner\",\n              display: \"Mary Jane Wilson NP\",\n            },\n          },\n        ],\n        period: {\n          start: \"2018-09-08T09:55:00-05:00\",\n          end: \"2018-09-08T11:29:32-05:00\",\n        },\n        length: {\n          value: 94,\n          unit: \"minute\",\n          system: \"http://unitsofmeasure.org\",\n          code: \"min\",\n        },\n        diagnosis: [\n          {\n            condition: {\n              reference: \"Condition/a73a7f57-cc74-4165-ab7b-5d8e43e71f6d\",\n              type: \"Condition\",\n              display: \"COPD with acute exacerbation\",\n            },\n          },\n          {\n            condition: {\n              reference: \"Condition/5687dd21-523e-425e-8f76-e3410339aaba\",\n              type: \"Condition\",\n              display: \"Upper respiratory infection, acute\",\n            },\n          },\n          {\n            condition: {\n              reference: \"Condition/12345\",\n              type: \"Condition\",\n              display: \"Difficulty breathing\",\n            },\n          },\n          {\n            condition: {\n              reference: \"Condition/12345\",\n              type: \"Condition\",\n              display: \"Infection\",\n            },\n          },\n        ],\n        location: [\n          {\n            location: {\n              reference: \"Location/e85b4d87-2cbd-4ab3-b842-a821cde3d339\",\n              type: \"Location\",\n              display: \"MinuteClinic OH4304\",\n            },\n          },\n        ],\n      },\n      search: {\n        mode: \"match\",\n      },\n    },\n    {\n      fullUrl:\n        \"https://api.dev.zusapi.com/fhir/Encounter/77190d01-91ef-4dbd-8af2-8183ed9a40d3\",\n      resource: {\n        resourceType: \"Encounter\",\n        id: \"77190d01-91ef-4dbd-8af2-8183ed9a40d3\",\n        meta: {\n          extension: [\n            {\n              url: \"https://zusapi.com/created-at\",\n              valueInstant: \"2023-01-03T20:11:47.096+00:00\",\n            },\n          ],\n          versionId: \"1\",\n          lastUpdated: \"2023-01-03T20:11:47.145+00:00\",\n          source: \"#vpjWA3FgSp4rbi6v\",\n          tag: [\n            {\n              system: \"https://zusapi.com/thirdparty/source\",\n              code: \"commonwell\",\n            },\n            {\n              system: \"https://zusapi.com/accesscontrol/owner\",\n              code: \"builder/d037b2ef-66d6-4fcc-b228-2bc748ce4d0e\",\n              display: \"CTW Health\",\n            },\n          ],\n        },\n        extension: [\n          {\n            url: \"https://zusapi.com/fhir/identifier/universal-id\",\n            valueString: \"7bd02b95-a275-485b-8053-2ef190d2d86a\",\n          },\n        ],\n        status: \"finished\",\n        class: {\n          system: \"urn:oid:2.16.840.1.113883.5.4\",\n          code: \"IMP\",\n        },\n        subject: {\n          reference: \"Patient/6e6ea727-a7ac-47d0-96b8-536e1073826c\",\n          type: \"Patient\",\n        },\n        participant: [\n          {\n            type: [\n              {\n                coding: [\n                  {\n                    display: \"Physical Medicine and Rehab\",\n                  },\n                  {\n                    system: \"urn:oid:1.2.840.114350.1.72.1.7.7.10.688867.4160\",\n                    code: \"86\",\n                    display: \"Physical Medicine and Rehab\",\n                  },\n                  {\n                    system:\n                      \"urn:oid:1.2.840.114350.1.13.535.2.7.10.836982.1050\",\n                    code: \"33\",\n                    display: \"Physical Medicine and Rehab\",\n                  },\n                ],\n                text: \"Physical Medicine and Rehab\",\n              },\n            ],\n            individual: {\n              reference: \"Practitioner/2c77e583-3dd3-45dd-888e-a31a8f3645f5\",\n              type: \"Practitioner\",\n              display: \"David Lee\",\n            },\n          },\n        ],\n        period: {\n          start: \"2019-01-09T21:49:00-05:00\",\n          end: \"2019-01-18T12:17:00-04:00\",\n        },\n        length: {\n          value: 12328,\n          unit: \"minute\",\n          system: \"http://unitsofmeasure.org\",\n          code: \"min\",\n        },\n        diagnosis: [\n          {\n            condition: {\n              reference: \"Condition/5a7a7ddc-fafe-46eb-9ea4-0d1191603334\",\n              type: \"Condition\",\n              display: \"AIDP (acute inflammatory demyelinating polyneuropathy)\",\n            },\n          },\n        ],\n        hospitalization: {\n          dischargeDisposition: {\n            coding: [\n              {\n                system: \"urn:oid:1.2.840.114350.1.13.535.2.7.4.698084.18888\",\n                code: \"1\",\n                display: \"Home or Self Care\",\n              },\n            ],\n            text: \"Home or Self Care\",\n          },\n        },\n        location: [\n          {\n            location: {\n              reference: \"Location/71c90541-0b1a-4bc3-a227-6787e72a11f9\",\n              type: \"Location\",\n              display: \"ABC 17 REHAB\",\n            },\n          },\n        ],\n      },\n      search: {\n        mode: \"match\",\n      },\n    },\n    {\n      fullUrl:\n        \"https://api.dev.zusapi.com/fhir/Encounter/c76550d6-3a5b-4fdc-91f7-f77ba29a6ce0\",\n      resource: {\n        resourceType: \"Encounter\",\n        id: \"c76550d6-3a5b-4fdc-91f7-f77ba29a6ce0\",\n        meta: {\n          extension: [\n            {\n              url: \"https://zusapi.com/created-at\",\n              valueInstant: \"2023-01-03T20:11:44.673+00:00\",\n            },\n          ],\n          versionId: \"1\",\n          lastUpdated: \"2023-01-03T20:11:44.747+00:00\",\n          source: \"#2AhmrNrpGVMXgGuM\",\n          tag: [\n            {\n              system: \"https://zusapi.com/thirdparty/source\",\n              code: \"commonwell\",\n            },\n            {\n              system: \"https://zusapi.com/accesscontrol/owner\",\n              code: \"builder/d037b2ef-66d6-4fcc-b228-2bc748ce4d0e\",\n              display: \"CTW Health\",\n            },\n          ],\n        },\n        extension: [\n          {\n            url: \"https://zusapi.com/fhir/identifier/universal-id\",\n            valueString: \"7bd02b95-a275-485b-8053-2ef190d2d86a\",\n          },\n        ],\n        status: \"finished\",\n        class: {\n          system: \"http://terminology.hl7.org/CodeSystem/v3-NullFlavor\",\n          code: \"UNK\",\n        },\n        type: [\n          {\n            coding: [\n              {\n                system: \"http://www.ama-assn.org/go/cpt\",\n                display: \"Jerry Mason MD\",\n              },\n              {\n                system: \"urn:oid:2.16.840.1.113883.4.391.23603\",\n                display: \"(TEL)\",\n              },\n            ],\n            text: \"Jerry L Mason MD\",\n          },\n        ],\n        subject: {\n          reference: \"Patient/6e6ea727-a7ac-47d0-96b8-536e1073826c\",\n          type: \"Patient\",\n        },\n        participant: [\n          {\n            type: [\n              {\n                coding: [\n                  {\n                    system:\n                      \"http://terminology.hl7.org/CodeSystem/v3-NullFlavor\",\n                    code: \"NI\",\n                    display: \"NoInformation\",\n                  },\n                ],\n                text: \"NoInformation\",\n              },\n            ],\n            individual: {\n              reference: \"Practitioner/fc7ee8d7-6ad3-47a4-ab40-88f07bf7e2fa\",\n              type: \"Practitioner\",\n              display: \"Jerry Mason\",\n            },\n          },\n        ],\n        period: {\n          start: \"2020-01-14\",\n        },\n        location: [\n          {\n            location: {\n              reference: \"Location/85b347e8-bee1-40fc-bd07-799f0a0c4d74\",\n              type: \"Location\",\n              display: \"Jerry Mason MD\",\n            },\n          },\n        ],\n      },\n      search: {\n        mode: \"match\",\n      },\n    },\n    {\n      fullUrl:\n        \"https://api.dev.zusapi.com/fhir/Encounter/a108bf4e-7791-4f23-9a6e-ab9aabf1467e\",\n      resource: {\n        resourceType: \"Encounter\",\n        id: \"a108bf4e-7791-4f23-9a6e-ab9aabf1467e\",\n        meta: {\n          extension: [\n            {\n              url: \"https://zusapi.com/created-at\",\n              valueInstant: \"2023-01-03T20:11:48.071+00:00\",\n            },\n          ],\n          versionId: \"1\",\n          lastUpdated: \"2023-01-03T20:11:48.074+00:00\",\n          source: \"#AwOEd1w67hUQRVXU\",\n          tag: [\n            {\n              system: \"https://zusapi.com/thirdparty/source\",\n              code: \"commonwell\",\n            },\n            {\n              system: \"https://zusapi.com/accesscontrol/owner\",\n              code: \"builder/d037b2ef-66d6-4fcc-b228-2bc748ce4d0e\",\n              display: \"CTW Health\",\n            },\n          ],\n        },\n        extension: [\n          {\n            url: \"https://zusapi.com/fhir/identifier/universal-id\",\n            valueString: \"7bd02b95-a275-485b-8053-2ef190d2d86a\",\n          },\n        ],\n        status: \"finished\",\n        class: {\n          system: \"http://terminology.hl7.org/CodeSystem/v3-NullFlavor\",\n          code: \"UNK\",\n        },\n        subject: {\n          reference: \"Patient/6e6ea727-a7ac-47d0-96b8-536e1073826c\",\n          type: \"Patient\",\n        },\n        period: {\n          start: \"2020-05-07T09:17:39+00:00\",\n        },\n        diagnosis: [\n          {\n            condition: {\n              reference: \"Condition/17c54947-3fa4-42af-b6ce-2c187b4c774a\",\n              type: \"Condition\",\n              display: \"Sheltered homelessness\",\n            },\n          },\n        ],\n        location: [\n          {\n            location: {\n              reference: \"Location/53600c9e-e46a-4f2d-912e-859aac128942\",\n              type: \"Location\",\n              display: \"ST. JOSEPH HHS\",\n            },\n          },\n        ],\n      },\n      search: {\n        mode: \"match\",\n      },\n    },\n    {\n      fullUrl:\n        \"https://api.dev.zusapi.com/fhir/Encounter/fc6cf519-2991-4fec-98ec-4c81ec0a0f02\",\n      resource: {\n        resourceType: \"Encounter\",\n        id: \"fc6cf519-2991-4fec-98ec-4c81ec0a0f02\",\n        meta: {\n          extension: [\n            {\n              url: \"https://zusapi.com/created-at\",\n              valueInstant: \"2023-01-03T20:11:45.647+00:00\",\n            },\n          ],\n          versionId: \"1\",\n          lastUpdated: \"2023-01-03T20:11:45.824+00:00\",\n          source: \"#dVeLKurdCrwFBuZR\",\n          tag: [\n            {\n              system: \"https://zusapi.com/thirdparty/source\",\n              code: \"commonwell\",\n            },\n            {\n              system: \"https://zusapi.com/accesscontrol/owner\",\n              code: \"builder/d037b2ef-66d6-4fcc-b228-2bc748ce4d0e\",\n              display: \"CTW Health\",\n            },\n          ],\n        },\n        extension: [\n          {\n            url: \"https://zusapi.com/fhir/identifier/universal-id\",\n            valueString: \"7bd02b95-a275-485b-8053-2ef190d2d86a\",\n          },\n        ],\n        status: \"finished\",\n        class: {\n          system: \"urn:oid:2.16.840.1.113883.5.4\",\n          code: \"EMER\",\n        },\n        type: [\n          {\n            coding: [\n              {\n                system: \"urn:oid:2.16.840.1.113883.5.4\",\n                code: \"EMER\",\n                display: \"Emergency\",\n              },\n              {\n                system: \"urn:oid:1.2.840.114350.1.13.140.2.7.4.698084.30\",\n                code: \"3\",\n              },\n              {\n                system: \"urn:oid:1.2.840.114350.1.72.1.30\",\n                code: \"3\",\n              },\n              {\n                system: \"urn:oid:1.2.840.114350.1.72.1.30.1\",\n                code: \"0\",\n              },\n            ],\n            text: \"Emergency\",\n          },\n        ],\n        subject: {\n          reference: \"Patient/6e6ea727-a7ac-47d0-96b8-536e1073826c\",\n          type: \"Patient\",\n        },\n        participant: [\n          {\n            type: [\n              {\n                coding: [\n                  {\n                    display: \"Emergency Medicine\",\n                  },\n                  {\n                    system: \"urn:oid:1.2.840.114350.1.72.1.7.7.10.688867.4160\",\n                    code: \"17\",\n                    display: \"Emergency Medicine\",\n                  },\n                  {\n                    system:\n                      \"urn:oid:1.2.840.114350.1.13.140.2.7.10.836982.1050\",\n                    code: \"49\",\n                    display: \"Emergency Medicine\",\n                  },\n                ],\n                text: \"Emergency Medicine\",\n              },\n            ],\n            individual: {\n              reference: \"Practitioner/f21f7b83-c187-4164-bc6a-0ac08f8da22b\",\n              type: \"Practitioner\",\n              display: \"Minosh Madria\",\n            },\n          },\n        ],\n        period: {\n          start: \"2022-01-29T13:31:59-06:00\",\n          end: \"2022-01-29T15:02:31-06:00\",\n        },\n        length: {\n          value: 90,\n          unit: \"minute\",\n          system: \"http://unitsofmeasure.org\",\n          code: \"min\",\n        },\n        reasonCode: [\n          {\n            coding: [\n              {\n                system: \"http://snomed.info/sct\",\n                code: \"404684003\",\n                display: \"Clinical finding (finding)\",\n              },\n            ],\n            text: \"Clinical finding\",\n          },\n        ],\n        diagnosis: [\n          {\n            condition: {\n              reference: \"Condition/e1af6029-4ac3-43b9-9802-48c65d064e24\",\n              type: \"Condition\",\n              display: \"Tooth pain\",\n            },\n          },\n        ],\n        hospitalization: {\n          dischargeDisposition: {\n            coding: [\n              {\n                system: \"urn:oid:1.2.840.114350.1.13.140.2.7.4.698084.18888\",\n                code: \"01\",\n                display: \"Discharged to home or self care (routine discharge)\",\n              },\n            ],\n            text: \"Discharged to home or self care (routine discharge)\",\n          },\n        },\n        location: [\n          {\n            location: {\n              reference: \"Location/543c2893-1ec5-45d5-9664-9d1a23d3c2b9\",\n              type: \"Location\",\n              display: \"ABCD Emergency Department\",\n            },\n          },\n        ],\n      },\n      search: {\n        mode: \"match\",\n      },\n    },\n    {\n      fullUrl:\n        \"https://api.dev.zusapi.com/fhir/Encounter/6b77e120-04b4-4cd6-8f0b-3543767cd51f\",\n      resource: {\n        resourceType: \"Encounter\",\n        id: \"6b77e120-04b4-4cd6-8f0b-3543767cd51f\",\n        meta: {\n          extension: [\n            {\n              url: \"https://zusapi.com/created-at\",\n              valueInstant: \"2023-01-03T20:11:46.265+00:00\",\n            },\n          ],\n          versionId: \"1\",\n          lastUpdated: \"2023-01-03T20:11:46.271+00:00\",\n          source: \"#F03sLYfdmocPYxKx\",\n          tag: [\n            {\n              system: \"https://zusapi.com/thirdparty/source\",\n              code: \"commonwell\",\n            },\n            {\n              system: \"https://zusapi.com/accesscontrol/owner\",\n              code: \"builder/d037b2ef-66d6-4fcc-b228-2bc748ce4d0e\",\n              display: \"CTW Health\",\n            },\n          ],\n        },\n        extension: [\n          {\n            url: \"https://zusapi.com/fhir/identifier/universal-id\",\n            valueString: \"7bd02b95-a275-485b-8053-2ef190d2d86a\",\n          },\n        ],\n        status: \"finished\",\n        class: {\n          system: \"http://terminology.hl7.org/CodeSystem/v3-NullFlavor\",\n          code: \"UNK\",\n        },\n        type: [\n          {\n            coding: [\n              {\n                system: \"http://www.ama-assn.org/go/cpt\",\n                display: \"CARLINGSBAD FAMILY MEDICINE\",\n              },\n              {\n                system: \"urn:oid:2.16.840.1.113883.4.391.142\",\n                display: \"(TEL)\",\n              },\n            ],\n            text: \"CARLINGSBAD FAMILY MEDICINE\",\n          },\n        ],\n        subject: {\n          reference: \"Patient/6e6ea727-a7ac-47d0-96b8-536e1073826c\",\n          type: \"Patient\",\n        },\n        participant: [\n          {\n            type: [\n              {\n                coding: [\n                  {\n                    system:\n                      \"http://terminology.hl7.org/CodeSystem/v3-NullFlavor\",\n                    code: \"NI\",\n                    display: \"NoInformation\",\n                  },\n                ],\n                text: \"NoInformation\",\n              },\n            ],\n            individual: {\n              reference: \"Practitioner/26da410b-44d7-49ec-9827-26fc34f8aad7\",\n              type: \"Practitioner\",\n              display: \"Michael Morris, MD\",\n            },\n          },\n          {\n            individual: {\n              reference: \"Practitioner/12345\",\n              type: \"Practitioner\",\n              display: \"Jenny Morris, MD\",\n            },\n          },\n          {\n            individual: {\n              reference: \"Practitioner/12345\",\n              type: \"Practitioner\",\n              display: \"Rose Donald\",\n            },\n          },\n          {\n            individual: {\n              reference: \"Practitioner/12345\",\n              type: \"Practitioner\",\n              display: \"Al Bundy\",\n            },\n          },\n        ],\n        period: {\n          start: \"2020-03-14\",\n        },\n        location: [\n          {\n            location: {\n              reference: \"Location/02b760b4-f898-4aad-a075-0c2ba1a7d1a9\",\n              type: \"Location\",\n              display: \"CARLINGSBAD FAMILY MEDICINE\",\n            },\n          },\n        ],\n      },\n      search: {\n        mode: \"match\",\n      },\n    },\n  ],\n};\n","export const patient = {\n  resourceType: \"Bundle\",\n  id: \"f4da1f39-7638-45e4-999b-9ff33d7c5201\",\n  meta: {\n    lastUpdated: \"2022-11-15T19:37:55.783+00:00\",\n  },\n  type: \"searchset\",\n  entry: [\n    {\n      resource: {\n        resourceType: \"Patient\",\n        id: \"1\",\n        meta: {\n          extension: [\n            {\n              url: \"https://zusapi.com/created-at\",\n              valueInstant: \"2022-11-10T19:37:12.106+00:00\",\n            },\n          ],\n          versionId: \"2\",\n          lastUpdated: \"2022-11-10T19:37:12.363+00:00\",\n          source: \"#8409b0f1adee8ee2\",\n          security: [\n            {\n              system: \"http://terminology.hl7.org/CodeSystem/v3-ActReason\",\n              code: \"HTEST\",\n            },\n          ],\n          tag: [\n            {\n              system: \"https://zusapi.com/accesscontrol/owner\",\n              code: \"builder/123\",\n              display: \"Storybook Medical - Test Customer\",\n            },\n          ],\n        },\n        identifier: [\n          {\n            system: \"https://example.com/patient-id\",\n            value: \"001\",\n          },\n          {\n            system: \"https://zusapi.com/fhir/identifier/universal-id\",\n            value: \"u12345\",\n          },\n        ],\n        name: [\n          {\n            family: \"Marsden\",\n            given: [\"Penny\"],\n          },\n        ],\n        telecom: [\n          {\n            system: \"email\",\n            value: \"penny.marsden@example.com\",\n          },\n          {\n            system: \"phone\",\n            value: \"555-030-6283\",\n            use: \"home\",\n          },\n          {\n            system: \"phone\",\n            value: \"555-348-9139\",\n            use: \"mobile\",\n          },\n          {\n            system: \"phone\",\n            value: \"555-516-4894\",\n            use: \"work\",\n          },\n        ],\n        gender: \"female\",\n        birthDate: \"1980-09-03\",\n        address: [\n          {\n            line: [\"469 SHADOW LN\"],\n            city: \"LAS VEGAS\",\n            state: \"NV\",\n            postalCode: \"89106-4119\",\n          },\n        ],\n        maritalStatus: {\n          coding: [\n            {\n              system: \"http://terminology.hl7.org/CodeSystem/v3-MaritalStatus\",\n              code: \"S\",\n              display: \"Single\",\n            },\n          ],\n          text: \"Single\",\n        },\n        contact: [\n          {\n            relationship: [\n              {\n                coding: [\n                  {\n                    system: \"http://terminology.hl7.org/CodeSystem/v2-0131\",\n                    code: \"C\",\n                    display: \"Emergency contact\",\n                  },\n                ],\n                text: \"Emergency contact\",\n              },\n            ],\n            name: {\n              family: \"Marsden\",\n              given: [\"Jeffrey\"],\n            },\n            telecom: [\n              {\n                system: \"phone\",\n                value: \"555-402-8964\",\n                use: \"home\",\n              },\n              {\n                system: \"email\",\n                value: \"jeffrey.marsden@example.com\",\n              },\n            ],\n          },\n        ],\n        managingOrganization: {\n          reference: \"Organization/09ab9086-6dfc-4dc9-b040-1520aa4fea92\",\n        },\n      },\n      search: {\n        mode: \"match\",\n      },\n    },\n    {\n      resource: {\n        resourceType: \"Organization\",\n        id: \"09ab9086-6dfc-4dc9-b040-1520aa4fea92\",\n        meta: {\n          extension: [\n            {\n              url: \"https://zusapi.com/created-at\",\n              valueInstant: \"2022-11-10T19:37:09.031+00:00\",\n            },\n          ],\n          versionId: \"1\",\n          lastUpdated: \"2022-11-10T19:37:09.032+00:00\",\n          source: \"#RdK4JAWrQkSRa9Qw\",\n          tag: [\n            {\n              system: \"https://zusapi.com/accesscontrol/owner\",\n              code: \"builder/b123\",\n              display: \"Storybook Medical - Test Customer\",\n            },\n          ],\n        },\n        name: \"Demo Health\",\n      },\n      search: {\n        mode: \"include\",\n      },\n    },\n  ],\n};\n","import { rest } from \"msw\";\nimport { encounters } from \"./encounters\";\nimport { patient } from \"./patient\";\n\nexport const mockPatientGet = rest.get(\n  \"https://api.dev.zusapi.com/fhir/Patient\",\n  // Add ctx.delay(750), delay to show loading, we set this to 750ms to be\n  // less than the default testing-library timeout of 1000ms.\n  (req, res, ctx) => res(ctx.delay(750), ctx.status(200), ctx.json(patient))\n);\n\nexport const mockEncounterGet = rest.get(\n  \"https://api.dev.zusapi.com/fhir/Encounter\",\n  (req, res, ctx) => res(ctx.status(200), ctx.json(encounters))\n);\n","import type { Meta, StoryObj } from \"@storybook/react\";\nimport { PatientTimeline, PatientTimelineProps } from \"./patient-timeline\";\nimport { mockEncounterGet, mockPatientGet } from \"./story-helpers/mocks/requests\";\nimport { CTWProvider } from \"@/components/core/providers/ctw-provider\";\nimport { PatientProvider } from \"@/components/core/providers/patient-provider\";\nimport { SYSTEM_ZUS_UNIVERSAL_ID } from \"@/fhir/system-urls\";\ntype Props = PatientTimelineProps;\nexport default ({\n  component: PatientTimeline,\n  tags: [\"autodocs\"],\n  argTypes: {\n    className: {\n      options: [\"Blank\", \"Fixed Width\"],\n      control: \"select\",\n      mapping: {\n        Blank: \"\",\n        \"Fixed Width\": \"ctw-m-auto ctw-max-w-[600px]\"\n      }\n    }\n  },\n  args: {\n    className: \"Blank\",\n    readOnly: false,\n    includeViewFhirResource: false\n  },\n  decorators: [(Story, {\n    args\n  }) => <CTWProvider env=\"dev\" authToken=\"dummy-token\" builderId=\"b123\">\n        <PatientProvider patientID=\"u12345\" systemURL={SYSTEM_ZUS_UNIVERSAL_ID}>\n          <Story args={args} />\n        </PatientProvider>\n      </CTWProvider>]\n} as Meta<Props>);\nexport const Basic: StoryObj<Props> = {\n  parameters: {\n    msw: [mockPatientGet, mockEncounterGet]\n  }\n};\nBasic.parameters = {\n  ...Basic.parameters,\n  storySource: {\n    source: \"{\\n  parameters: {\\n    msw: [mockPatientGet, mockEncounterGet]\\n  }\\n}\",\n    ...Basic.parameters?.storySource\n  }\n};"],"names":["useEncounterDetailsDrawer","openDrawer","useDrawer","encounter","props","React","EncounterDetailsDrawer","className","isOpen","onClose","openCCDAModal","useCCDAModal","isLoading","setIsLoading","useState","binaryId","setBinaryId","getRequestContext","useCTW","useEffect","load","requestContext","provenances","searchProvenances","getBinaryId","Drawer","Loading","Details","encounterData","DocumentButton","capitalize","CodingList","SimpleMoreList","items","limit","total","item","index","patientTimelineColumns","includeViewFhirResource","timellineColumns","participant","p","name","_a","qualification","_b","diagnosis","d","ViewFHIR","EncounterModel","FHIRModel","display","code","diagnoses","compact","codeableConceptLabel","locations","l","participants","formatDateISOToLocal","reasons","flatten","t","codeableConcept","find","SYSTEM_ACT_CODE","coding","findCoding","usePatientEncounters","useQueryWithPatient","QUERY_KEY_PATIENT_ENCOUNTERS","patient","bundle","encounters","searchCommonRecords","setupEncounterModels","Telemetry","resources","basicsMap","getIncludedBasics","c","PatientTimeline","patientEncounterQuery","openDetails","orderBy","Table","mockPatientGet","rest","req","res","ctx","mockEncounterGet","patientTimeline_stories","Story","args","CTWProvider","PatientProvider","SYSTEM_ZUS_UNIVERSAL_ID","Basic"],"mappings":"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,EACA,CACE,OACE,qDACF,KAAM,MACN,QAAS,cACX,CACF,EACA,KAAM,cACR,CACF,EACA,WAAY,CACV,UAAW,oDACX,KAAM,eACN,QAAS,qBACX,CACF,CACF,EACA,OAAQ,CACN,MAAO,4BACP,IAAK,2BACP,EACA,OAAQ,CACN,MAAO,GACP,KAAM,SACN,OAAQ,4BACR,KAAM,KACR,EACA,UAAW,CACT,CACE,UAAW,CACT,UAAW,iDACX,KAAM,YACN,QAAS,8BACX,CACF,EACA,CACE,UAAW,CACT,UAAW,iDACX,KAAM,YACN,QAAS,oCACX,CACF,EACA,CACE,UAAW,CACT,UAAW,kBACX,KAAM,YACN,QAAS,sBACX,CACF,EACA,CACE,UAAW,CACT,UAAW,kBACX,KAAM,YACN,QAAS,WACX,CACF,CACF,EACA,SAAU,CACR,CACE,SAAU,CACR,UAAW,gDACX,KAAM,WACN,QAAS,qBACX,CACF,CACF,CACF,EACA,OAAQ,CACN,KAAM,OACR,CACF,EACA,CACE,QACE,iFACF,SAAU,CACR,aAAc,YACd,GAAI,uCACJ,KAAM,CACJ,UAAW,CACT,CACE,IAAK,gCACL,aAAc,+BAChB,CACF,EACA,UAAW,IACX,YAAa,gCACb,OAAQ,oBACR,IAAK,CACH,CACE,OAAQ,uCACR,KAAM,YACR,EACA,CACE,OAAQ,yCACR,KAAM,+CACN,QAAS,YACX,CACF,CACF,EACA,UAAW,CACT,CACE,IAAK,kDACL,YAAa,sCACf,CACF,EACA,OAAQ,WACR,MAAO,CACL,OAAQ,gCACR,KAAM,KACR,EACA,QAAS,CACP,UAAW,+CACX,KAAM,SACR,EACA,YAAa,CACX,CACE,KAAM,CACJ,CACE,OAAQ,CACN,CACE,QAAS,6BACX,EACA,CACE,OAAQ,mDACR,KAAM,KACN,QAAS,6BACX,EACA,CACE,OACE,qDACF,KAAM,KACN,QAAS,6BACX,CACF,EACA,KAAM,6BACR,CACF,EACA,WAAY,CACV,UAAW,oDACX,KAAM,eACN,QAAS,WACX,CACF,CACF,EACA,OAAQ,CACN,MAAO,4BACP,IAAK,2BACP,EACA,OAAQ,CACN,MAAO,MACP,KAAM,SACN,OAAQ,4BACR,KAAM,KACR,EACA,UAAW,CACT,CACE,UAAW,CACT,UAAW,iDACX,KAAM,YACN,QAAS,wDACX,CACF,CACF,EACA,gBAAiB,CACf,qBAAsB,CACpB,OAAQ,CACN,CACE,OAAQ,qDACR,KAAM,IACN,QAAS,mBACX,CACF,EACA,KAAM,mBACR,CACF,EACA,SAAU,CACR,CACE,SAAU,CACR,UAAW,gDACX,KAAM,WACN,QAAS,cACX,CACF,CACF,CACF,EACA,OAAQ,CACN,KAAM,OACR,CACF,EACA,CACE,QACE,iFACF,SAAU,CACR,aAAc,YACd,GAAI,uCACJ,KAAM,CACJ,UAAW,CACT,CACE,IAAK,gCACL,aAAc,+BAChB,CACF,EACA,UAAW,IACX,YAAa,gCACb,OAAQ,oBACR,IAAK,CACH,CACE,OAAQ,uCACR,KAAM,YACR,EACA,CACE,OAAQ,yCACR,KAAM,+CACN,QAAS,YACX,CACF,CACF,EACA,UAAW,CACT,CACE,IAAK,kDACL,YAAa,sCACf,CACF,EACA,OAAQ,WACR,MAAO,CACL,OAAQ,sDACR,KAAM,KACR,EACA,KAAM,CACJ,CACE,OAAQ,CACN,CACE,OAAQ,iCACR,QAAS,gBACX,EACA,CACE,OAAQ,wCACR,QAAS,OACX,CACF,EACA,KAAM,kBACR,CACF,EACA,QAAS,CACP,UAAW,+CACX,KAAM,SACR,EACA,YAAa,CACX,CACE,KAAM,CACJ,CACE,OAAQ,CACN,CACE,OACE,sDACF,KAAM,KACN,QAAS,eACX,CACF,EACA,KAAM,eACR,CACF,EACA,WAAY,CACV,UAAW,oDACX,KAAM,eACN,QAAS,aACX,CACF,CACF,EACA,OAAQ,CACN,MAAO,YACT,EACA,SAAU,CACR,CACE,SAAU,CACR,UAAW,gDACX,KAAM,WACN,QAAS,gBACX,CACF,CACF,CACF,EACA,OAAQ,CACN,KAAM,OACR,CACF,EACA,CACE,QACE,iFACF,SAAU,CACR,aAAc,YACd,GAAI,uCACJ,KAAM,CACJ,UAAW,CACT,CACE,IAAK,gCACL,aAAc,+BAChB,CACF,EACA,UAAW,IACX,YAAa,gCACb,OAAQ,oBACR,IAAK,CACH,CACE,OAAQ,uCACR,KAAM,YACR,EACA,CACE,OAAQ,yCACR,KAAM,+CACN,QAAS,YACX,CACF,CACF,EACA,UAAW,CACT,CACE,IAAK,kDACL,YAAa,sCACf,CACF,EACA,OAAQ,WACR,MAAO,CACL,OAAQ,sDACR,KAAM,KACR,EACA,QAAS,CACP,UAAW,+CACX,KAAM,SACR,EACA,OAAQ,CACN,MAAO,2BACT,EACA,UAAW,CACT,CACE,UAAW,CACT,UAAW,iDACX,KAAM,YACN,QAAS,wBACX,CACF,CACF,EACA,SAAU,CACR,CACE,SAAU,CACR,UAAW,gDACX,KAAM,WACN,QAAS,gBACX,CACF,CACF,CACF,EACA,OAAQ,CACN,KAAM,OACR,CACF,EACA,CACE,QACE,iFACF,SAAU,CACR,aAAc,YACd,GAAI,uCACJ,KAAM,CACJ,UAAW,CACT,CACE,IAAK,gCACL,aAAc,+BAChB,CACF,EACA,UAAW,IACX,YAAa,gCACb,OAAQ,oBACR,IAAK,CACH,CACE,OAAQ,uCACR,KAAM,YACR,EACA,CACE,OAAQ,yCACR,KAAM,+CACN,QAAS,YACX,CACF,CACF,EACA,UAAW,CACT,CACE,IAAK,kDACL,YAAa,sCACf,CACF,EACA,OAAQ,WACR,MAAO,CACL,OAAQ,gCACR,KAAM,MACR,EACA,KAAM,CACJ,CACE,OAAQ,CACN,CACE,OAAQ,gCACR,KAAM,OACN,QAAS,WACX,EACA,CACE,OAAQ,kDACR,KAAM,GACR,EACA,CACE,OAAQ,mCACR,KAAM,GACR,EACA,CACE,OAAQ,qCACR,KAAM,GACR,CACF,EACA,KAAM,WACR,CACF,EACA,QAAS,CACP,UAAW,+CACX,KAAM,SACR,EACA,YAAa,CACX,CACE,KAAM,CACJ,CACE,OAAQ,CACN,CACE,QAAS,oBACX,EACA,CACE,OAAQ,mDACR,KAAM,KACN,QAAS,oBACX,EACA,CACE,OACE,qDACF,KAAM,KACN,QAAS,oBACX,CACF,EACA,KAAM,oBACR,CACF,EACA,WAAY,CACV,UAAW,oDACX,KAAM,eACN,QAAS,eACX,CACF,CACF,EACA,OAAQ,CACN,MAAO,4BACP,IAAK,2BACP,EACA,OAAQ,CACN,MAAO,GACP,KAAM,SACN,OAAQ,4BACR,KAAM,KACR,EACA,WAAY,CACV,CACE,OAAQ,CACN,CACE,OAAQ,yBACR,KAAM,YACN,QAAS,4BACX,CACF,EACA,KAAM,kBACR,CACF,EACA,UAAW,CACT,CACE,UAAW,CACT,UAAW,iDACX,KAAM,YACN,QAAS,YACX,CACF,CACF,EACA,gBAAiB,CACf,qBAAsB,CACpB,OAAQ,CACN,CACE,OAAQ,qDACR,KAAM,KACN,QAAS,qDACX,CACF,EACA,KAAM,qDACR,CACF,EACA,SAAU,CACR,CACE,SAAU,CACR,UAAW,gDACX,KAAM,WACN,QAAS,2BACX,CACF,CACF,CACF,EACA,OAAQ,CACN,KAAM,OACR,CACF,EACA,CACE,QACE,iFACF,SAAU,CACR,aAAc,YACd,GAAI,uCACJ,KAAM,CACJ,UAAW,CACT,CACE,IAAK,gCACL,aAAc,+BAChB,CACF,EACA,UAAW,IACX,YAAa,gCACb,OAAQ,oBACR,IAAK,CACH,CACE,OAAQ,uCACR,KAAM,YACR,EACA,CACE,OAAQ,yCACR,KAAM,+CACN,QAAS,YACX,CACF,CACF,EACA,UAAW,CACT,CACE,IAAK,kDACL,YAAa,sCACf,CACF,EACA,OAAQ,WACR,MAAO,CACL,OAAQ,sDACR,KAAM,KACR,EACA,KAAM,CACJ,CACE,OAAQ,CACN,CACE,OAAQ,iCACR,QAAS,6BACX,EACA,CACE,OAAQ,sCACR,QAAS,OACX,CACF,EACA,KAAM,6BACR,CACF,EACA,QAAS,CACP,UAAW,+CACX,KAAM,SACR,EACA,YAAa,CACX,CACE,KAAM,CACJ,CACE,OAAQ,CACN,CACE,OACE,sDACF,KAAM,KACN,QAAS,eACX,CACF,EACA,KAAM,eACR,CACF,EACA,WAAY,CACV,UAAW,oDACX,KAAM,eACN,QAAS,oBACX,CACF,EACA,CACE,WAAY,CACV,UAAW,qBACX,KAAM,eACN,QAAS,kBACX,CACF,EACA,CACE,WAAY,CACV,UAAW,qBACX,KAAM,eACN,QAAS,aACX,CACF,EACA,CACE,WAAY,CACV,UAAW,qBACX,KAAM,eACN,QAAS,UACX,CACF,CACF,EACA,OAAQ,CACN,MAAO,YACT,EACA,SAAU,CACR,CACE,SAAU,CACR,UAAW,gDACX,KAAM,WACN,QAAS,6BACX,CACF,CACF,CACF,EACA,OAAQ,CACN,KAAM,OACR,CACF,CACF,CACF,EC5sBaF,GAAU,CACrB,aAAc,SACd,GAAI,uCACJ,KAAM,CACJ,YAAa,+BACf,EACA,KAAM,YACN,MAAO,CACL,CACE,SAAU,CACR,aAAc,UACd,GAAI,IACJ,KAAM,CACJ,UAAW,CACT,CACE,IAAK,gCACL,aAAc,+BAChB,CACF,EACA,UAAW,IACX,YAAa,gCACb,OAAQ,oBACR,SAAU,CACR,CACE,OAAQ,qDACR,KAAM,OACR,CACF,EACA,IAAK,CACH,CACE,OAAQ,yCACR,KAAM,cACN,QAAS,mCACX,CACF,CACF,EACA,WAAY,CACV,CACE,OAAQ,iCACR,MAAO,KACT,EACA,CACE,OAAQ,kDACR,MAAO,QACT,CACF,EACA,KAAM,CACJ,CACE,OAAQ,UACR,MAAO,CAAC,OAAO,CACjB,CACF,EACA,QAAS,CACP,CACE,OAAQ,QACR,MAAO,2BACT,EACA,CACE,OAAQ,QACR,MAAO,eACP,IAAK,MACP,EACA,CACE,OAAQ,QACR,MAAO,eACP,IAAK,QACP,EACA,CACE,OAAQ,QACR,MAAO,eACP,IAAK,MACP,CACF,EACA,OAAQ,SACR,UAAW,aACX,QAAS,CACP,CACE,KAAM,CAAC,eAAe,EACtB,KAAM,YACN,MAAO,KACP,WAAY,YACd,CACF,EACA,cAAe,CACb,OAAQ,CACN,CACE,OAAQ,yDACR,KAAM,IACN,QAAS,QACX,CACF,EACA,KAAM,QACR,EACA,QAAS,CACP,CACE,aAAc,CACZ,CACE,OAAQ,CACN,CACE,OAAQ,gDACR,KAAM,IACN,QAAS,mBACX,CACF,EACA,KAAM,mBACR,CACF,EACA,KAAM,CACJ,OAAQ,UACR,MAAO,CAAC,SAAS,CACnB,EACA,QAAS,CACP,CACE,OAAQ,QACR,MAAO,eACP,IAAK,MACP,EACA,CACE,OAAQ,QACR,MAAO,6BACT,CACF,CACF,CACF,EACA,qBAAsB,CACpB,UAAW,mDACb,CACF,EACA,OAAQ,CACN,KAAM,OACR,CACF,EACA,CACE,SAAU,CACR,aAAc,eACd,GAAI,uCACJ,KAAM,CACJ,UAAW,CACT,CACE,IAAK,gCACL,aAAc,+BAChB,CACF,EACA,UAAW,IACX,YAAa,gCACb,OAAQ,oBACR,IAAK,CACH,CACE,OAAQ,yCACR,KAAM,eACN,QAAS,mCACX,CACF,CACF,EACA,KAAM,aACR,EACA,OAAQ,CACN,KAAM,SACR,CACF,CACF,CACF,EC7Jae,GAAiBC,EAAK,KAAA,IACjC,0CAGA,CAACC,EAAKC,EAAKC,IAAQD,EAAIC,EAAI,MAAM,GAAG,EAAGA,EAAI,OAAO,GAAG,EAAGA,EAAI,KAAKnB,EAAO,CAAC,CAC3E,EAEaoB,GAAmBJ,EAAK,KAAA,IACnC,4CACA,CAACC,EAAKC,EAAKC,IAAQD,EAAIC,EAAI,OAAO,GAAG,EAAGA,EAAI,KAAKjB,EAAU,CAAC,CAC9D,ECPgBmB,GAAA,CACd,UAAWX,EACX,KAAM,CAAC,UAAU,EACjB,SAAU,CACR,UAAW,CACT,QAAS,CAAC,QAAS,aAAa,EAChC,QAAS,SACT,QAAS,CACP,MAAO,GACP,cAAe,8BACjB,CACF,CACF,EACA,KAAM,CACJ,UAAW,QACX,SAAU,GACV,wBAAyB,EAC3B,EACA,WAAY,CAAC,CAACY,EAAO,CACnB,KAAAC,CACF,oBAAOC,EAAY,CAAA,IAAI,MAAM,UAAU,cAAc,UAAU,MACzD,EAAA3F,EAAA,cAAC4F,GAAgB,UAAU,SAAS,UAAWC,CAC7C,EAAA7F,EAAA,cAACyF,GAAM,KAAAC,CAAY,CAAA,CACrB,CACF,CAAc,CACpB,EACaI,EAAyB,CACpC,WAAY,CACV,IAAK,CAACZ,GAAgBK,EAAgB,CACxC,CACF,QACAO,EAAM,WAAa,CACjB,GAAGA,EAAM,WACT,YAAa,CACX,OAAQ;AAAA;AAAA;AAAA;AAAA,GACR,IAAGvD,EAAAuD,EAAM,aAAN,YAAAvD,EAAkB,WACvB,CACF"}