import{R as t,r as w}from"./index-6f814c40.js";import{c as M}from"./index-74f03c09.js";import{h as j,P as $,i as J,j as K,t as X,u as ee,f as te,s as W,d as ne,p as ae,e as R}from"./requests-e0cbd5d6.js";import{u as Z,P as oe}from"./use-patient-history-23b093b7.js";import{aa as ie,ab as se,u as re,ac as ce,ad as de,k as z,ae as le,w as pe,h as ue,j as me,C as ye,a as Ce,S as fe}from"./patient-allergies-39713952.js";import{C as he,c as v,T as we}from"./table-c51c6e51.js";import"./_baseToString-7c0e3f59.js";import"./_baseClone-17ec433b.js";import"./sortBy-a390368e.js";import{b as ve}from"./_equalByTag-eda72788.js";import"./_baseForOwn-7324d3a8.js";import"./_createSet-6ff8e1d4.js";import{u as N}from"./uniq-8676ca12.js";import"./action-list-bc3500ad.js";import"./drawer-3c02213f.js";import"./spinner-66aa4ba7.js";import"./request-5d5ec5f4.js";import"./_commonjsHelpers-042e6b4d.js";import"./_basePickBy-fa3aec3b.js";import"./_baseIsEqual-7d59e24c.js";import"./modal-ccda-5d417565.js";import"./isEqual-298b6ab1.js";import"./coding-list-1d7c950f.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./mapValues-13598fe6.js";import"./data-list-254aa0b0.js";import"./extends-b0154772.js";import"./isString-933c0e0c.js";import"./debounce-5029c56d.js";import"./toNumber-d7ce3bd9.js";import"./index-6de6b113.js";import"./isPlainObject-f51be120.js";function b({hideAdd:e,sortOptions:n,updateSorts:a,activeCollection:o,currentSorts:i,filterItems:c,setFilters:s,filters:r}){const l=j(),p=Z();return t.createElement("div",{className:"ctw-flex ctw-flex-wrap ctw-items-center ctw-justify-between ctw-py-3 sm:ctw-pt-1.5"},t.createElement("div",{className:"ctw-flex ctw-flex-wrap ctw-gap-x-2"},t.createElement(_e,{options:n,updateSorts:a,activeCollection:o,currentSorts:i}),t.createElement(ie,{filters:c,handleOnChange:s,defaultState:r})),p.lastRetrievedAt&&e&&t.createElement($,{patientHistory:p,message:"Last Retrieved"}),!e&&t.createElement("button",{type:"button",className:"ctw-btn-primary ctw-p-0",onClick:()=>l()},"Add Condition"))}const _e=({options:e,updateSorts:n,activeCollection:a,currentSorts:o})=>t.createElement(se,{type:"select",buttonClassName:"ctw-bg-transparent ctw-border-none ctw-p-0",onItemSelect:i=>{const{dir:c,key:s,isDate:r}=e.filter(l=>l.display===i.key)[0].payload;n({[a]:{key:s,dir:c,isDate:r,display:i.name}})},items:e.map(i=>({key:i.display,name:i.display,isSelected:o.display===i.display}))},t.createElement("div",{className:"ctw-btn-default ctw-flex ctw-items-center ctw-space-x-1"},t.createElement("span",null,"Sort"),t.createElement(he,{className:"ctw-h-4"})));try{b.displayName="PatientConditionsActions",b.__docgenInfo={description:"",displayName:"PatientConditionsActions",props:{hideAdd:{defaultValue:null,description:"",name:"hideAdd",required:!0,type:{name:"boolean"}},sortOptions:{defaultValue:null,description:"",name:"sortOptions",required:!0,type:{name:"SortOption[]"}},updateSorts:{defaultValue:null,description:"",name:"updateSorts",required:!0,type:{name:"(newSorts: Partial<Sort>) => void"}},activeCollection:{defaultValue:null,description:"",name:"activeCollection",required:!0,type:{name:"enum",value:[{value:'"patient"'},{value:'"other"'}]}},currentSorts:{defaultValue:null,description:"",name:"currentSorts",required:!0,type:{name:"Sort"}},filterItems:{defaultValue:null,description:"",name:"filterItems",required:!0,type:{name:"FilterItem[]"}},setFilters:{defaultValue:null,description:"",name:"setFilters",required:!0,type:{name:"(filterChangeEvent: FilterChangeEvent) => void"}},filters:{defaultValue:null,description:"",name:"filters",required:!0,type:{name:"FilterChangeEvent"}}}}}catch{}function ge(e){switch(e){case"Active":return"ctw-text-success-main";case"Pending":return"ctw-text-caution-main";default:return"ctw-text-content-lighter"}}const Se=[{widthPercent:30,minWidth:320,render:e=>t.createElement("div",null,t.createElement("div",{className:"ctw-pc-title group-hover:ctw-underline"},e.display),t.createElement("div",{className:"ctw-pc-chapter"},e.ccsChapter))},{render:e=>{var n,a;return t.createElement("div",{className:"ctw-pc-status-container"},t.createElement("div",{className:M("ctw-pc-status-dot",ge(e.displayStatus))},"â€¢"),t.createElement("div",{className:"ctw-pc-status-and-extra"},t.createElement("div",{className:"ctw-pc-status"},e.displayStatus),e.isSummaryResource?t.createElement("div",null,v([(a=(n=e.patient)==null?void 0:n.organization)==null?void 0:a.name,e.recordedDate]).join(" ")):t.createElement("div",null,v([e.recorder,e.recordedDate]).join(" "))))},widthPercent:30,minWidth:128},{widthPercent:40,minWidth:132,render:e=>{const n=e.isSummaryResource?"Earliest known onset:":"Onset:";return t.createElement("div",{className:"ctw-pc-onset-notes"},e.onset&&t.createElement("div",null,n," ",e.onset),t.createElement("div",{className:"ctw-pc-notes"},e.notes.join(" ")))}}],Ee={patient:{displayStatus:{key:"displayStatus",selected:["Active","Pending","Unknown"],type:"checkbox"}},other:{displayStatus:{key:"displayStatus",selected:["Active","Pending","Unknown"],type:"checkbox"}}};function k(e){const[n,a]=w.useState({...Ee});function o(s){a(()=>({...n,[e]:{...s}}))}function i(s){return[{key:"displayStatus",type:"checkbox",icon:"eye",display:()=>"Status",values:N(s.map(r=>r.displayStatus))},{key:"ccsChapter",type:"checkbox",icon:"eye",display:()=>"Category",values:v(N(s.map(r=>r.ccsChapter)))}]}function c(s,r){const l=e==="patient"?s:r;return l.filter(p=>Object.entries(n[e]).every(([O,d])=>{if((d==null?void 0:d.type)==="checkbox"&&ve(d.selected)){const u=d.selected.filter(_=>v(N(l.map(C=>C[d.key]))).includes(_)),y=p[d.key]??"";return u.length<1||u.includes(String(y))}return!0}))}return{filters:n,updateFilters:o,applyFilters:c,availableFilters:i}}try{k.displayName="useConditionFilters",k.__docgenInfo={description:"",displayName:"useConditionFilters",props:{}}}catch{}const P=({record:e})=>{const n=J(),a=K();return t.createElement("div",{className:"ctw-flex ctw-space-x-2"},!e.isDeleted&&t.createElement("button",{type:"button",className:"ctw-btn-default",onClick:o=>{o.stopPropagation(),a(e)}},"Remove"),t.createElement("button",{type:"button",className:"ctw-btn-primary",onClick:o=>{o.stopPropagation(),n(e)}},"Edit"))},A=({record:e})=>{const n=j(),{getRequestContext:a}=re();return t.createElement("div",{className:"ctw-flex ctw-space-x-2"},t.createElement("button",{type:"button",className:"ctw-btn-default",onClick:async o=>{o.stopPropagation(),await X(e,await a())}},e.isArchived?"Restore":"Dismiss"),t.createElement("button",{type:"button",className:"ctw-btn-primary",onClick:o=>{o.stopPropagation(),n(e)}},"Add"))};try{P.displayName="PatientConditionHoverActions",P.__docgenInfo={description:"",displayName:"PatientConditionHoverActions",props:{record:{defaultValue:null,description:"",name:"record",required:!0,type:{name:"ConditionModel"}}}}}catch{}try{A.displayName="OtherProviderConditionHoverActions",A.__docgenInfo={description:"",displayName:"OtherProviderConditionHoverActions",props:{record:{defaultValue:null,description:"",name:"record",required:!0,type:{name:"ConditionModel"}}}}}catch{}const q={key:"recordedDate",dir:"desc",display:"Last Updated Date (Newest to Oldest)"},Ne={patient:{...q},other:{...q}},be=[{display:"Name (A-Z)",payload:{key:"display",dir:"asc"}},{display:"Name (Z-A)",payload:{key:"display",dir:"desc"}},{display:"Category (A-Z)",payload:{key:"ccsChapter",dir:"asc"}},{display:"Category (Z-A)",payload:{key:"ccsChapter",dir:"desc"}},{display:"Status (A-Z)",payload:{key:"displayStatus",dir:"asc"}},{display:"Status (Z-A)",payload:{key:"displayStatus",dir:"desc"}},{display:"Last Updated Date (Oldest to Newest)",payload:{key:"recordedDate",dir:"asc",isDate:!0}},{display:"Last Updated Date (Newest to Oldest)",payload:{key:"recordedDate",dir:"desc",isDate:!0}}];function x(e){const[n,a]=w.useState(Ne);function o(c){a({...n,...c})}function i(c){const s=n[e];return ce(c,r=>r[s.key],s.dir,s.isDate)}return{applySorts:i,sortOptions:be,updateSorts:o,currentSorts:n}}try{x.displayName="useConditionSorts",x.__docgenInfo={description:"",displayName:"useConditionSorts",props:{}}}catch{}const ke=[{key:"inactive-provider-records",getPanelClassName:e=>e?"ctw-mt-0":"ctw-mt-2",display:()=>"condition list",render:()=>null},{key:"other-provider-records",display:()=>t.createElement(t.Fragment,null,t.createElement("span",{className:"ctw-pr-2 ctw-capitalize"},"other provider records"),t.createElement(Pe,null)),render:()=>null}];function F({collection:e,onCollectionChange:n,forceHorizontalTabs:a=!1}){const o=Z();return t.createElement(t.Fragment,null,e==="other"&&t.createElement("div",{className:"ctw-space-y-3"},t.createElement(oe,{status:o.lastStatus,date:o.dateCreatedAt})),t.createElement(de,{content:ke,forceHorizontalTabs:a,onChange:i=>{n(i===0?"patient":"other")}}))}const Pe=()=>{const e=z();if(!e.data)return null;const n=e.data.filter(a=>a.displayStatus==="Active");return n.length>0?t.createElement(le,{color:"notification",text:n.length.toString(),className:"ctw-h-5"}):null};try{F.displayName="PatientConditionsTabs",F.__docgenInfo={description:"",displayName:"PatientConditionsTabs",props:{collection:{defaultValue:null,description:"",name:"collection",required:!0,type:{name:"enum",value:[{value:'"patient"'},{value:'"other"'}]}},forceHorizontalTabs:{defaultValue:{value:"false"},description:"",name:"forceHorizontalTabs",required:!1,type:{name:"boolean"}},onCollectionChange:{defaultValue:null,description:"",name:"onCollectionChange",required:!0,type:{name:"(collection: FilterCollection) => void"}},otherConditions:{defaultValue:null,description:"",name:"otherConditions",required:!0,type:{name:"ConditionModel[]"}}}}}catch{}const T=pe(({className:e,readOnly:n=!1})=>{const[a,o]=w.useState("patient"),{filters:i,updateFilters:c,applyFilters:s,availableFilters:r}=k(a),{applySorts:l,sortOptions:p,updateSorts:O,currentSorts:d}=x(a),u=w.useRef(null),y=ue(u),_=ee(),C=me(),D=z();function Q(){const m=C.isLoading,Y=m||D.isLoading;return a==="patient"?m:Y}const g=C.data??[],S=te(D.data??[],g,!0);let E=s(g,S);E=l(E);const G=a==="patient"?P:A;return t.createElement("div",{ref:u,className:M("ctw-patient-resource-component ctw-patient-conditions ctw-items-center ctw-justify-between ctw-py-5",e,{"ctw-patient-conditions-stacked":y.sm})},t.createElement(F,{forceHorizontalTabs:!0,otherConditions:S,collection:a,onCollectionChange:o}),t.createElement(b,{sortOptions:p,updateSorts:O,activeCollection:a,hideAdd:n||a==="other",currentSorts:d[a],filterItems:r(a==="patient"?g:S),setFilters:c,filters:i[a]}),t.createElement(we,{stacked:y.sm,removeLeftAndRightBorders:!0,className:"-ctw-mx-px !ctw-rounded-none",showTableHead:!1,emptyMessage:"There are no condition records available.",isLoading:Q(),records:E,RowActions:n?void 0:G,columns:Se,handleRowClick:m=>_({condition:m,readOnly:n||m.isSummaryResource})}))},"PatientConditions");try{T.displayName="PatientConditions",T.__docgenInfo={description:"",displayName:"PatientConditions",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},readOnly:{defaultValue:null,description:"",name:"readOnly",required:!1,type:{name:"boolean"}}}}}catch{}const st={component:T,tags:["autodocs"],argTypes:{className:{options:["Blank","Fixed Width"],control:"select",mapping:{Blank:"","Fixed Width":"ctw-m-auto ctw-max-w-[600px]"}}},args:{className:"Blank",readOnly:!1},decorators:[(e,{args:n})=>t.createElement(ye,{env:"dev",authToken:"dummy-token",builderId:"b123"},t.createElement(Ce,{patientID:"u12345",systemURL:fe},t.createElement(e,{args:n})))]},f={...W({otherConditions:ne,patientConditions:ae})},h={...W({otherConditions:R,patientConditions:R})};var H,L,V;f.parameters={...f.parameters,docs:{...(H=f.parameters)==null?void 0:H.docs,source:{originalSource:`{
  ...setupConditionMocks({
    otherConditions,
    patientConditions
  })
}`,...(V=(L=f.parameters)==null?void 0:L.docs)==null?void 0:V.source}}};var B,U,I;h.parameters={...h.parameters,docs:{...(B=h.parameters)==null?void 0:B.docs,source:{originalSource:`{
  ...setupConditionMocks({
    otherConditions: emptyConditions,
    patientConditions: emptyConditions
  })
}`,...(I=(U=h.parameters)==null?void 0:U.docs)==null?void 0:I.source}}};const rt=["Basic","Empty"];export{f as Basic,h as Empty,rt as __namedExportsOrder,st as default};
//# sourceMappingURL=patient-conditions.stories-e1d1daf9.js.map
