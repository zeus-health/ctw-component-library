import{R as t,r as y}from"./index-6f814c40.js";import{c as C}from"./index-74f03c09.js";import{h as V,P as z,i as G,j as Y,t as J,u as K,f as X,s as M,d as ee,p as te,e as T}from"./requests-dd273768.js";import{u as B,P as ne}from"./use-patient-history-10cb8cbb.js";import{aa as oe,ab as ae,u as ie,ac as se,ad as p,ae as re,w as ce,h as de,j as le,k as pe,C as me,a as ue,S as ye}from"./patient-allergies-224b625c.js";import{C as Ce,c as H,m as we,T as fe}from"./table-7af9cd9b.js";import"./_baseToString-7c0e3f59.js";import"./_baseClone-17ec433b.js";import"./sortBy-a390368e.js";import"./_equalByTag-eda72788.js";import"./_baseForOwn-7324d3a8.js";import"./_createSet-6ff8e1d4.js";import{c as he}from"./_basePickBy-fa3aec3b.js";import"./action-list-10cc950e.js";import"./drawer-39fcad7e.js";import"./spinner-66aa4ba7.js";import"./request-6a310bae.js";import"./_commonjsHelpers-042e6b4d.js";import"./modal-ccda-2e1ee7d1.js";import"./isEqual-298b6ab1.js";import"./_baseIsEqual-7d59e24c.js";import"./coding-list-1d7c950f.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./mapValues-13598fe6.js";import"./uniq-8676ca12.js";import"./data-list-254aa0b0.js";import"./extends-b0154772.js";import"./isString-933c0e0c.js";import"./debounce-5029c56d.js";import"./toNumber-d7ce3bd9.js";import"./index-6de6b113.js";import"./isPlainObject-f51be120.js";function f({hideAdd:e,onToggleShowHistoric:n,sortOptions:o,updateSorts:a,activeCollection:i,currentSorts:s}){const c=V(),d=B();return t.createElement("div",{className:"ctw-flex ctw-items-center  ctw-justify-between ctw-space-x-2 ctw-p-3"},d.lastRetrievedAt&&e&&t.createElement(z,{patientHistory:d,message:"Last Retrieved"}),t.createElement("div",null,t.createElement(ve,{options:o,updateSorts:a,activeCollection:i,currentSorts:s})),t.createElement("div",{className:"ctw-flex ctw-items-center ctw-space-x-2"},t.createElement(oe,{name:"historic",text:"Historic",onChange:n}),!e&&t.createElement("button",{type:"button",className:"ctw-btn-primary",onClick:()=>c()},"Add Condition")))}const ve=({options:e,updateSorts:n,activeCollection:o,currentSorts:a})=>t.createElement(ae,{type:"select",onItemSelect:i=>{const{dir:s,key:c,isDate:d}=e.filter(r=>r.display===i.key)[0].payload;n({[o]:{key:c,dir:s,isDate:d,display:i.name}})},items:e.map(i=>({key:i.display,name:i.display,isSelected:a.display===i.display}))},t.createElement("div",{className:"ctw-btn-default ctw-flex ctw-items-center ctw-space-x-1"},t.createElement("span",null,"Sort"),t.createElement(Ce,{className:"ctw-h-4"})));try{f.displayName="PatientConditionsActions",f.__docgenInfo={description:"",displayName:"PatientConditionsActions",props:{hideAdd:{defaultValue:null,description:"",name:"hideAdd",required:!0,type:{name:"boolean"}},onToggleShowHistoric:{defaultValue:null,description:"",name:"onToggleShowHistoric",required:!0,type:{name:"() => void"}},sortOptions:{defaultValue:null,description:"",name:"sortOptions",required:!0,type:{name:"SortOption[]"}},updateSorts:{defaultValue:null,description:"",name:"updateSorts",required:!0,type:{name:"(newSorts: Partial<Sort>) => void"}},activeCollection:{defaultValue:null,description:"",name:"activeCollection",required:!0,type:{name:"enum",value:[{value:'"patient"'},{value:'"other"'}]}},currentSorts:{defaultValue:null,description:"",name:"currentSorts",required:!0,type:{name:"Sort"}}}}}catch{}function _e(e){switch(e){case"Active":return"ctw-text-success-main";case"Pending":return"ctw-text-caution-main";default:return"ctw-text-content-lighter"}}const Ee=[{widthPercent:30,minWidth:320,render:e=>t.createElement("div",null,t.createElement("div",{className:"ctw-pc-title group-hover:ctw-underline"},e.display),t.createElement("div",{className:"ctw-pc-chapter"},e.ccsChapter))},{render:e=>{var n,o;return t.createElement("div",{className:"ctw-pc-status-container"},t.createElement("div",{className:C("ctw-pc-status-dot",_e(e.displayStatus))},"â€¢"),t.createElement("div",{className:"ctw-pc-status-and-extra"},t.createElement("div",{className:"ctw-pc-status"},e.displayStatus),e.isSummaryResource?t.createElement("div",null,H([(o=(n=e.patient)==null?void 0:n.organization)==null?void 0:o.name,e.recordedDate]).join(" ")):t.createElement("div",null,H([e.recorder,e.recordedDate]).join(" "))))},widthPercent:30,minWidth:128},{widthPercent:40,minWidth:132,render:e=>{const n=e.isSummaryResource?"Earliest known onset:":"Onset:";return t.createElement("div",{className:"ctw-pc-onset-notes"},e.onset&&t.createElement("div",null,n," ",e.onset),t.createElement("div",{className:"ctw-pc-notes"},e.notes.join(" ")))}}];function h(e){const[n,o]=y.useState({showHistoric:!1});function a(s){o(we(he(n),s))}function i(s,c){return(e==="patient"?s:c).filter(r=>n.showHistoric?!0:["Active","Pending"].includes(r.displayStatus))}return{filters:n,updateFilters:a,applyFilters:i}}try{h.displayName="useConditionFilters",h.__docgenInfo={description:"",displayName:"useConditionFilters",props:{}}}catch{}const v=({record:e})=>{const n=G(),o=Y();return t.createElement("div",{className:"ctw-flex ctw-space-x-2"},!e.isDeleted&&t.createElement("button",{type:"button",className:"ctw-btn-default",onClick:a=>{a.stopPropagation(),o(e)}},"Remove"),t.createElement("button",{type:"button",className:"ctw-btn-primary",onClick:a=>{a.stopPropagation(),n(e)}},"Edit"))},_=({record:e})=>{const n=V(),{getRequestContext:o}=ie();return t.createElement("div",{className:"ctw-flex ctw-space-x-2"},t.createElement("button",{type:"button",className:"ctw-btn-default",onClick:async a=>{a.stopPropagation(),await J(e,await o())}},e.isArchived?"Restore":"Dismiss"),t.createElement("button",{type:"button",className:"ctw-btn-primary",onClick:a=>{a.stopPropagation(),n(e)}},"Add"))};try{v.displayName="PatientConditionHoverActions",v.__docgenInfo={description:"",displayName:"PatientConditionHoverActions",props:{record:{defaultValue:null,description:"",name:"record",required:!0,type:{name:"ConditionModel"}}}}}catch{}try{_.displayName="OtherProviderConditionHoverActions",_.__docgenInfo={description:"",displayName:"OtherProviderConditionHoverActions",props:{record:{defaultValue:null,description:"",name:"record",required:!0,type:{name:"ConditionModel"}}}}}catch{}const O={key:"recordedDate",dir:"desc",display:"Last Updated Date (Newest to Oldest)"},ge={patient:{...O},other:{...O}},Se=[{display:"Name (A-Z)",payload:{key:"display",dir:"asc"}},{display:"Name (Z-A)",payload:{key:"display",dir:"desc"}},{display:"Category (A-Z)",payload:{key:"ccsChapter",dir:"asc"}},{display:"Category (Z-A)",payload:{key:"ccsChapter",dir:"desc"}},{display:"Status (A-Z)",payload:{key:"displayStatus",dir:"asc"}},{display:"Status (Z-A)",payload:{key:"displayStatus",dir:"desc"}},{display:"Last Updated Date (Oldest to Newest)",payload:{key:"recordedDate",dir:"asc",isDate:!0}},{display:"Last Updated Date (Newest to Oldest)",payload:{key:"recordedDate",dir:"desc",isDate:!0}}];function E(e){const[n,o]=y.useState(ge);function a(s){o({...n,...s})}function i(s){const c=n[e];return se(s,d=>d[c.key],c.dir,c.isDate)}return{applySorts:i,sortOptions:Se,updateSorts:a,currentSorts:n}}try{E.displayName="useConditionSorts",E.__docgenInfo={description:"",displayName:"useConditionSorts",props:{}}}catch{}function g({collection:e,otherConditions:n,onCollectionChange:o}){function a(r){return e===r?"ctw-text-content-black":"ctw-text-content-light"}const i=n.filter(r=>r.displayStatus==="Active").length;function s(){typeof document<"u"&&requestAnimationFrame(()=>{document.activeElement instanceof HTMLElement&&document.activeElement.blur()})}const c="ctw-relative ctw-tab-underline ctw-tab",d=B();return t.createElement("div",{className:"ctw-justify-end ctw-space-x-2 ctw-border-0 ctw-border-b ctw-border-t ctw-border-solid ctw-border-divider-light"},e==="other"&&t.createElement("div",{className:"ctw-space-y-3"},t.createElement(ne,{status:d.lastStatus,date:d.dateCreatedAt})),t.createElement("div",{className:"ctw-space-x-4"},t.createElement(p.Group,{onChange:r=>{o(r===0?"patient":"other")}},t.createElement(p.List,{className:"ctw-mt-3"},t.createElement(p,{onClick:s,className:({selected:r})=>C(a("patient"),c,{"ctw-tab-underline-selected":r})},"Condition List"),t.createElement(p,{onClick:s,className:({selected:r})=>C(a("other"),c,"ctw-space-x-2",{"ctw-tab-underline-selected":r})},t.createElement("span",null,"Other Provider Records"),t.createElement(re,{text:`${i}`,color:"notification"}))))))}try{g.displayName="PatientConditionsTabs",g.__docgenInfo={description:"",displayName:"PatientConditionsTabs",props:{collection:{defaultValue:null,description:"",name:"collection",required:!0,type:{name:"enum",value:[{value:'"patient"'},{value:'"other"'}]}},otherConditions:{defaultValue:null,description:"",name:"otherConditions",required:!0,type:{name:"ConditionModel[]"}},onCollectionChange:{defaultValue:null,description:"",name:"onCollectionChange",required:!0,type:{name:"(collection: FilterCollection) => void"}}}}}catch{}const S=ce(({className:e,readOnly:n=!1})=>{const[o,a]=y.useState("patient"),{filters:i,updateFilters:s,applyFilters:c}=h(o),{applySorts:d,sortOptions:r,updateSorts:j,currentSorts:U}=E(o),N=y.useRef(null),b=de(N),W=K(),P=le(),k=pe();function Z(){const l=P.isLoading,$=l||k.isLoading;return o==="patient"?l:$}const x=P.data??[],A=X(k.data??[],x,!0);let w=c(x,A);w=d(w);const Q=o==="patient"?v:_;return t.createElement("div",{ref:N,className:C("ctw-patient-conditions",e,{"ctw-patient-conditions-stacked":b.sm})},t.createElement("div",{className:"ctw-items-center ctw-justify-between ctw-py-5"},t.createElement("div",{className:"ctw-ml-3 ctw-text-xl ctw-font-medium ctw-text-content-black"},"Conditions"),t.createElement(g,{otherConditions:A,collection:o,onCollectionChange:l=>a(l)}),t.createElement(f,{sortOptions:r,updateSorts:j,activeCollection:o,hideAdd:n||o==="other",onToggleShowHistoric:()=>s({showHistoric:!i.showHistoric}),currentSorts:U[o]}),t.createElement(fe,{stacked:b.sm,className:"-ctw-mx-px !ctw-rounded-none",showTableHead:!1,emptyMessage:"There are no condition records available.",isLoading:Z(),records:w,RowActions:n?void 0:Q,columns:Ee,handleRowClick:l=>W({condition:l,readOnly:n||l.isSummaryResource})})))},"PatientConditions");try{S.displayName="PatientConditions",S.__docgenInfo={description:"",displayName:"PatientConditions",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},readOnly:{defaultValue:null,description:"",name:"readOnly",required:!1,type:{name:"boolean"}}}}}catch{}const nt={component:S,tags:["autodocs"],argTypes:{className:{options:["Blank","Fixed Width"],control:"select",mapping:{Blank:"","Fixed Width":"ctw-m-auto ctw-max-w-[600px]"}}},args:{className:"Blank",readOnly:!1},decorators:[(e,{args:n})=>t.createElement(me,{env:"dev",authToken:"dummy-token",builderId:"b123"},t.createElement(ue,{patientID:"u12345",systemURL:ye},t.createElement(e,{args:n})))]},m={...M({otherConditions:ee,patientConditions:te})},u={...M({otherConditions:T,patientConditions:T})};var D,R,F;m.parameters={...m.parameters,docs:{...(D=m.parameters)==null?void 0:D.docs,source:{originalSource:`{
  ...setupConditionMocks({
    otherConditions,
    patientConditions
  })
}`,...(F=(R=m.parameters)==null?void 0:R.docs)==null?void 0:F.source}}};var L,q,I;u.parameters={...u.parameters,docs:{...(L=u.parameters)==null?void 0:L.docs,source:{originalSource:`{
  ...setupConditionMocks({
    otherConditions: emptyConditions,
    patientConditions: emptyConditions
  })
}`,...(I=(q=u.parameters)==null?void 0:q.docs)==null?void 0:I.source}}};const ot=["Basic","Empty"];export{m as Basic,u as Empty,ot as __namedExportsOrder,nt as default};
//# sourceMappingURL=patient-conditions.stories-c0d1063e.js.map
