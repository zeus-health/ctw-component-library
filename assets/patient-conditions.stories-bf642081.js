import{R as t,r as u}from"./index-6f814c40.js";import{c as V}from"./index-74f03c09.js";import{h as I,P as G,i as Y,j as $,t as J,u as K,f as X,s as L,d as ee,p as te,e as A}from"./requests-76a9cd71.js";import{u as B,P as oe}from"./use-patient-history-48f81c14.js";import{aa as ne,ab as ae,u as ie,ac as se,ad as re,k as M,ae as ce,w as de,h as le,j as pe,C as me,a as ue,S as ye}from"./patient-allergies-07c66348.js";import{C as Ce,c as T,a as we,T as he}from"./table-044496af.js";import"./_baseToString-7c0e3f59.js";import"./_baseClone-17ec433b.js";import"./sortBy-a390368e.js";import"./_equalByTag-eda72788.js";import"./_baseForOwn-7324d3a8.js";import"./_createSet-6ff8e1d4.js";import{c as fe}from"./_basePickBy-fa3aec3b.js";import"./action-list-52c6137b.js";import"./drawer-01910ef1.js";import"./spinner-66aa4ba7.js";import"./request-5d5ec5f4.js";import"./_commonjsHelpers-042e6b4d.js";import"./modal-ccda-4fbba731.js";import"./isEqual-298b6ab1.js";import"./_baseIsEqual-7d59e24c.js";import"./coding-list-1d7c950f.js";import"./uniq-8676ca12.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./mapValues-13598fe6.js";import"./data-list-254aa0b0.js";import"./extends-b0154772.js";import"./isString-933c0e0c.js";import"./debounce-5029c56d.js";import"./toNumber-d7ce3bd9.js";import"./index-6de6b113.js";import"./isPlainObject-f51be120.js";function C({hideAdd:e,onToggleShowHistoric:o,sortOptions:n,updateSorts:a,activeCollection:i,currentSorts:s}){const r=I(),c=B();return t.createElement("div",{className:"ctw-flex ctw-items-center ctw-justify-between ctw-space-x-2 ctw-p-3 sm:ctw-pt-1.5"},c.lastRetrievedAt&&e&&t.createElement(G,{patientHistory:c,message:"Last Retrieved"}),t.createElement("div",null,t.createElement(_e,{options:n,updateSorts:a,activeCollection:i,currentSorts:s})),t.createElement("div",{className:"ctw-flex ctw-items-center ctw-space-x-2"},t.createElement(ne,{name:"historic",text:"Historic",onChange:o}),!e&&t.createElement("button",{type:"button",className:"ctw-btn-primary",onClick:()=>r()},"Add Condition")))}const _e=({options:e,updateSorts:o,activeCollection:n,currentSorts:a})=>t.createElement(ae,{type:"select",onItemSelect:i=>{const{dir:s,key:r,isDate:c}=e.filter(d=>d.display===i.key)[0].payload;o({[n]:{key:r,dir:s,isDate:c,display:i.name}})},items:e.map(i=>({key:i.display,name:i.display,isSelected:a.display===i.display}))},t.createElement("div",{className:"ctw-btn-default ctw-flex ctw-items-center ctw-space-x-1"},t.createElement("span",null,"Sort"),t.createElement(Ce,{className:"ctw-h-4"})));try{C.displayName="PatientConditionsActions",C.__docgenInfo={description:"",displayName:"PatientConditionsActions",props:{hideAdd:{defaultValue:null,description:"",name:"hideAdd",required:!0,type:{name:"boolean"}},onToggleShowHistoric:{defaultValue:null,description:"",name:"onToggleShowHistoric",required:!0,type:{name:"() => void"}},sortOptions:{defaultValue:null,description:"",name:"sortOptions",required:!0,type:{name:"SortOption[]"}},updateSorts:{defaultValue:null,description:"",name:"updateSorts",required:!0,type:{name:"(newSorts: Partial<Sort>) => void"}},activeCollection:{defaultValue:null,description:"",name:"activeCollection",required:!0,type:{name:"enum",value:[{value:'"patient"'},{value:'"other"'}]}},currentSorts:{defaultValue:null,description:"",name:"currentSorts",required:!0,type:{name:"Sort"}}}}}catch{}function ge(e){switch(e){case"Active":return"ctw-text-success-main";case"Pending":return"ctw-text-caution-main";default:return"ctw-text-content-lighter"}}const ve=[{widthPercent:30,minWidth:320,render:e=>t.createElement("div",null,t.createElement("div",{className:"ctw-pc-title group-hover:ctw-underline"},e.display),t.createElement("div",{className:"ctw-pc-chapter"},e.ccsChapter))},{render:e=>{var o,n;return t.createElement("div",{className:"ctw-pc-status-container"},t.createElement("div",{className:V("ctw-pc-status-dot",ge(e.displayStatus))},"â€¢"),t.createElement("div",{className:"ctw-pc-status-and-extra"},t.createElement("div",{className:"ctw-pc-status"},e.displayStatus),e.isSummaryResource?t.createElement("div",null,T([(n=(o=e.patient)==null?void 0:o.organization)==null?void 0:n.name,e.recordedDate]).join(" ")):t.createElement("div",null,T([e.recorder,e.recordedDate]).join(" "))))},widthPercent:30,minWidth:128},{widthPercent:40,minWidth:132,render:e=>{const o=e.isSummaryResource?"Earliest known onset:":"Onset:";return t.createElement("div",{className:"ctw-pc-onset-notes"},e.onset&&t.createElement("div",null,o," ",e.onset),t.createElement("div",{className:"ctw-pc-notes"},e.notes.join(" ")))}}];function w(e){const[o,n]=u.useState({showHistoric:!1});function a(s){n(we(fe(o),s))}function i(s,r){return(e==="patient"?s:r).filter(d=>o.showHistoric?!0:["Active","Pending"].includes(d.displayStatus))}return{filters:o,updateFilters:a,applyFilters:i}}try{w.displayName="useConditionFilters",w.__docgenInfo={description:"",displayName:"useConditionFilters",props:{}}}catch{}const h=({record:e})=>{const o=Y(),n=$();return t.createElement("div",{className:"ctw-flex ctw-space-x-2"},!e.isDeleted&&t.createElement("button",{type:"button",className:"ctw-btn-default",onClick:a=>{a.stopPropagation(),n(e)}},"Remove"),t.createElement("button",{type:"button",className:"ctw-btn-primary",onClick:a=>{a.stopPropagation(),o(e)}},"Edit"))},f=({record:e})=>{const o=I(),{getRequestContext:n}=ie();return t.createElement("div",{className:"ctw-flex ctw-space-x-2"},t.createElement("button",{type:"button",className:"ctw-btn-default",onClick:async a=>{a.stopPropagation(),await J(e,await n())}},e.isArchived?"Restore":"Dismiss"),t.createElement("button",{type:"button",className:"ctw-btn-primary",onClick:a=>{a.stopPropagation(),o(e)}},"Add"))};try{h.displayName="PatientConditionHoverActions",h.__docgenInfo={description:"",displayName:"PatientConditionHoverActions",props:{record:{defaultValue:null,description:"",name:"record",required:!0,type:{name:"ConditionModel"}}}}}catch{}try{f.displayName="OtherProviderConditionHoverActions",f.__docgenInfo={description:"",displayName:"OtherProviderConditionHoverActions",props:{record:{defaultValue:null,description:"",name:"record",required:!0,type:{name:"ConditionModel"}}}}}catch{}const x={key:"recordedDate",dir:"desc",display:"Last Updated Date (Newest to Oldest)"},Ee={patient:{...x},other:{...x}},Se=[{display:"Name (A-Z)",payload:{key:"display",dir:"asc"}},{display:"Name (Z-A)",payload:{key:"display",dir:"desc"}},{display:"Category (A-Z)",payload:{key:"ccsChapter",dir:"asc"}},{display:"Category (Z-A)",payload:{key:"ccsChapter",dir:"desc"}},{display:"Status (A-Z)",payload:{key:"displayStatus",dir:"asc"}},{display:"Status (Z-A)",payload:{key:"displayStatus",dir:"desc"}},{display:"Last Updated Date (Oldest to Newest)",payload:{key:"recordedDate",dir:"asc",isDate:!0}},{display:"Last Updated Date (Newest to Oldest)",payload:{key:"recordedDate",dir:"desc",isDate:!0}}];function _(e){const[o,n]=u.useState(Ee);function a(s){n({...o,...s})}function i(s){const r=o[e];return se(s,c=>c[r.key],r.dir,r.isDate)}return{applySorts:i,sortOptions:Se,updateSorts:a,currentSorts:o}}try{_.displayName="useConditionSorts",_.__docgenInfo={description:"",displayName:"useConditionSorts",props:{}}}catch{}const Ne=[{key:"inactive-provider-records",getPanelClassName:e=>e?"ctw-mt-0":"ctw-mt-2",display:()=>"condition list",render:()=>null},{key:"other-provider-records",display:()=>t.createElement(t.Fragment,null,t.createElement("span",{className:"ctw-pr-2 ctw-capitalize"},"other provider records"),t.createElement(Pe,null)),render:()=>null}];function g({collection:e,onCollectionChange:o,forceHorizontalTabs:n=!1}){const a=B();return t.createElement(t.Fragment,null,e==="other"&&t.createElement("div",{className:"ctw-space-y-3"},t.createElement(oe,{status:a.lastStatus,date:a.dateCreatedAt})),t.createElement(re,{content:Ne,forceHorizontalTabs:n,onChange:i=>{o(i===0?"patient":"other")}}))}const Pe=()=>{const e=M();if(!e.data)return null;const o=e.data.filter(n=>n.displayStatus==="Active");return o.length>0?t.createElement(ce,{color:"notification",text:o.length.toString(),className:"ctw-h-5"}):null};try{g.displayName="PatientConditionsTabs",g.__docgenInfo={description:"",displayName:"PatientConditionsTabs",props:{collection:{defaultValue:null,description:"",name:"collection",required:!0,type:{name:"enum",value:[{value:'"patient"'},{value:'"other"'}]}},forceHorizontalTabs:{defaultValue:{value:"false"},description:"",name:"forceHorizontalTabs",required:!1,type:{name:"boolean"}},onCollectionChange:{defaultValue:null,description:"",name:"onCollectionChange",required:!0,type:{name:"(collection: FilterCollection) => void"}},otherConditions:{defaultValue:null,description:"",name:"otherConditions",required:!0,type:{name:"ConditionModel[]"}}}}}catch{}const v=de(({className:e,readOnly:o=!1})=>{const[n,a]=u.useState("patient"),{filters:i,updateFilters:s,applyFilters:r}=w(n),{applySorts:c,sortOptions:d,updateSorts:U,currentSorts:j}=_(n),E=u.useRef(null),S=le(E),W=K(),N=pe(),P=M();function Z(){const l=N.isLoading,Q=l||P.isLoading;return n==="patient"?l:Q}const b=N.data??[],k=X(P.data??[],b,!0);let y=r(b,k);y=c(y);const z=n==="patient"?h:f;return t.createElement("div",{ref:E,className:V("ctw-patient-conditions ctw-items-center ctw-justify-between ctw-py-5",e,{"ctw-patient-conditions-stacked":S.sm})},t.createElement(g,{forceHorizontalTabs:!0,otherConditions:k,collection:n,onCollectionChange:a}),t.createElement(C,{sortOptions:d,updateSorts:U,activeCollection:n,hideAdd:o||n==="other",onToggleShowHistoric:()=>s({showHistoric:!i.showHistoric}),currentSorts:j[n]}),t.createElement(he,{stacked:S.sm,className:"-ctw-mx-px !ctw-rounded-none",showTableHead:!1,emptyMessage:"There are no condition records available.",isLoading:Z(),records:y,RowActions:o?void 0:z,columns:ve,handleRowClick:l=>W({condition:l,readOnly:o||l.isSummaryResource})}))},"PatientConditions");try{v.displayName="PatientConditions",v.__docgenInfo={description:"",displayName:"PatientConditions",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},readOnly:{defaultValue:null,description:"",name:"readOnly",required:!1,type:{name:"boolean"}}}}}catch{}const at={component:v,tags:["autodocs"],argTypes:{className:{options:["Blank","Fixed Width"],control:"select",mapping:{Blank:"","Fixed Width":"ctw-m-auto ctw-max-w-[600px]"}}},args:{className:"Blank",readOnly:!1},decorators:[(e,{args:o})=>t.createElement(me,{env:"dev",authToken:"dummy-token",builderId:"b123"},t.createElement(ue,{patientID:"u12345",systemURL:ye},t.createElement(e,{args:o})))]},p={...L({otherConditions:ee,patientConditions:te})},m={...L({otherConditions:A,patientConditions:A})};var H,O,D;p.parameters={...p.parameters,docs:{...(H=p.parameters)==null?void 0:H.docs,source:{originalSource:`{
  ...setupConditionMocks({
    otherConditions,
    patientConditions
  })
}`,...(D=(O=p.parameters)==null?void 0:O.docs)==null?void 0:D.source}}};var F,R,q;m.parameters={...m.parameters,docs:{...(F=m.parameters)==null?void 0:F.docs,source:{originalSource:`{
  ...setupConditionMocks({
    otherConditions: emptyConditions,
    patientConditions: emptyConditions
  })
}`,...(q=(R=m.parameters)==null?void 0:R.docs)==null?void 0:q.source}}};const it=["Basic","Empty"];export{p as Basic,m as Empty,it as __namedExportsOrder,at as default};
//# sourceMappingURL=patient-conditions.stories-bf642081.js.map
