import{r as u,R as h}from"./index-6f814c40.js";import{c as me}from"./index-74f03c09.js";import"./_baseToString-ba0098b0.js";import"./sortBy-64fcb484.js";import"./_baseClone-0c3bfcab.js";import"./sortBy-3860efd7.js";import{d as fe}from"./debounce-d7732be0.js";import{e as ve}from"./_equalByTag-3aa7c076.js";import"./_baseForOwn-56487e0e.js";import{i as xe}from"./isEmpty-ee15a061.js";import"./_createSet-3c80ad01.js";import{aA as ge}from"./patient-helper-0a265332.js";import{s as Y,a as P,o as R,C as _,y as q,I as B,l as Z,m as Oe,$ as D,S as W,i as he,p as K,k as X,u as M,L as Re,q as Ce,h as ye,c as Ie,F as we,j as w,r as Se,w as Te}from"./use-watch-c090a07f.js";import{s as $e,F as Ee,a as S,x as Pe}from"./calculate-active-index-dd804c80.js";function ke(e,o){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:o},e),u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"}))}const Fe=u.forwardRef(ke),Le=Fe;function J(e,o){let[n,t]=u.useState(e),a=Y(e);return P(()=>t(a.current),[a,t,...o]),n}function ee(e={},o=null,n=[]){for(let[t,a]of Object.entries(e))oe(n,te(o,t),a);return n}function te(e,o){return e?e+"["+o+"]":o}function oe(e,o,n){if(Array.isArray(n))for(let[t,a]of n.entries())oe(e,te(o,t.toString()),a);else n instanceof Date?e.push([o,n.toISOString()]):typeof n=="boolean"?e.push([o,n?"1":"0"]):typeof n=="string"?e.push([o,n]):typeof n=="number"?e.push([o,`${n}`]):n==null?e.push([o,""]):ee(n,o,e)}function Me(e,o,n){let[t,a]=u.useState(n),i=e!==void 0;return[i?e:t,R(O=>(i||a(O),o==null?void 0:o(O)))]}var _e=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(_e||{}),De=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(De||{}),Ve=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(Ve||{}),Ae=(e=>(e[e.OpenCombobox=0]="OpenCombobox",e[e.CloseCombobox=1]="CloseCombobox",e[e.GoToOption=2]="GoToOption",e[e.RegisterOption=3]="RegisterOption",e[e.UnregisterOption=4]="UnregisterOption",e[e.RegisterLabel=5]="RegisterLabel",e))(Ae||{});function H(e,o=n=>n){let n=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,t=Te(o(e.options.slice()),i=>i.dataRef.current.domRef.current),a=n?t.indexOf(n):null;return a===-1&&(a=null),{options:t,activeOptionIndex:a}}let Ne={[1](e){return e.dataRef.current.disabled||e.comboboxState===1?e:{...e,activeOptionIndex:null,comboboxState:1}},[0](e){if(e.dataRef.current.disabled||e.comboboxState===0)return e;let o=e.activeOptionIndex,{isSelected:n}=e.dataRef.current,t=e.options.findIndex(a=>n(a.dataRef.current.value));return t!==-1&&(o=t),{...e,comboboxState:0,activeOptionIndex:o}},[2](e,o){var n;if(e.dataRef.current.disabled||e.dataRef.current.optionsRef.current&&!e.dataRef.current.optionsPropsRef.current.static&&e.comboboxState===1)return e;let t=H(e);if(t.activeOptionIndex===null){let i=t.options.findIndex(O=>!O.dataRef.current.disabled);i!==-1&&(t.activeOptionIndex=i)}let a=Pe(o,{resolveItems:()=>t.options,resolveActiveIndex:()=>t.activeOptionIndex,resolveId:i=>i.id,resolveDisabled:i=>i.dataRef.current.disabled});return{...e,...t,activeOptionIndex:a,activationTrigger:(n=o.trigger)!=null?n:1}},[3]:(e,o)=>{let n={id:o.id,dataRef:o.dataRef},t=H(e,i=>[...i,n]);e.activeOptionIndex===null&&e.dataRef.current.isSelected(o.dataRef.current.value)&&(t.activeOptionIndex=t.options.indexOf(n));let a={...e,...t,activationTrigger:1};return e.dataRef.current.__demoMode&&e.dataRef.current.value===void 0&&(a.activeOptionIndex=0),a},[4]:(e,o)=>{let n=H(e,t=>{let a=t.findIndex(i=>i.id===o.id);return a!==-1&&t.splice(a,1),t});return{...e,...n,activationTrigger:1}},[5]:(e,o)=>({...e,labelId:o.id})},G=u.createContext(null);G.displayName="ComboboxActionsContext";function j(e){let o=u.useContext(G);if(o===null){let n=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,j),n}return o}let z=u.createContext(null);z.displayName="ComboboxDataContext";function V(e){let o=u.useContext(z);if(o===null){let n=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,V),n}return o}function qe(e,o){return M(o.type,Ne,e,o)}let Be=u.Fragment;function je(e,o){let{value:n,defaultValue:t,onChange:a,name:i,by:O=(b,g)=>b===g,disabled:c=!1,__demoMode:f=!1,nullable:r=!1,multiple:s=!1,...C}=e,[v,m]=Me(n,a,t),[d,p]=u.useReducer(qe,{dataRef:u.createRef(),comboboxState:f?0:1,options:[],activeOptionIndex:null,activationTrigger:1,labelId:null}),$=u.useRef(!1),k=u.useRef({static:!1,hold:!1}),F=u.useRef(null),T=u.useRef(null),l=u.useRef(null),I=u.useRef(null),y=R(typeof O=="string"?(b,g)=>{let E=O;return(b==null?void 0:b[E])===(g==null?void 0:g[E])}:O),L=u.useCallback(b=>M(x.mode,{[1]:()=>v.some(g=>y(g,b)),[0]:()=>y(v,b)}),[v]),x=u.useMemo(()=>({...d,optionsPropsRef:k,labelRef:F,inputRef:T,buttonRef:l,optionsRef:I,value:v,disabled:c,mode:s?1:0,get activeOptionIndex(){if($.current&&d.activeOptionIndex===null&&d.options.length>0){let b=d.options.findIndex(g=>!g.dataRef.current.disabled);if(b!==-1)return b}return d.activeOptionIndex},compare:y,isSelected:L,nullable:r,__demoMode:f}),[v,c,s,r,f,d]);P(()=>{d.dataRef.current=x},[x]),Re([x.buttonRef,x.inputRef,x.optionsRef],()=>p({type:1}),x.comboboxState===0);let ne=u.useMemo(()=>({open:x.comboboxState===0,disabled:c,activeIndex:x.activeOptionIndex,activeOption:x.activeOptionIndex===null?null:x.options[x.activeOptionIndex].dataRef.current.value,value:v}),[x,c,v]),re=R(b=>{let g=x.options.find(E=>E.id===b);!g||U(g.dataRef.current.value)}),ae=R(()=>{if(x.activeOptionIndex!==null){let{dataRef:b,id:g}=x.options[x.activeOptionIndex];U(b.current.value),p({type:2,focus:S.Specific,id:g})}}),ie=R(()=>{p({type:0}),$.current=!0}),le=R(()=>{p({type:1}),$.current=!1}),ue=R((b,g,E)=>($.current=!1,b===S.Specific?p({type:2,focus:S.Specific,id:g,trigger:E}):p({type:2,focus:b,trigger:E}))),ce=R((b,g)=>(p({type:3,id:b,dataRef:g}),()=>p({type:4,id:b}))),se=R(b=>(p({type:5,id:b}),()=>p({type:5,id:null}))),U=R(b=>M(x.mode,{[0](){return m==null?void 0:m(b)},[1](){let g=x.value.slice(),E=g.findIndex(be=>y(be,b));return E===-1?g.push(b):g.splice(E,1),m==null?void 0:m(g)}})),pe=u.useMemo(()=>({onChange:U,registerOption:ce,registerLabel:se,goToOption:ue,closeCombobox:le,openCombobox:ie,selectActiveOption:ae,selectOption:re}),[]),de=o===null?{}:{ref:o};return h.createElement(G.Provider,{value:pe},h.createElement(z.Provider,{value:x},h.createElement(Ce,{value:M(x.comboboxState,{[0]:K.Open,[1]:K.Closed})},i!=null&&v!=null&&ee({[i]:v}).map(([b,g])=>h.createElement(ye,{features:Ie.Hidden,...we({key:b,as:"input",type:"hidden",hidden:!0,readOnly:!0,name:b,value:g})})),D({ourProps:de,theirProps:C,slot:ne,defaultTag:Be,name:"Combobox"}))))}let Ue=_(je),He="input",Ke=_(function(e,o){var n,t;let{value:a,onChange:i,displayValue:O,type:c="text",...f}=e,r=V("Combobox.Input"),s=j("Combobox.Input"),C=q(r.inputRef,o),v=`headlessui-combobox-input-${B()}`,m=Z(),d=u.useMemo(()=>{var l;return typeof O=="function"?(l=O(r.value))!=null?l:"":typeof r.value=="string"?r.value:""},[r.value]);Oe(([l,I],[y,L])=>{!r.inputRef.current||(L===0&&I===1||l!==y)&&(r.inputRef.current.value=l)},[d,r.comboboxState]);let p=R(l=>{switch(l.key){case w.Backspace:case w.Delete:if(r.mode!==0||!r.nullable)return;let I=l.currentTarget;m.requestAnimationFrame(()=>{I.value===""&&(s.onChange(null),r.optionsRef.current&&(r.optionsRef.current.scrollTop=0),s.goToOption(S.Nothing))});break;case w.Enter:if(r.comboboxState!==0||l.nativeEvent.isComposing)return;if(l.preventDefault(),l.stopPropagation(),r.activeOptionIndex===null){s.closeCombobox();return}s.selectActiveOption(),r.mode===0&&s.closeCombobox();break;case w.ArrowDown:return l.preventDefault(),l.stopPropagation(),M(r.comboboxState,{[0]:()=>{s.goToOption(S.Next)},[1]:()=>{s.openCombobox()}});case w.ArrowUp:return l.preventDefault(),l.stopPropagation(),M(r.comboboxState,{[0]:()=>{s.goToOption(S.Previous)},[1]:()=>{s.openCombobox(),m.nextFrame(()=>{r.value||s.goToOption(S.Last)})}});case w.Home:case w.PageUp:return l.preventDefault(),l.stopPropagation(),s.goToOption(S.First);case w.End:case w.PageDown:return l.preventDefault(),l.stopPropagation(),s.goToOption(S.Last);case w.Escape:return r.comboboxState!==0?void 0:(l.preventDefault(),r.optionsRef.current&&!r.optionsPropsRef.current.static&&l.stopPropagation(),s.closeCombobox());case w.Tab:if(r.comboboxState!==0)return;r.mode===0&&s.selectActiveOption(),s.closeCombobox();break}}),$=R(l=>{s.openCombobox(),i==null||i(l)}),k=J(()=>{if(r.labelId)return[r.labelId].join(" ")},[r.labelId]),F=u.useMemo(()=>({open:r.comboboxState===0,disabled:r.disabled}),[r]),T={ref:C,id:v,role:"combobox",type:c,"aria-controls":(n=r.optionsRef.current)==null?void 0:n.id,"aria-expanded":r.disabled?void 0:r.comboboxState===0,"aria-activedescendant":r.activeOptionIndex===null||(t=r.options[r.activeOptionIndex])==null?void 0:t.id,"aria-multiselectable":r.mode===1?!0:void 0,"aria-labelledby":k,disabled:r.disabled,onKeyDown:p,onChange:$};return D({ourProps:T,theirProps:f,slot:F,defaultTag:He,name:"Combobox.Input"})}),Je="button",Ge=_(function(e,o){var n;let t=V("Combobox.Button"),a=j("Combobox.Button"),i=q(t.buttonRef,o),O=`headlessui-combobox-button-${B()}`,c=Z(),f=R(d=>{switch(d.key){case w.ArrowDown:return d.preventDefault(),d.stopPropagation(),t.comboboxState===1&&a.openCombobox(),c.nextFrame(()=>{var p;return(p=t.inputRef.current)==null?void 0:p.focus({preventScroll:!0})});case w.ArrowUp:return d.preventDefault(),d.stopPropagation(),t.comboboxState===1&&(a.openCombobox(),c.nextFrame(()=>{t.value||a.goToOption(S.Last)})),c.nextFrame(()=>{var p;return(p=t.inputRef.current)==null?void 0:p.focus({preventScroll:!0})});case w.Escape:return t.comboboxState!==0?void 0:(d.preventDefault(),t.optionsRef.current&&!t.optionsPropsRef.current.static&&d.stopPropagation(),a.closeCombobox(),c.nextFrame(()=>{var p;return(p=t.inputRef.current)==null?void 0:p.focus({preventScroll:!0})}));default:return}}),r=R(d=>{if(Se(d.currentTarget))return d.preventDefault();t.comboboxState===0?a.closeCombobox():(d.preventDefault(),a.openCombobox()),c.nextFrame(()=>{var p;return(p=t.inputRef.current)==null?void 0:p.focus({preventScroll:!0})})}),s=J(()=>{if(t.labelId)return[t.labelId,O].join(" ")},[t.labelId,O]),C=u.useMemo(()=>({open:t.comboboxState===0,disabled:t.disabled,value:t.value}),[t]),v=e,m={ref:i,id:O,type:$e(e,t.buttonRef),tabIndex:-1,"aria-haspopup":!0,"aria-controls":(n=t.optionsRef.current)==null?void 0:n.id,"aria-expanded":t.disabled?void 0:t.comboboxState===0,"aria-labelledby":s,disabled:t.disabled,onClick:r,onKeyDown:f};return D({ourProps:m,theirProps:v,slot:C,defaultTag:Je,name:"Combobox.Button"})}),ze="label",We=_(function(e,o){let n=V("Combobox.Label"),t=`headlessui-combobox-label-${B()}`,a=j("Combobox.Label"),i=q(n.labelRef,o);P(()=>a.registerLabel(t),[t]);let O=R(()=>{var f;return(f=n.inputRef.current)==null?void 0:f.focus({preventScroll:!0})}),c=u.useMemo(()=>({open:n.comboboxState===0,disabled:n.disabled}),[n]);return D({ourProps:{ref:i,id:t,onClick:O},theirProps:e,slot:c,defaultTag:ze,name:"Combobox.Label"})}),Xe="ul",Qe=W.RenderStrategy|W.Static,Ye=_(function(e,o){var n;let{hold:t=!1,...a}=e,i=V("Combobox.Options"),O=q(i.optionsRef,o),c=`headlessui-combobox-options-${B()}`,f=he(),r=(()=>f!==null?f===K.Open:i.comboboxState===0)();P(()=>{var m;i.optionsPropsRef.current.static=(m=e.static)!=null?m:!1},[i.optionsPropsRef,e.static]),P(()=>{i.optionsPropsRef.current.hold=t},[i.optionsPropsRef,t]),Ee({container:i.optionsRef.current,enabled:i.comboboxState===0,accept(m){return m.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:m.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(m){m.setAttribute("role","none")}});let s=J(()=>{var m,d;return(d=i.labelId)!=null?d:(m=i.buttonRef.current)==null?void 0:m.id},[i.labelId,i.buttonRef.current]),C=u.useMemo(()=>({open:i.comboboxState===0}),[i]),v={"aria-activedescendant":i.activeOptionIndex===null||(n=i.options[i.activeOptionIndex])==null?void 0:n.id,"aria-labelledby":s,role:"listbox",id:c,ref:O};return D({ourProps:v,theirProps:a,slot:C,defaultTag:Xe,features:Qe,visible:r,name:"Combobox.Options"})}),Ze="li",et=_(function(e,o){var n,t;let{disabled:a=!1,value:i,...O}=e,c=V("Combobox.Option"),f=j("Combobox.Option"),r=`headlessui-combobox-option-${B()}`,s=c.activeOptionIndex!==null?c.options[c.activeOptionIndex].id===r:!1,C=c.isSelected(i),v=u.useRef(null),m=Y({disabled:a,value:i,domRef:v,textValue:(t=(n=v.current)==null?void 0:n.textContent)==null?void 0:t.toLowerCase()}),d=q(o,v),p=R(()=>f.selectOption(r));P(()=>f.registerOption(r,m),[m,r]);let $=u.useRef(!c.__demoMode);P(()=>{if(!c.__demoMode)return;let y=X();return y.requestAnimationFrame(()=>{$.current=!0}),y.dispose},[]),P(()=>{if(c.comboboxState!==0||!s||!$.current||c.activationTrigger===0)return;let y=X();return y.requestAnimationFrame(()=>{var L,x;(x=(L=v.current)==null?void 0:L.scrollIntoView)==null||x.call(L,{block:"nearest"})}),y.dispose},[v,s,c.comboboxState,c.activationTrigger,c.activeOptionIndex]);let k=R(y=>{if(a)return y.preventDefault();p(),c.mode===0&&f.closeCombobox()}),F=R(()=>{if(a)return f.goToOption(S.Nothing);f.goToOption(S.Specific,r)}),T=R(()=>{a||s||f.goToOption(S.Specific,r,0)}),l=R(()=>{a||!s||c.optionsPropsRef.current.hold||f.goToOption(S.Nothing)}),I=u.useMemo(()=>({active:s,selected:C,disabled:a}),[s,C,a]);return D({ourProps:{id:r,ref:d,role:"option",tabIndex:a===!0?void 0:-1,"aria-disabled":a===!0?!0:void 0,"aria-selected":C,disabled:void 0,onClick:k,onFocus:F,onPointerMove:T,onMouseMove:T,onPointerLeave:l,onMouseLeave:l},theirProps:O,slot:I,defaultTag:Ze,name:"Combobox.Option"})}),N=Object.assign(Ue,{Input:Ke,Button:Ge,Label:We,Options:Ye,Option:et});const Q=({options:e,isLoading:o,name:n,defaultSearchTerm:t,defaultValue:a,onSearchChange:i,readonly:O,enableSearchIcon:c=!1,onCustomSelectChange:f,renderCustomOption:r,placeholder:s="Type to search"})=>{const[C,v]=u.useState(t||""),[m,d]=u.useState({}),p=xe(m)?a:m,$=ve(p)?JSON.stringify(p):p,k=u.useMemo(()=>fe(l=>{const I=l.target.value;I.length>1&&i(I),I!==C&&v(I),e.filter(y=>y.label===I).length===0&&d({})},300),[i]),F=T=>{const l=e.filter(I=>I.label===T)[0];d(l.value),v(T),f==null||f(l)};return h.createElement(N,{onChange:F,value:C,disabled:O},({open:T})=>h.createElement("div",{className:"ctw-relative ctw-text-left"},h.createElement(N.Button,{as:"div",onClick:l=>{(T||C.length===0)&&ge(l)&&l.preventDefault()}},h.createElement("div",{className:"ctw-relative"},c&&h.createElement("div",{className:"ctw-search-icon-wrapper"},h.createElement(Le,{className:"ctw-search-icon"})),h.createElement(N.Input,{className:me("ctw-listbox-input ctw-w-full",{"ctw-pl-10":c}),onChange:l=>{l.persist(),k(l)},placeholder:s}))),h.createElement("input",{hidden:!0,name:n,value:$,readOnly:!0}),h.createElement(N.Options,{className:"ctw-listbox ctw-absolute ctw-z-10 ctw-m-0 ctw-mt-1 ctw-max-h-60 ctw-w-full ctw-list-none ctw-overflow-auto ctw-rounded-md ctw-bg-white ctw-p-0 ctw-py-1 ctw-text-base ctw-shadow-lg ctw-ring-1 ctw-ring-opacity-5 focus:ctw-outline-none sm:ctw-text-sm"},h.createElement(tt,{options:e,query:C,isLoading:o,renderCustomOption:r}))))},tt=({options:e,query:o,isLoading:n,renderCustomOption:t})=>o.length===0?h.createElement(A,{option:{value:"",label:"Type to search"}}):n?h.createElement(A,{option:{value:"",label:"Loading..."}}):o.length<2?h.createElement(A,{option:{value:"",label:"Pleae type at least two characters"}}):e.length===0?h.createElement(A,{option:{value:"",label:`No results found for search term '${o}'`}}):h.createElement(h.Fragment,null,e.map(a=>t?h.createElement(u.Fragment,{key:a.key},t(a)," "):h.createElement(A,{option:a,key:a.key}))),A=({option:e})=>h.createElement(N.Option,{value:e.label,className:({active:o})=>`ctw-relative ctw-cursor-default ctw-select-none ctw-py-2 ctw-pr-4 ctw-pl-4 ${o?"ctw-bg-primary-light ctw-text-primary-dark":"ctw-text-content-black"}`},e.label);try{Q.displayName="ComboboxField",Q.__docgenInfo={description:"",displayName:"ComboboxField",props:{options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"ComboxboxFieldOption[]"}},isLoading:{defaultValue:null,description:"",name:"isLoading",required:!0,type:{name:"boolean"}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!0,type:{name:"T"}},defaultSearchTerm:{defaultValue:null,description:"",name:"defaultSearchTerm",required:!0,type:{name:"string"}},onSearchChange:{defaultValue:null,description:"",name:"onSearchChange",required:!0,type:{name:"(searchTerm: string) => void"}},readonly:{defaultValue:null,description:"",name:"readonly",required:!0,type:{name:"boolean | undefined"}},enableSearchIcon:{defaultValue:{value:"false"},description:"",name:"enableSearchIcon",required:!1,type:{name:"boolean"}},onCustomSelectChange:{defaultValue:null,description:"",name:"onCustomSelectChange",required:!1,type:{name:"((e: unknown) => void)"}},renderCustomOption:{defaultValue:null,description:"",name:"renderCustomOption",required:!1,type:{name:"((e: unknown) => Element)"}},placeholder:{defaultValue:{value:"Type to search"},description:"",name:"placeholder",required:!1,type:{name:"string"}}}}}catch{}export{Q as C,N as L,ee as e,J as i,Me as p};
