{"version":3,"file":"use-patient-history.stories-0f8b1298.js","sources":["../../src/components/content/patient-history/use-patient-history.tsx","../../src/components/content/patient-history/story-helpers/mocks/patient.ts","../../src/components/content/patient-history/story-helpers/mocks/requests.ts","../../src/components/content/patient-history/use-patient-history.stories.tsx"],"sourcesContent":["import { PatientHistoryRequestDrawer } from \"../patient-history-request-drawer\";\nimport { useDrawer } from \"@/components/core/providers/drawer-provider\";\nimport { usePatient } from \"@/components/core/providers/patient-provider\";\n\nexport function usePatientHistory() {\n  const { openDrawer } = useDrawer();\n  const patientResponse = usePatient();\n\n  return {\n    openHistoryRequestDrawer: () => {\n      openDrawer({\n        component: (props) => {\n          if (patientResponse.data) {\n            return (\n              <PatientHistoryRequestDrawer\n                setClinicalHistoryExists={() => {}}\n                header={\n                  <div className=\"ctw-pt-0 ctw-text-base\">\n                    Request patient clinical history from 70K+ providers across\n                    the nation. No changes will be made to your patient record.\n                  </div>\n                }\n                patient={patientResponse.data}\n                {...props}\n              />\n            );\n          }\n          return undefined;\n        },\n      });\n    },\n  };\n}\n","export const patient = {\n  resourceType: \"Bundle\",\n  id: \"f4da1f39-7638-45e4-999b-9ff33d7c5201\",\n  meta: {\n    lastUpdated: \"2022-11-15T19:37:55.783+00:00\",\n  },\n  type: \"searchset\",\n  entry: [\n    {\n      resource: {\n        resourceType: \"Patient\",\n        id: \"u12345\",\n        meta: {\n          extension: [\n            {\n              url: \"https://zusapi.com/created-at\",\n              valueInstant: \"2023-01-26T15:49:38.110+00:00\",\n            },\n          ],\n          versionId: \"2\",\n          lastUpdated: \"2023-01-26T15:49:38.553+00:00\",\n          source: \"#cacbf4a51c11b1b0\",\n          security: [\n            {\n              system: \"http://terminology.hl7.org/CodeSystem/v3-ActReason\",\n              code: \"HTEST\",\n            },\n          ],\n          tag: [\n            {\n              system: \"https://zusapi.com/thirdparty/source\",\n              code: \"commonwell\",\n            },\n            {\n              system: \"https://zusapi.com/accesscontrol/owner\",\n              code: \"builder/f09f6b6f-ae4b-45f4-a653-5677b1582115\",\n              display: \"HLTH 2022 - Gunther\",\n            },\n          ],\n        },\n        identifier: [\n          {\n            system: \"https://zusapi.com/fhir/identifier/universal-id\",\n            value: \"b640bda1-aec7-4be6-a890-e3685a55bce3\",\n          },\n        ],\n        name: [\n          {\n            family: \"Zhang\",\n            given: [\"Bruno\"],\n          },\n        ],\n        telecom: [\n          {\n            system: \"email\",\n            value: \"brunozhang@example.com\",\n          },\n          {\n            system: \"phone\",\n            value: \"555-569-2000\",\n            use: \"home\",\n          },\n          {\n            system: \"phone\",\n            value: \"555-536-3933\",\n            use: \"mobile\",\n          },\n          {\n            system: \"phone\",\n            value: \"555-843-3265\",\n            use: \"work\",\n          },\n        ],\n        gender: \"male\",\n        birthDate: \"1970-05-09\",\n        address: [\n          {\n            line: [\"357 SHADOW LN\"],\n            city: \"LAS VEGAS\",\n            state: \"NV\",\n            postalCode: \"89106-4119\",\n          },\n        ],\n        managingOrganization: {\n          reference: \"Organization/79a1c124-a752-4d9a-a44e-2c02499ae402\",\n        },\n      },\n      search: {\n        mode: \"match\",\n      },\n    },\n  ],\n};\n","import { rest } from \"msw\";\nimport { patient } from \"./patient\";\n\nexport const mockPatientGet = rest.get(\n  \"https://api.dev.zusapi.com/fhir/Patient\",\n  (req, res, ctx) => res(ctx.status(200), ctx.json(patient))\n);\n\nexport const mockPatientPut = rest.put(\n  \"https://api.dev.zusapi.com/fhir/Patient/:patientId\",\n  (req, res, ctx) => res(ctx.status(200), ctx.json(patient))\n);\n\nexport const mockProvenancePost = rest.post(\n  \"https://api.dev.zusapi.com/fhir/Provenance\",\n  (_, res, ctx) => res(ctx.status(200))\n);\n\n// https://api.dev.zusapi.com/patient-history/patient/u12345/refresh?consent=1\nexport const mockPatientHistoryPost = rest.post(\n  \"https://api.dev.zusapi.com/patient-history/patient/:patientId/refresh\",\n  (req, res, ctx) => {\n    // eslint-disable-next-line no-console\n    console.log(\"Sent Patient History Request:\");\n    // eslint-disable-next-line no-console\n    console.log(req.headers.all());\n\n    // Patient history request expects json response.\n    return res(ctx.status(200), ctx.json({}));\n  }\n);\n","import type { Meta, StoryObj } from \"@storybook/react\";\nimport { mockPatientGet, mockPatientHistoryPost, mockPatientPut, mockProvenancePost } from \"./story-helpers/mocks/requests\";\nimport { usePatientHistory } from \"./use-patient-history\";\nimport { CTWProvider } from \"@/components/core/providers/ctw-provider\";\nimport { PatientProvider } from \"@/components/core/providers/patient-provider\";\nimport { SYSTEM_ZUS_UNIVERSAL_ID } from \"@/fhir/system-urls\";\nconst HookWrapper = () => {\n  const {\n    openHistoryRequestDrawer\n  } = usePatientHistory();\n  return <button type=\"button\" onClick={openHistoryRequestDrawer} className=\"ctw-link ctw-btn-clear\">\n      Request History\n    </button>;\n};\nexport default ({\n  title: \"hooks/usePatientHistory\",\n  component: HookWrapper,\n  decorators: [(Story, {\n    args\n  }) => <CTWProvider env=\"dev\" authToken=\"dummy-token\" builderId=\"b123\">\n        <PatientProvider patientID=\"u12345\" systemURL={SYSTEM_ZUS_UNIVERSAL_ID}>\n          <Story args={args} />\n        </PatientProvider>\n      </CTWProvider>]\n} as Meta);\nexport const Basic: StoryObj = {\n  parameters: {\n    msw: [mockPatientGet, mockPatientPut, mockProvenancePost, mockPatientHistoryPost]\n  }\n};\nBasic.parameters = {\n  ...Basic.parameters,\n  storySource: {\n    source: \"{\\n  parameters: {\\n    msw: [mockPatientGet, mockPatientPut, mockProvenancePost, mockPatientHistoryPost]\\n  }\\n}\",\n    ...Basic.parameters?.storySource\n  }\n};"],"names":["usePatientHistory","openDrawer","useDrawer","patientResponse","usePatient","props","React","PatientHistoryRequestDrawer","patient","mockPatientGet","rest","req","res","ctx","mockPatientPut","mockProvenancePost","_","mockPatientHistoryPost","HookWrapper","openHistoryRequestDrawer","usePatientHistory_stories","Story","args","CTWProvider","PatientProvider","SYSTEM_ZUS_UNIVERSAL_ID","Basic","_a"],"mappings":"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"}