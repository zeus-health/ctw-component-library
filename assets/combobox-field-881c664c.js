import{r as c,R}from"./index-6f814c40.js";import"./_baseToString-7c0e3f59.js";import"./sortBy-cdc8b01b.js";import"./_baseClone-3ae78372.js";import"./sortBy-ee350c06.js";import{d as me}from"./debounce-5029c56d.js";import{e as ve}from"./_equalByTag-eda72788.js";import"./_baseForOwn-03e9c2f3.js";import{i as xe}from"./startCase-e12a4b87.js";import"./_createSet-6ff8e1d4.js";import{i as ge}from"./table-12f80a1c.js";import{i as Z,f as $,j as Oe,o as h,C as N,y as q,I as B,b as ee,k as he,c as w,u as M,$ as _,r as Ce,S as z,s as Re,p as K,m as X,L as Ie,a as Se,l as ye,q as we,t as Te,h as $e}from"./drawer-de3413cf.js";function J(e,n){let[t,o]=c.useState(e),a=Z(e);return $(()=>o(a.current),[a,o,...n]),t}function Q(e){var n;if(e.type)return e.type;let t=(n=e.as)!=null?n:"button";if(typeof t=="string"&&t.toLowerCase()==="button")return"button"}function Pe(e,n){let[t,o]=c.useState(()=>Q(e));return $(()=>{o(Q(e))},[e.type,e.as]),$(()=>{t||!n.current||n.current instanceof HTMLButtonElement&&!n.current.hasAttribute("type")&&o("button")},[t,n]),t}function Ee({container:e,accept:n,walk:t,enabled:o=!0}){let a=c.useRef(n),i=c.useRef(t);c.useEffect(()=>{a.current=n,i.current=t},[n,t]),$(()=>{if(!e||!o)return;let u=Oe(e);if(!u)return;let l=a.current,b=i.current,r=Object.assign(I=>l(I),{acceptNode:l}),s=u.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,r,!1);for(;s.nextNode();)b(s.currentNode)},[e,o,a,i])}function Le(e){throw new Error("Unexpected object: "+e)}var S=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(S||{});function Fe(e,n){let t=n.resolveItems();if(t.length<=0)return null;let o=n.resolveActiveIndex(),a=o??-1,i=(()=>{switch(e.focus){case 0:return t.findIndex(u=>!n.resolveDisabled(u));case 1:{let u=t.slice().reverse().findIndex((l,b,r)=>a!==-1&&r.length-b-1>=a?!1:!n.resolveDisabled(l));return u===-1?u:t.length-1-u}case 2:return t.findIndex((u,l)=>l<=a?!1:!n.resolveDisabled(u));case 3:{let u=t.slice().reverse().findIndex(l=>!n.resolveDisabled(l));return u===-1?u:t.length-1-u}case 4:return t.findIndex(u=>n.resolveId(u)===e.id);case 5:return null;default:Le(e)}})();return i===-1?o:i}function te(e={},n=null,t=[]){for(let[o,a]of Object.entries(e))ne(t,oe(n,o),a);return t}function oe(e,n){return e?e+"["+n+"]":n}function ne(e,n,t){if(Array.isArray(t))for(let[o,a]of t.entries())ne(e,oe(n,o.toString()),a);else t instanceof Date?e.push([n,t.toISOString()]):typeof t=="boolean"?e.push([n,t?"1":"0"]):typeof t=="string"?e.push([n,t]):typeof t=="number"?e.push([n,`${t}`]):t==null?e.push([n,""]):te(t,n,e)}function De(e,n,t){let[o,a]=c.useState(t),i=e!==void 0;return[i?e:o,h(u=>(i||a(u),n==null?void 0:n(u)))]}var Me=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Me||{}),Ne=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(Ne||{}),_e=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(_e||{}),ke=(e=>(e[e.OpenCombobox=0]="OpenCombobox",e[e.CloseCombobox=1]="CloseCombobox",e[e.GoToOption=2]="GoToOption",e[e.RegisterOption=3]="RegisterOption",e[e.UnregisterOption=4]="UnregisterOption",e[e.RegisterLabel=5]="RegisterLabel",e))(ke||{});function U(e,n=t=>t){let t=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,o=$e(n(e.options.slice()),i=>i.dataRef.current.domRef.current),a=t?o.indexOf(t):null;return a===-1&&(a=null),{options:o,activeOptionIndex:a}}let Ae={[1](e){return e.dataRef.current.disabled||e.comboboxState===1?e:{...e,activeOptionIndex:null,comboboxState:1}},[0](e){if(e.dataRef.current.disabled||e.comboboxState===0)return e;let n=e.activeOptionIndex,{isSelected:t}=e.dataRef.current,o=e.options.findIndex(a=>t(a.dataRef.current.value));return o!==-1&&(n=o),{...e,comboboxState:0,activeOptionIndex:n}},[2](e,n){var t;if(e.dataRef.current.disabled||e.dataRef.current.optionsRef.current&&!e.dataRef.current.optionsPropsRef.current.static&&e.comboboxState===1)return e;let o=U(e);if(o.activeOptionIndex===null){let i=o.options.findIndex(u=>!u.dataRef.current.disabled);i!==-1&&(o.activeOptionIndex=i)}let a=Fe(n,{resolveItems:()=>o.options,resolveActiveIndex:()=>o.activeOptionIndex,resolveId:i=>i.id,resolveDisabled:i=>i.dataRef.current.disabled});return{...e,...o,activeOptionIndex:a,activationTrigger:(t=n.trigger)!=null?t:1}},[3]:(e,n)=>{let t={id:n.id,dataRef:n.dataRef},o=U(e,i=>[...i,t]);e.activeOptionIndex===null&&e.dataRef.current.isSelected(n.dataRef.current.value)&&(o.activeOptionIndex=o.options.indexOf(t));let a={...e,...o,activationTrigger:1};return e.dataRef.current.__demoMode&&e.dataRef.current.value===void 0&&(a.activeOptionIndex=0),a},[4]:(e,n)=>{let t=U(e,o=>{let a=o.findIndex(i=>i.id===n.id);return a!==-1&&o.splice(a,1),o});return{...e,...t,activationTrigger:1}},[5]:(e,n)=>({...e,labelId:n.id})},G=c.createContext(null);G.displayName="ComboboxActionsContext";function j(e){let n=c.useContext(G);if(n===null){let t=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,j),t}return n}let W=c.createContext(null);W.displayName="ComboboxDataContext";function k(e){let n=c.useContext(W);if(n===null){let t=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,k),t}return n}function Ve(e,n){return M(n.type,Ae,e,n)}let qe=c.Fragment;function Be(e,n){let{value:t,defaultValue:o,onChange:a,name:i,by:u=(p,g)=>p===g,disabled:l=!1,__demoMode:b=!1,nullable:r=!1,multiple:s=!1,...I}=e,[O,v]=De(t,a,o),[f,d]=c.useReducer(Ve,{dataRef:c.createRef(),comboboxState:b?0:1,options:[],activeOptionIndex:null,activationTrigger:1,labelId:null}),C=c.useRef(!1),T=c.useRef({static:!1,hold:!1}),E=c.useRef(null),D=c.useRef(null),m=c.useRef(null),L=c.useRef(null),y=h(typeof u=="string"?(p,g)=>{let P=u;return(p==null?void 0:p[P])===(g==null?void 0:g[P])}:u),F=c.useCallback(p=>M(x.mode,{[1]:()=>O.some(g=>y(g,p)),[0]:()=>y(O,p)}),[O]),x=c.useMemo(()=>({...f,optionsPropsRef:T,labelRef:E,inputRef:D,buttonRef:m,optionsRef:L,value:O,disabled:l,mode:s?1:0,get activeOptionIndex(){if(C.current&&f.activeOptionIndex===null&&f.options.length>0){let p=f.options.findIndex(g=>!g.dataRef.current.disabled);if(p!==-1)return p}return f.activeOptionIndex},compare:y,isSelected:F,nullable:r,__demoMode:b}),[O,l,s,r,b,f]);$(()=>{f.dataRef.current=x},[x]),Ie([x.buttonRef,x.inputRef,x.optionsRef],()=>d({type:1}),x.comboboxState===0);let re=c.useMemo(()=>({open:x.comboboxState===0,disabled:l,activeIndex:x.activeOptionIndex,activeOption:x.activeOptionIndex===null?null:x.options[x.activeOptionIndex].dataRef.current.value,value:O}),[x,l,O]),ae=h(p=>{let g=x.options.find(P=>P.id===p);!g||H(g.dataRef.current.value)}),ie=h(()=>{if(x.activeOptionIndex!==null){let{dataRef:p,id:g}=x.options[x.activeOptionIndex];H(p.current.value),d({type:2,focus:S.Specific,id:g})}}),le=h(()=>{d({type:0}),C.current=!0}),ue=h(()=>{d({type:1}),C.current=!1}),se=h((p,g,P)=>(C.current=!1,p===S.Specific?d({type:2,focus:S.Specific,id:g,trigger:P}):d({type:2,focus:p,trigger:P}))),ce=h((p,g)=>(d({type:3,id:p,dataRef:g}),()=>d({type:4,id:p}))),de=h(p=>(d({type:5,id:p}),()=>d({type:5,id:null}))),H=h(p=>M(x.mode,{[0](){return v==null?void 0:v(p)},[1](){let g=x.value.slice(),P=g.findIndex(fe=>y(fe,p));return P===-1?g.push(p):g.splice(P,1),v==null?void 0:v(g)}})),pe=c.useMemo(()=>({onChange:H,registerOption:ce,registerLabel:de,goToOption:se,closeCombobox:ue,openCombobox:le,selectActiveOption:ie,selectOption:ae}),[]),be=n===null?{}:{ref:n};return R.createElement(G.Provider,{value:pe},R.createElement(W.Provider,{value:x},R.createElement(Se,{value:M(x.comboboxState,{[0]:K.Open,[1]:K.Closed})},i!=null&&O!=null&&te({[i]:O}).map(([p,g])=>R.createElement(ye,{features:we.Hidden,...Te({key:p,as:"input",type:"hidden",hidden:!0,readOnly:!0,name:p,value:g})})),_({ourProps:be,theirProps:I,slot:re,defaultTag:qe,name:"Combobox"}))))}let je=N(Be),He="input",Ue=N(function(e,n){var t,o;let{value:a,onChange:i,displayValue:u,type:l="text",...b}=e,r=k("Combobox.Input"),s=j("Combobox.Input"),I=q(r.inputRef,n),O=`headlessui-combobox-input-${B()}`,v=ee(),f=c.useMemo(()=>{var m;return typeof u=="function"?(m=u(r.value))!=null?m:"":typeof r.value=="string"?r.value:""},[r.value]);he(([m,L],[y,F])=>{!r.inputRef.current||(F===0&&L===1||m!==y)&&(r.inputRef.current.value=m)},[f,r.comboboxState]);let d=h(m=>{switch(m.key){case w.Backspace:case w.Delete:if(r.mode!==0||!r.nullable)return;let L=m.currentTarget;v.requestAnimationFrame(()=>{L.value===""&&(s.onChange(null),r.optionsRef.current&&(r.optionsRef.current.scrollTop=0),s.goToOption(S.Nothing))});break;case w.Enter:if(r.comboboxState!==0||m.nativeEvent.isComposing)return;if(m.preventDefault(),m.stopPropagation(),r.activeOptionIndex===null){s.closeCombobox();return}s.selectActiveOption(),r.mode===0&&s.closeCombobox();break;case w.ArrowDown:return m.preventDefault(),m.stopPropagation(),M(r.comboboxState,{[0]:()=>{s.goToOption(S.Next)},[1]:()=>{s.openCombobox()}});case w.ArrowUp:return m.preventDefault(),m.stopPropagation(),M(r.comboboxState,{[0]:()=>{s.goToOption(S.Previous)},[1]:()=>{s.openCombobox(),v.nextFrame(()=>{r.value||s.goToOption(S.Last)})}});case w.Home:case w.PageUp:return m.preventDefault(),m.stopPropagation(),s.goToOption(S.First);case w.End:case w.PageDown:return m.preventDefault(),m.stopPropagation(),s.goToOption(S.Last);case w.Escape:return r.comboboxState!==0?void 0:(m.preventDefault(),r.optionsRef.current&&!r.optionsPropsRef.current.static&&m.stopPropagation(),s.closeCombobox());case w.Tab:if(r.comboboxState!==0)return;r.mode===0&&s.selectActiveOption(),s.closeCombobox();break}}),C=h(m=>{s.openCombobox(),i==null||i(m)}),T=J(()=>{if(r.labelId)return[r.labelId].join(" ")},[r.labelId]),E=c.useMemo(()=>({open:r.comboboxState===0,disabled:r.disabled}),[r]),D={ref:I,id:O,role:"combobox",type:l,"aria-controls":(t=r.optionsRef.current)==null?void 0:t.id,"aria-expanded":r.disabled?void 0:r.comboboxState===0,"aria-activedescendant":r.activeOptionIndex===null||(o=r.options[r.activeOptionIndex])==null?void 0:o.id,"aria-multiselectable":r.mode===1?!0:void 0,"aria-labelledby":T,disabled:r.disabled,onKeyDown:d,onChange:C};return _({ourProps:D,theirProps:b,slot:E,defaultTag:He,name:"Combobox.Input"})}),Ke="button",Je=N(function(e,n){var t;let o=k("Combobox.Button"),a=j("Combobox.Button"),i=q(o.buttonRef,n),u=`headlessui-combobox-button-${B()}`,l=ee(),b=h(f=>{switch(f.key){case w.ArrowDown:return f.preventDefault(),f.stopPropagation(),o.comboboxState===1&&a.openCombobox(),l.nextFrame(()=>{var d;return(d=o.inputRef.current)==null?void 0:d.focus({preventScroll:!0})});case w.ArrowUp:return f.preventDefault(),f.stopPropagation(),o.comboboxState===1&&(a.openCombobox(),l.nextFrame(()=>{o.value||a.goToOption(S.Last)})),l.nextFrame(()=>{var d;return(d=o.inputRef.current)==null?void 0:d.focus({preventScroll:!0})});case w.Escape:return o.comboboxState!==0?void 0:(f.preventDefault(),o.optionsRef.current&&!o.optionsPropsRef.current.static&&f.stopPropagation(),a.closeCombobox(),l.nextFrame(()=>{var d;return(d=o.inputRef.current)==null?void 0:d.focus({preventScroll:!0})}));default:return}}),r=h(f=>{if(Ce(f.currentTarget))return f.preventDefault();o.comboboxState===0?a.closeCombobox():(f.preventDefault(),a.openCombobox()),l.nextFrame(()=>{var d;return(d=o.inputRef.current)==null?void 0:d.focus({preventScroll:!0})})}),s=J(()=>{if(o.labelId)return[o.labelId,u].join(" ")},[o.labelId,u]),I=c.useMemo(()=>({open:o.comboboxState===0,disabled:o.disabled,value:o.value}),[o]),O=e,v={ref:i,id:u,type:Pe(e,o.buttonRef),tabIndex:-1,"aria-haspopup":!0,"aria-controls":(t=o.optionsRef.current)==null?void 0:t.id,"aria-expanded":o.disabled?void 0:o.comboboxState===0,"aria-labelledby":s,disabled:o.disabled,onClick:r,onKeyDown:b};return _({ourProps:v,theirProps:O,slot:I,defaultTag:Ke,name:"Combobox.Button"})}),Ge="label",We=N(function(e,n){let t=k("Combobox.Label"),o=`headlessui-combobox-label-${B()}`,a=j("Combobox.Label"),i=q(t.labelRef,n);$(()=>a.registerLabel(o),[o]);let u=h(()=>{var b;return(b=t.inputRef.current)==null?void 0:b.focus({preventScroll:!0})}),l=c.useMemo(()=>({open:t.comboboxState===0,disabled:t.disabled}),[t]);return _({ourProps:{ref:i,id:o,onClick:u},theirProps:e,slot:l,defaultTag:Ge,name:"Combobox.Label"})}),ze="ul",Xe=z.RenderStrategy|z.Static,Qe=N(function(e,n){var t;let{hold:o=!1,...a}=e,i=k("Combobox.Options"),u=q(i.optionsRef,n),l=`headlessui-combobox-options-${B()}`,b=Re(),r=(()=>b!==null?b===K.Open:i.comboboxState===0)();$(()=>{var v;i.optionsPropsRef.current.static=(v=e.static)!=null?v:!1},[i.optionsPropsRef,e.static]),$(()=>{i.optionsPropsRef.current.hold=o},[i.optionsPropsRef,o]),Ee({container:i.optionsRef.current,enabled:i.comboboxState===0,accept(v){return v.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:v.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(v){v.setAttribute("role","none")}});let s=J(()=>{var v,f;return(f=i.labelId)!=null?f:(v=i.buttonRef.current)==null?void 0:v.id},[i.labelId,i.buttonRef.current]),I=c.useMemo(()=>({open:i.comboboxState===0}),[i]),O={"aria-activedescendant":i.activeOptionIndex===null||(t=i.options[i.activeOptionIndex])==null?void 0:t.id,"aria-labelledby":s,role:"listbox",id:l,ref:u};return _({ourProps:O,theirProps:a,slot:I,defaultTag:ze,features:Xe,visible:r,name:"Combobox.Options"})}),Ye="li",Ze=N(function(e,n){var t,o;let{disabled:a=!1,value:i,...u}=e,l=k("Combobox.Option"),b=j("Combobox.Option"),r=`headlessui-combobox-option-${B()}`,s=l.activeOptionIndex!==null?l.options[l.activeOptionIndex].id===r:!1,I=l.isSelected(i),O=c.useRef(null),v=Z({disabled:a,value:i,domRef:O,textValue:(o=(t=O.current)==null?void 0:t.textContent)==null?void 0:o.toLowerCase()}),f=q(n,O),d=h(()=>b.selectOption(r));$(()=>b.registerOption(r,v),[v,r]);let C=c.useRef(!l.__demoMode);$(()=>{if(!l.__demoMode)return;let y=X();return y.requestAnimationFrame(()=>{C.current=!0}),y.dispose},[]),$(()=>{if(l.comboboxState!==0||!s||!C.current||l.activationTrigger===0)return;let y=X();return y.requestAnimationFrame(()=>{var F,x;(x=(F=O.current)==null?void 0:F.scrollIntoView)==null||x.call(F,{block:"nearest"})}),y.dispose},[O,s,l.comboboxState,l.activationTrigger,l.activeOptionIndex]);let T=h(y=>{if(a)return y.preventDefault();d(),l.mode===0&&b.closeCombobox()}),E=h(()=>{if(a)return b.goToOption(S.Nothing);b.goToOption(S.Specific,r)}),D=h(()=>{a||s||b.goToOption(S.Specific,r,0)}),m=h(()=>{a||!s||l.optionsPropsRef.current.hold||b.goToOption(S.Nothing)}),L=c.useMemo(()=>({active:s,selected:I,disabled:a}),[s,I,a]);return _({ourProps:{id:r,ref:f,role:"option",tabIndex:a===!0?void 0:-1,"aria-disabled":a===!0?!0:void 0,"aria-selected":I,disabled:void 0,onClick:T,onFocus:E,onPointerMove:D,onMouseMove:D,onPointerLeave:m,onMouseLeave:m},theirProps:u,slot:L,defaultTag:Ye,name:"Combobox.Option"})}),V=Object.assign(je,{Input:Ue,Button:Je,Label:We,Options:Qe,Option:Ze});const Y=({options:e,isLoading:n,name:t,defaultSearchTerm:o,defaultValue:a,onSearchChange:i,readonly:u})=>{const[l,b]=c.useState(o||""),[r,s]=c.useState({}),I=xe(r)?a:r,O=ve(I)?JSON.stringify(I):I,v=c.useMemo(()=>me(C=>{const T=C.target.value;T.length>1&&i(T),T!==l&&b(T),e.filter(E=>E.label===T).length===0&&s({})},300),[i]),f=d=>{const C=e.filter(T=>T.label===d)[0];s(C.value),b(d)};return R.createElement(V,{onChange:f,value:l,disabled:u},({open:d})=>R.createElement("div",null,R.createElement(V.Button,{as:"div",onClick:C=>{(d||l.length===0)&&ge(C)&&C.preventDefault()}},R.createElement(V.Input,{className:"ctw-listbox-input ctw-w-full",onChange:C=>{C.persist(),v(C)},placeholder:"Type to search"})),R.createElement("input",{hidden:!0,name:t,value:O,readOnly:!0}),R.createElement(V.Options,{className:"ctw-listbox ctw-absolute ctw-z-10 ctw-m-0 ctw-mt-1 ctw-max-h-60 ctw-w-full ctw-list-none ctw-overflow-auto ctw-rounded-md ctw-bg-white ctw-p-0 ctw-py-1 ctw-text-base ctw-shadow-lg ctw-ring-1 ctw-ring-opacity-5 focus:ctw-outline-none sm:ctw-text-sm"},R.createElement(et,{options:e,query:l,isLoading:n}))))},et=({options:e,query:n,isLoading:t})=>n.length===0?R.createElement(A,{option:{value:"",label:"Type to search"}}):t?R.createElement(A,{option:{value:"",label:"Loading..."}}):n.length<2?R.createElement(A,{option:{value:"",label:"Pleae type at least two characters"}}):e.length===0?R.createElement(A,{option:{value:"",label:`No results found for search term '${n}'`}}):R.createElement(R.Fragment,null,e.map(o=>R.createElement(A,{option:o,key:o.label}))),A=({option:e})=>R.createElement(V.Option,{value:e.label,className:({active:n})=>`ctw-relative ctw-cursor-default ctw-select-none ctw-py-2 ctw-pr-4 ctw-pl-4 ${n?"ctw-bg-primary-light ctw-text-primary-dark":"ctw-text-content-black"}`},e.label);try{Y.displayName="ComboboxField",Y.__docgenInfo={description:"",displayName:"ComboboxField",props:{options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"ComboxboxFieldOption[]"}},isLoading:{defaultValue:null,description:"",name:"isLoading",required:!0,type:{name:"boolean"}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!0,type:{name:"T"}},defaultSearchTerm:{defaultValue:null,description:"",name:"defaultSearchTerm",required:!0,type:{name:"string"}},onSearchChange:{defaultValue:null,description:"",name:"onSearchChange",required:!0,type:{name:"(searchTerm: string) => void"}},readonly:{defaultValue:null,description:"",name:"readonly",required:!0,type:{name:"boolean | undefined"}}}}}catch{}export{Y as C,Ee as F,S as a,te as e,J as i,De as p,Pe as s,Fe as x};
//# sourceMappingURL=combobox-field-881c664c.js.map
